/*
   Magic Zoom Plus v4.5.24 
*/
window.MagicZoom=function(){function w(a){var b,c;for(b="",c=0;c<a.length;c++)b+=String.fromCharCode(14^a.charCodeAt(c));return b}function x(a){var b=[],c=null;return a&&(c=d(a))&&(b=m.filter(function(a){return a.placeholder===c})),b.length?b[0]:null}function y(a){var b=d(window).jGetSize(),c=d(window).jGetScroll();return a=a||0,{left:a,right:b.width-a,top:a,bottom:b.height-a,x:c.x,y:c.y}}function z(a){return a.pointerType&&("touch"===a.pointerType||a.pointerType===a.MSPOINTER_TYPE_TOUCH)||/touch/i.test(a.type)}function A(a){return a.pointerType?("touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType)&&a.isPrimary:1===a.changedTouches.length&&(!a.targetTouches.length||a.targetTouches[0].identifier==a.changedTouches[0].identifier)}function B(){var a=b.$A(arguments),c=a.shift(),d=l[c];if(d)for(var e=0;e<d.length;e++)d[e].apply(null,a)}function C(){var c,d,a=arguments[0],e=[];try{do d=a.tagName,/^[A-Za-z]*$/.test(d)&&((c=a.getAttribute("id"))&&/^[A-Za-z][-A-Za-z0-9_]*/.test(c)&&(d+="#"+c),e.push(d)),a=a.parentNode;while(a&&a!==document.documentElement);e=e.reverse(),b.addCSS(e.join(" ")+"> .mz-figure > img",{width:"100% !important;"},"mz-runtime-css",!0)}catch(a){}}function D(){var a=null,b=null,c=function(){window.scrollTo(document.body.scrollLeft,document.body.scrollTop),window.dispatchEvent(new Event("resize"))};return b=setInterval(function(){var b=90==window.orientation||window.orientation==-90,d=window.innerHeight,e=.85*(b?screen.availWidth:screen.availHeight);null!=a&&0!=a||!(b&&d<e||!b&&d<e)?null!=a&&1!=a||!(b&&d>e||!b&&d>e)||(a=!1,c()):(a=!0,c())},250)}function E(){b.addCSS(".magic-hidden-wrapper, .magic-temporary-img",{display:"block !important","min-height":"0 !important","min-width":"0 !important","max-height":"none !important","max-width":"none !important",width:"10px !important",height:"10px !important",position:"absolute !important",top:"-10000px !important",left:"0 !important",overflow:"hidden !important","-webkit-transform":"none !important",transform:"none !important","-webkit-transition":"none !important",transition:"none !important"},"magiczoom-reset-css"),b.addCSS(".magic-temporary-img img",{display:"inline-block !important",border:"0 !important",padding:"0 !important","min-height":"0 !important","min-width":"0 !important","max-height":"none !important","max-width":"none !important","-webkit-transform":"none !important",transform:"none !important","-webkit-transition":"none !important",transition:"none !important"},"magiczoom-reset-css"),b.browser.androidBrowser&&b.addCSS(".mobile-magic .mz-expand .mz-expand-bg",{display:"none !important"},"magiczoom-reset-css"),!b.browser.androidBrowser||"chrome"===b.browser.uaName&&44!=b.browser.uaVersion||b.addCSS(".mobile-magic .mz-zoom-window.mz-magnifier, .mobile-magic .mz-zoom-window.mz-magnifier:before",{"border-radius":"0 !important"},"magiczoom-reset-css")}var a,b;a=b=function(){function j(a){var b=a.charAt(0).toUpperCase()+a.slice(1);return a in i||"Webkit"+b in i||"Moz"+b in i||"ms"+b in i||"O"+b in i}function p(a){var c,d;return d=(!b.browser.webkit||"filter"!=a)&&a in i,!d&&(c=b.browser.cssDomPrefix+a.charAt(0).toUpperCase()+a.slice(1),c in i)?c:a}var a={version:"v3.3-b4",UUID:0,storage:{},$uuid:function(a){return a.$J_UUID||(a.$J_UUID=++b.UUID)},getStorage:function(a){return b.storage[a]||(b.storage[a]={})},$F:function(){},$false:function(){return!1},$true:function(){return!0},stylesId:"mjs-"+Math.floor(Math.random()*(new Date).getTime()),defined:function(a){return void 0!=a},ifndef:function(a,b){return void 0!=a?a:b},exists:function(a){return!!a},jTypeOf:function(a){if(!b.defined(a))return!1;if(a.$J_TYPE)return a.$J_TYPE;if(a.nodeType){if(1==a.nodeType)return"element";if(3==a.nodeType)return"textnode"}if(a.length&&a.item)return"collection";if(a.length&&a.callee)return"arguments";if((a instanceof window.Object||a instanceof window.Function)&&a.constructor===b.Class)return"class";if(a instanceof window.Array)return"array";if(a instanceof window.Function)return"function";if(a instanceof window.String)return"string";if(b.browser.trident){if(b.defined(a.cancelBubble))return"event"}else if(a===window.event||a.constructor==window.Event||a.constructor==window.MouseEvent||a.constructor==window.UIEvent||a.constructor==window.KeyboardEvent||a.constructor==window.KeyEvent)return"event";return a instanceof window.Date?"date":a instanceof window.RegExp?"regexp":a===window?"window":a===document?"document":typeof a},extend:function(a,c){if(a instanceof window.Array||(a=[a]),!c)return a[0];for(var d=0,e=a.length;d<e;d++)if(b.defined(a))for(var f in c)if(Object.prototype.hasOwnProperty.call(c,f))try{a[d][f]=c[f]}catch(a){}return a[0]},implement:function(a,c){a instanceof window.Array||(a=[a]);for(var d=0,e=a.length;d<e;d++)if(b.defined(a[d])&&a[d].prototype)for(var f in c||{})a[d].prototype[f]||(a[d].prototype[f]=c[f]);return a[0]},nativize:function(a,c){if(!b.defined(a))return a;for(var d in c||{})a[d]||(a[d]=c[d]);return a},$try:function(){for(var a=0,b=arguments.length;a<b;a++)try{return arguments[a]()}catch(a){}return null},$A:function(a){if(!b.defined(a))return b.$([]);if(a.toArray)return b.$(a.toArray());if(a.item){for(var c=a.length||0,d=new Array(c);c--;)d[c]=a[c];return b.$(d)}return b.$(Array.prototype.slice.call(a))},now:function(){return(new Date).getTime()},detach:function(a){var c;switch(b.jTypeOf(a)){case"object":c={};for(var d in a)c[d]=b.detach(a[d]);break;case"array":c=[];for(var e=0,f=a.length;e<f;e++)c[e]=b.detach(a[e]);break;default:return a}return b.$(c)},$:function(a){var c=!0;if(!b.defined(a))return null;if(a.$J_EXT)return a;switch(b.jTypeOf(a)){case"array":return a=b.nativize(a,b.extend(b.Array,{$J_EXT:b.$F})),a.jEach=a.forEach,a;case"string":var d=document.getElementById(a);return b.defined(d)?b.$(d):null;case"window":case"document":b.$uuid(a),a=b.extend(a,b.Doc);break;case"element":b.$uuid(a),a=b.extend(a,b.Element);break;case"event":a=b.extend(a,b.Event);break;case"textnode":case"function":case"array":case"date":default:c=!1}return c?b.extend(a,{$J_EXT:b.$F}):a},$new:function(a,c,d){return b.$(b.doc.createElement(a)).setProps(c||{}).jSetCss(d||{})},addCSS:function(a,c,d){var e,f,g,h=[],i=-1;if(d||(d=b.stylesId),e=b.$(d)||b.$new("style",{id:d,type:"text/css"}).jAppendTo(document.head||document.body,"top"),f=e.sheet||e.styleSheet,"string"!=b.jTypeOf(c)){for(var g in c)h.push(g+":"+c[g]);c=h.join(";")}return i=f.insertRule?f.insertRule(a+" {"+c+"}",f.cssRules.length):f.addRule(a,c)},removeCSS:function(a,c){var d,e;d=b.$(a),"element"===b.jTypeOf(d)&&(e=d.sheet||d.styleSheet,e.deleteRule?e.deleteRule(c):e.removeRule&&e.removeRule(c))},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)}).toUpperCase()},getAbsoluteURL:function(){var a;return function(b){return a||(a=document.createElement("a")),a.setAttribute("href",b),("!!"+a.href).replace("!!","")}}(),getHashCode:function(a){for(var b=0,c=a.length,d=0;d<c;++d)b=31*b+a.charCodeAt(d),b%=4294967296;return b}},b=a;a.$;window.magicJS||(window.magicJS=a,window.$mjs=a.$),b.Array={$J_TYPE:"array",indexOf:function(a,b){for(var d=(this.length,this.length),e=b<0?Math.max(0,d+b):b||0;e<d;e++)if(this[e]===a)return e;return-1},contains:function(a,b){return this.indexOf(a,b)!=-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},filter:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)if(d in this){var f=this[d];a.call(b,this[d],d,this)&&c.push(f)}return c},map:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c}},b.implement(String,{$J_TYPE:"string",jTrim:function(){return this.replace(/^\s+|\s+$/g,"")},eq:function(a,b){return b?this.toString()===a.toString():this.toLowerCase().toString()===a.toLowerCase().toString()},jCamelize:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},dashize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.charAt(0).toLowerCase()})},jToInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},jToBool:function(){return!this.replace(/true/i,"").jTrim()},has:function(a,b){return b=b||"",(b+this+b).indexOf(b+a+b)>-1}}),a.implement(Function,{$J_TYPE:"function",jBind:function(){var a=b.$A(arguments),c=this,d=a.shift();return function(){return c.apply(d||null,a.concat(b.$A(arguments)))}},jBindAsEvent:function(){var a=b.$A(arguments),c=this,d=a.shift();return function(e){return c.apply(d||null,b.$([e||(b.browser.ieMode?window.event:null)]).concat(a))}},jDelay:function(){var a=b.$A(arguments),c=this,d=a.shift();return window.setTimeout(function(){return c.apply(c,a)},d||0)},jDefer:function(){var a=b.$A(arguments),c=this;return function(){return c.jDelay.apply(c,a)}},interval:function(){var a=b.$A(arguments),c=this,d=a.shift();return window.setInterval(function(){return c.apply(c,a)},d||0)}});var d={},e=navigator.userAgent.toLowerCase(),f=e.match(/(webkit|gecko|trident|presto)\/(\d+\.?\d*)/i),g=e.match(/(edge|opr)\/(\d+\.?\d*)/i)||e.match(/(crios|chrome|safari|firefox|opera|opr)\/(\d+\.?\d*)/i),h=e.match(/version\/(\d+\.?\d*)/i),i=document.documentElement.style;b.browser={features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,fullScreen:!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.exitFullscreen||document.cancelFullScreen||document.webkitexitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.msCancelFullScreen),xhr2:!!window.ProgressEvent&&!!window.FormData&&window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,transition:j("transition"),transform:j("transform"),perspective:j("perspective"),animation:j("animation"),requestAnimationFrame:!1,multibackground:!1,cssFilters:!1,canvas:!1,svg:function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")}()},touchScreen:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}(),mobile:!!e.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/),engine:f&&f[1]?f[1].toLowerCase():window.opera?"presto":window.ActiveXObject?"trident":void 0!==document.getBoxObjectFor||null!=window.mozInnerScreenY?"gecko":null===window.WebKitPoint&&navigator.taintEnabled?"unknown":"webkit",version:f&&f[2]?parseFloat(f[2]):0,uaName:g&&g[1]?g[1].toLowerCase():"",uaVersion:g&&g[2]?parseFloat(g[2]):0,cssPrefix:"",cssDomPrefix:"",domPrefix:"",ieMode:0,platform:e.match(/ip(?:ad|od|hone)/)?"ios":(e.match(/(?:webos|android)/)||navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),backCompat:document.compatMode&&"backcompat"==document.compatMode.toLowerCase(),scrollbarsWidth:0,getDoc:function(){return document.compatMode&&"backcompat"==document.compatMode.toLowerCase()?document.body:document.documentElement},requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||void 0,cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||void 0,ready:!1,onready:function(){if(!b.browser.ready){var a,c;b.browser.ready=!0,b.body=b.$(document.body),b.win=b.$(window);try{var e=b.$new("div").jSetCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).jAppendTo(document.body);b.browser.scrollbarsWidth=e.offsetWidth-e.clientWidth,e.jRemove()}catch(a){}try{a=b.$new("div"),c=a.style,c.cssText="background:url(https://),url(https://),red url(https://)",b.browser.features.multibackground=/(url\s*\(.*?){3}/.test(c.background),c=null,a=null}catch(a){}b.browser.cssTransformProp||(b.browser.cssTransformProp=b.normalizeCSS("transform").dashize());try{a=b.$new("div"),a.style.cssText=b.normalizeCSS("filter").dashize()+":blur(2px);",b.browser.features.cssFilters=!!a.style.length&&(!b.browser.ieMode||b.browser.ieMode>9),a=null}catch(a){}b.browser.features.cssFilters||b.$(document.documentElement).jAddClass("no-cssfilters-magic");try{b.browser.features.canvas=function(){var a=b.$new("canvas");return!(!a.getContext||!a.getContext("2d"))}()}catch(a){}void 0===window.TransitionEvent&&void 0!==window.WebKitTransitionEvent&&(d.transitionend="webkitTransitionEnd"),b.Doc.jCallEvent.call(b.$(document),"domready")}}},function(){var c,d,e,a=[];switch(b.browser.engine){case"trident":b.browser.version||(b.browser.version=window.XMLHttpRequest?3:2);break;case"gecko":b.browser.version=g&&g[2]?parseFloat(g[2]):0}if(b.browser[b.browser.engine]=!0,g&&"crios"===g[1]&&(b.browser.uaName="chrome"),window.chrome&&(b.browser.chrome=!0),g&&"opr"===g[1]&&(b.browser.uaName="opera",b.browser.opera=!0),"safari"===b.browser.uaName&&h&&h[1]&&(b.browser.uaVersion=parseFloat(h[1])),"android"==b.browser.platform&&b.browser.webkit&&h&&h[1]&&(b.browser.androidBrowser=!0),c={gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"],presto:["-o-","O","o"]}[b.browser.engine]||["","",""],b.browser.cssPrefix=c[0],b.browser.cssDomPrefix=c[1],b.browser.domPrefix=c[2],b.browser.ieMode=b.browser.trident?document.documentMode?document.documentMode:function(){var a=0;if(b.browser.backCompat)return 5;switch(b.browser.version){case 2:a=6;break;case 3:a=7}return a}():void 0,a.push(b.browser.platform+"-magic"),b.browser.mobile&&a.push("mobile-magic"),b.browser.androidBrowser&&a.push("android-browser-magic"),b.browser.ieMode)for(b.browser.uaName="ie",b.browser.uaVersion=b.browser.ieMode,a.push("ie"+b.browser.ieMode+"-magic"),d=11;d>b.browser.ieMode;d--)a.push("lt-ie"+d+"-magic");b.browser.webkit&&b.browser.version<536&&(b.browser.features.fullScreen=!1),b.browser.requestAnimationFrame&&b.browser.requestAnimationFrame.call(window,function(){b.browser.features.requestAnimationFrame=!0}),b.browser.features.svg?a.push("svg-magic"):a.push("no-svg-magic"),e=(document.documentElement.className||"").match(/\S+/g)||[],document.documentElement.className=b.$(e).concat(a).join(" ");try{document.documentElement.setAttribute("data-magic-ua",b.browser.uaName),document.documentElement.setAttribute("data-magic-ua-ver",b.browser.uaVersion)}catch(a){}b.browser.ieMode&&b.browser.ieMode<9&&(document.createElement("figure"),document.createElement("figcaption"))}(),function(){b.browser.fullScreen={capable:b.browser.features.fullScreen,enabled:function(){return!!(document.fullscreenElement||document[b.browser.domPrefix+"FullscreenElement"]||document.fullScreen||document.webkitIsFullScreen||document[b.browser.domPrefix+"FullScreen"])},request:function(a,c){c||(c={}),this.capable?(b.$(document).jAddEvent(this.changeEventName,this.onchange=function(a){this.enabled()?c.onEnter&&c.onEnter():(b.$(document).jRemoveEvent(this.changeEventName,this.onchange),c.onExit&&c.onExit())}.jBindAsEvent(this)),b.$(document).jAddEvent(this.errorEventName,this.onerror=function(a){c.fallback&&c.fallback(),b.$(document).jRemoveEvent(this.errorEventName,this.onerror)}.jBindAsEvent(this)),(a[b.browser.domPrefix+"RequestFullscreen"]||a[b.browser.domPrefix+"RequestFullScreen"]||a.requestFullscreen||function(){}).call(a)):c.fallback&&c.fallback()},cancel:(document.exitFullscreen||document.cancelFullScreen||document[b.browser.domPrefix+"ExitFullscreen"]||document[b.browser.domPrefix+"CancelFullScreen"]||function(){}).jBind(document),changeEventName:document.msExitFullscreen?"MSFullscreenChange":(document.exitFullscreen?"":b.browser.domPrefix)+"fullscreenchange",errorEventName:document.msExitFullscreen?"MSFullscreenError":(document.exitFullscreen?"":b.browser.domPrefix)+"fullscreenerror",prefix:b.browser.domPrefix,activeElement:null}}();var k=/\S+/g,l=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,m={float:"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat"},n={fontWeight:!0,lineHeight:!0,opacity:!0,zIndex:!0,zoom:!0},o=window.getComputedStyle?function(a,b){var c=window.getComputedStyle(a,null);return c?c.getPropertyValue(b)||c[b]:null}:function(a,b){var c=a.currentStyle,d=null;return d=c?c[b]:null,null==d&&a.style&&a.style[b]&&(d=a.style[b]),d};return b.normalizeCSS=p,b.Element={jHasClass:function(a){return!(a||"").has(" ")&&(this.className||"").has(a," ")},jAddClass:function(a){for(var c=(this.className||"").match(k)||[],d=(a||"").match(k)||[],e=d.length,f=0;f<e;f++)b.$(c).contains(d[f])||c.push(d[f]);return this.className=c.join(" "),this},jRemoveClass:function(a){for(var g,c=(this.className||"").match(k)||[],d=(a||"").match(k)||[],e=d.length,f=0;f<e;f++)(g=b.$(c).indexOf(d[f]))>-1&&c.splice(g,1);return this.className=a?c.join(" "):"",this},jToggleClass:function(a){return this.jHasClass(a)?this.jRemoveClass(a):this.jAddClass(a)},jGetCss:function(a){var c=a.jCamelize(),d=null;if(a=m[c]||(m[c]=p(c)),d=o(this,a),"auto"===d&&(d=null),null!==d){if("opacity"==a)return b.defined(d)?parseFloat(d):1;l.test(a)&&(d=parseInt(d,10)?d:"0px")}return d},jSetCssProp:function(a,c){var d=a.jCamelize();try{if("opacity"==a)return this.jSetOpacity(c),this;a=m[d]||(m[d]=p(d)),this.style[a]=c+("number"!=b.jTypeOf(c)||n[d]?"":"px")}catch(a){}return this},jSetCss:function(a){for(var b in a)this.jSetCssProp(b,a[b]);return this},jGetStyles:function(){var a={};return b.$A(arguments).jEach(function(b){a[b]=this.jGetCss(b)},this),a},jSetOpacity:function(a,c){return c=c||!1,this.style.opacity=a,a=parseInt(100*parseFloat(a)),c&&(0===a?"hidden"!=this.style.visibility&&(this.style.visibility="hidden"):"visible"!=this.style.visibility&&(this.style.visibility="visible")),b.browser.ieMode&&b.browser.ieMode<9&&(isNaN(a)?(this.style.filter=this.style.filter.replace(/progid:DXImageTransform.Microsoft.Alpha\(Opacity=\d*\)/i,"").jTrim(),""===this.style.filter&&this.style.removeAttribute("filter")):~this.style.filter.indexOf("Alpha")?this.style.filter=this.style.filter.replace(/Opacity=\d*/i,"Opacity="+a):this.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+a+")"),this},setProps:function(a){for(var b in a)"class"===b?this.jAddClass(""+a[b]):this.setAttribute(b,""+a[b]);return this},jGetTransitionDuration:function(){var a=0,b=0;return a=this.jGetCss("transition-duration"),b=this.jGetCss("transition-delay"),a=a.indexOf("ms")>-1?parseFloat(a):a.indexOf("s")>-1?1e3*parseFloat(a):0,b=b.indexOf("ms")>-1?parseFloat(b):b.indexOf("s")>-1?1e3*parseFloat(b):0,a+b},hide:function(){return this.jSetCss({display:"none",visibility:"hidden"})},show:function(){return this.jSetCss({display:"",visibility:"visible"})},jGetSize:function(){return{width:this.offsetWidth,height:this.offsetHeight}},getInnerSize:function(a){var b=this.jGetSize();return b.width-=parseFloat(this.jGetCss("border-left-width")||0)+parseFloat(this.jGetCss("border-right-width")||0),b.height-=parseFloat(this.jGetCss("border-top-width")||0)+parseFloat(this.jGetCss("border-bottom-width")||0),a||(b.width-=parseFloat(this.jGetCss("padding-left")||0)+parseFloat(this.jGetCss("padding-right")||0),b.height-=parseFloat(this.jGetCss("padding-top")||0)+parseFloat(this.jGetCss("padding-bottom")||0)),b},jGetScroll:function(){return{top:this.scrollTop,left:this.scrollLeft}},jGetFullScroll:function(){var a=this,b={top:0,left:0};do b.left+=a.scrollLeft||0,b.top+=a.scrollTop||0,a=a.parentNode;while(a);return b},jGetPosition:function(){var a=this,c=0,d=0;if(b.defined(document.documentElement.getBoundingClientRect)){var e=this.getBoundingClientRect(),f=b.$(document).jGetScroll(),g=b.browser.getDoc();return{top:e.top+f.y-g.clientTop,left:e.left+f.x-g.clientLeft}}do c+=a.offsetLeft||0,d+=a.offsetTop||0,a=a.offsetParent;while(a&&!/^(?:body|html)$/i.test(a.tagName));return{top:d,left:c}},jGetRect:function(){var a=this.jGetPosition(),b=this.jGetSize();return{top:a.top,bottom:a.top+b.height,left:a.left,right:a.left+b.width}},changeContent:function(a){try{this.innerHTML=a}catch(b){this.innerText=a}return this},jRemove:function(){return this.parentNode?this.parentNode.removeChild(this):this},kill:function(){return b.$A(this.childNodes).jEach(function(a){3!=a.nodeType&&8!=a.nodeType&&b.$(a).kill()}),this.jRemove(),this.jClearEvents(),this.$J_UUID&&(b.storage[this.$J_UUID]=null,delete b.storage[this.$J_UUID]),null},append:function(a,b){b=b||"bottom";var c=this.firstChild;return"top"==b&&c?this.insertBefore(a,c):this.appendChild(a),this},jAppendTo:function(a,c){b.$(a).append(this,c);return this},enclose:function(a){return this.append(a.parentNode.replaceChild(this,a)),this},hasChild:function(a){return"element"===b.jTypeOf("string"==b.jTypeOf(a)?a=document.getElementById(a):a)&&(this!=a&&(this.contains&&!b.browser.webkit419?this.contains(a):this.compareDocumentPosition?!!(16&this.compareDocumentPosition(a)):b.$A(this.byTag(a.tagName)).contains(a)))}},b.Element.jGetStyle=b.Element.jGetCss,b.Element.jSetStyle=b.Element.jSetCss,window.Element||(window.Element=b.$F,b.browser.engine.webkit&&window.document.createElement("iframe"),window.Element.prototype=b.browser.engine.webkit?window["[[DOMElement.prototype]]"]:{}),b.implement(window.Element,{$J_TYPE:"element"}),b.Doc={jGetSize:function(){return b.browser.touchScreen||b.browser.presto925||b.browser.webkit419?{width:window.innerWidth,height:window.innerHeight}:{width:b.browser.getDoc().clientWidth,height:b.browser.getDoc().clientHeight}},jGetScroll:function(){return{x:window.pageXOffset||b.browser.getDoc().scrollLeft,y:window.pageYOffset||b.browser.getDoc().scrollTop}},jGetFullSize:function(){var a=this.jGetSize();return{width:Math.max(b.browser.getDoc().scrollWidth,a.width),height:Math.max(b.browser.getDoc().scrollHeight,a.height)}}},b.extend(document,{$J_TYPE:"document"}),b.extend(window,{$J_TYPE:"window"}),b.extend([b.Element,b.Doc],{jFetch:function(a,c){var d=b.getStorage(this.$J_UUID),e=d[a];return void 0!==c&&void 0===e&&(e=d[a]=c),b.defined(e)?e:null},jStore:function(a,c){var d=b.getStorage(this.$J_UUID);return d[a]=c,this},jDel:function(a){var c=b.getStorage(this.$J_UUID);return delete c[a],this}}),window.HTMLElement&&window.HTMLElement.prototype&&window.HTMLElement.prototype.getElementsByClassName||b.extend([b.Element,b.Doc],{getElementsByClassName:function(a){return b.$A(this.getElementsByTagName("*")).filter(function(b){try{return 1==b.nodeType&&b.className.has(a," ")}catch(a){}})}}),b.extend([b.Element,b.Doc],{byClass:function(){return this.getElementsByClassName(arguments[0])},byTag:function(){return this.getElementsByTagName(arguments[0])}}),b.browser.fullScreen.capable&&!document.requestFullScreen&&(b.Element.requestFullScreen=function(){b.browser.fullScreen.request(this)}),b.Event={$J_TYPE:"event",isQueueStopped:b.$false,stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.stopPropagation?this.stopPropagation():this.cancelBubble=!0,this},stopDefaults:function(){return this.preventDefault?this.preventDefault():this.returnValue=!1,this},stopQueue:function(){return this.isQueueStopped=b.$true,this},getClientXY:function(){var a;return a=/touch/i.test(this.type)?this.changedTouches[0]:this,b.defined(a)?{x:a.clientX,y:a.clientY}:{x:0,y:0}},jGetPageXY:function(){var a;return a=/touch/i.test(this.type)?this.changedTouches[0]:this,b.defined(a)?{x:a.pageX||a.clientX+b.browser.getDoc().scrollLeft,y:a.pageY||a.clientY+b.browser.getDoc().scrollTop}:{x:0,y:0}},getTarget:function(){for(var a=this.target||this.srcElement;a&&3==a.nodeType;)a=a.parentNode;return a},getRelated:function(){var a=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":a=this.relatedTarget||this.fromElement;break;case"mouseout":case"pointerout":case"MSPointerOut":a=this.relatedTarget||this.toElement;break;default:return a}try{for(;a&&3==a.nodeType;)a=a.parentNode}catch(b){a=null}return a},getButton:function(){return this.which||void 0===this.button?this.which:1&this.button?1:2&this.button?3:4&this.button?2:0},isTouchEvent:function(){return this.pointerType&&("touch"===this.pointerType||this.pointerType===this.MSPOINTER_TYPE_TOUCH)||/touch/i.test(this.type)},isPrimaryTouch:function(){return this.pointerType?("touch"===this.pointerType||this.MSPOINTER_TYPE_TOUCH===this.pointerType)&&this.isPrimary:1===this.changedTouches.length&&(!this.targetTouches.length||this.targetTouches[0].identifier==this.changedTouches[0].identifier)}},b._event_add_="addEventListener",b._event_del_="removeEventListener",b._event_prefix_="",document.addEventListener||(b._event_add_="attachEvent",b._event_del_="detachEvent",b._event_prefix_="on"),b.Event.Custom={type:"",x:null,y:null,timeStamp:null,button:null,target:null,relatedTarget:null,$J_TYPE:"event.custom",isQueueStopped:b.$false,events:b.$([]),pushToEvents:function(a){var b=a;this.events.push(b)},stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.events.jEach(function(a){try{a.stopDistribution()}catch(a){}}),this},stopDefaults:function(){return this.events.jEach(function(a){try{a.stopDefaults()}catch(a){}}),this},stopQueue:function(){return this.isQueueStopped=b.$true,this},getClientXY:function(){return{x:this.clientX,y:this.clientY}},jGetPageXY:function(){return{x:this.x,y:this.y}},getTarget:function(){return this.target},getRelated:function(){return this.relatedTarget},getButton:function(){return this.button},getOriginalTarget:function(){return this.events.length>0?this.events[0].getTarget():void 0}},b.extend([b.Element,b.Doc],{jAddEvent:function(a,c,e,f){var g,h,i,j,k;return"string"==b.jTypeOf(a)&&(k=a.split(" "),k.length>1&&(a=k)),"array"==b.jTypeOf(a)?(b.$(a).jEach(this.jAddEvent.jBindAsEvent(this,c,e,f)),this):a&&c&&"string"==b.jTypeOf(a)&&"function"==b.jTypeOf(c)?"domready"==a&&b.browser.ready?(c.call(this),this):(a=d[a]||a,e=parseInt(e||50),c.$J_EUID||(c.$J_EUID=Math.floor(Math.random()*b.now())),g=b.Doc.jFetch.call(this,"_EVENTS_",{}),h=g[a],h||(g[a]=h=b.$([]),i=this,b.Event.Custom[a]?b.Event.Custom[a].handler.add.call(this,f):(h.handle=function(c){c=b.extend(c||window.e,{$J_TYPE:"event"}),b.Doc.jCallEvent.call(i,a,b.$(c))},this[b._event_add_](b._event_prefix_+a,h.handle,!1))),j={type:a,fn:c,priority:e,euid:c.$J_EUID},h.push(j),h.sort(function(a,b){return a.priority-b.priority}),this):this},jRemoveEvent:function(a){var e,f,g,h,i,j,c=b.Doc.jFetch.call(this,"_EVENTS_",{});if(i=arguments.length>1?arguments[1]:-100,"string"==b.jTypeOf(a)&&(j=a.split(" "),j.length>1&&(a=j)),"array"==b.jTypeOf(a))return b.$(a).jEach(this.jRemoveEvent.jBindAsEvent(this,i)),this;if(a=d[a]||a,!a||"string"!=b.jTypeOf(a)||!c||!c[a])return this;for(e=c[a]||[],g=0;g<e.length;g++)f=e[g],(-100==i||i&&i.$J_EUID===f.euid)&&(h=e.splice(g--,1));return 0===e.length&&(b.Event.Custom[a]?b.Event.Custom[a].handler.jRemove.call(this):this[b._event_del_](b._event_prefix_+a,e.handle,!1),delete c[a]),this},jCallEvent:function(a,c){var f,h,e=b.Doc.jFetch.call(this,"_EVENTS_",{});if(a=d[a]||a,!a||"string"!=b.jTypeOf(a)||!e||!e[a])return this;try{c=b.extend(c||{},{type:a})}catch(a){}for(void 0===c.timeStamp&&(c.timeStamp=b.now()),f=e[a]||[],h=0;h<f.length&&(!c.isQueueStopped||!c.isQueueStopped());h++)f[h].fn.call(this,c)},jRaiseEvent:function(a,c){var g,e="domready"!=a,f=this;return a=d[a]||a,e?(f===document&&document.createEvent&&!f.dispatchEvent&&(f=document.documentElement),document.createEvent?(g=document.createEvent(a),g.initEvent(c,!0,!0)):(g=document.createEventObject(),g.eventType=a),document.createEvent?f.dispatchEvent(g):f.fireEvent("on"+c,g),g):(b.Doc.jCallEvent.call(this,a),this)},jClearEvents:function(){var a=b.Doc.jFetch.call(this,"_EVENTS_");if(!a)return this;for(var c in a)b.Doc.jRemoveEvent.call(this,c);return b.Doc.jDel.call(this,"_EVENTS_"),this}}),function(a){return"complete"===document.readyState?a.browser.onready.jDelay(1):void(a.browser.webkit&&a.browser.version<420?!function(){a.$(["loaded","complete"]).contains(document.readyState)?a.browser.onready():arguments.callee.jDelay(50)}():a.browser.trident&&a.browser.ieMode<9&&window==top?!function(){a.$try(function(){return a.browser.getDoc().doScroll("left"),!0})?a.browser.onready():arguments.callee.jDelay(50)}():(a.Doc.jAddEvent.call(a.$(document),"DOMContentLoaded",a.browser.onready),a.Doc.jAddEvent.call(a.$(window),"load",a.browser.onready)))}(a),b.Class=function(){var a=null,c=b.$A(arguments);"class"==b.jTypeOf(c[0])&&(a=c.shift());var d=function(){for(var a in this)this[a]=b.detach(this[a]);if(this.constructor.$parent){this.$parent={};var c=this.constructor.$parent;for(var d in c){var e=c[d];switch(b.jTypeOf(e)){case"function":this.$parent[d]=b.Class.wrap(this,e);break;case"object":this.$parent[d]=b.detach(e);break;case"array":this.$parent[d]=b.detach(e)}}}var f=this.init?this.init.apply(this,arguments):this;return delete this.caller,f};if(d.prototype.init||(d.prototype.init=b.$F),a){var e=function(){};e.prototype=a.prototype,d.prototype=new e,d.$parent={};for(var f in a.prototype)d.$parent[f]=a.prototype[f]}else d.$parent=null;return d.constructor=b.Class,d.prototype.constructor=d,b.extend(d.prototype,c[0]),b.extend(d,{$J_TYPE:"class"}),d},a.Class.wrap=function(a,b){return function(){var d=(this.caller,b.apply(a,arguments));return d}},function(a){var c=(a.$,5),d=300;a.Event.Custom.btnclick=new a.Class(a.extend(a.Event.Custom,{type:"btnclick",init:function(a,b){var c=b.jGetPageXY();this.x=c.x,this.y=c.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b)}})),a.Event.Custom.btnclick.handler={options:{threshold:d,button:1},add:function(b){this.jStore("event:btnclick:options",a.extend(a.detach(a.Event.Custom.btnclick.handler.options),b||{})),this.jAddEvent("mousedown",a.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("mouseup",a.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("click",a.Event.Custom.btnclick.handler.onclick,1),a.browser.trident&&a.browser.ieMode<9&&this.jAddEvent("dblclick",a.Event.Custom.btnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("mousedown",a.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("mouseup",a.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("click",a.Event.Custom.btnclick.handler.onclick),a.browser.trident&&a.browser.ieMode<9&&this.jRemoveEvent("dblclick",a.Event.Custom.btnclick.handler.handle)},onclick:function(a){a.stopDefaults()},handle:function(b){var d,e,f;if(e=this.jFetch("event:btnclick:options"),"dblclick"==b.type||b.getButton()==e.button){if(this.jFetch("event:btnclick:ignore"))return void this.jDel("event:btnclick:ignore");if("mousedown"==b.type)d=new a.Event.Custom.btnclick(this,b),this.jStore("event:btnclick:btnclickEvent",d);else if("mouseup"==b.type){if(d=this.jFetch("event:btnclick:btnclickEvent"),!d)return;f=b.jGetPageXY(),this.jDel("event:btnclick:btnclickEvent"),d.pushToEvents(b),b.timeStamp-d.timeStamp<=e.threshold&&Math.sqrt(Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2))<=c&&this.jCallEvent("btnclick",d),document.jCallEvent("mouseup",b)}else"dblclick"==b.type&&(d=new a.Event.Custom.btnclick(this,b),this.jCallEvent("btnclick",d))}}}}(a),function(a){var b=a.$;a.Event.Custom.mousedrag=new a.Class(a.extend(a.Event.Custom,{type:"mousedrag",state:"dragstart",dragged:!1,init:function(a,b,c){var d=b.jGetPageXY();this.x=d.x,this.y=d.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b),this.state=c}})),a.Event.Custom.mousedrag.handler={add:function(){var b=a.Event.Custom.mousedrag.handler.handleMouseMove.jBindAsEvent(this),c=a.Event.Custom.mousedrag.handler.handleMouseUp.jBindAsEvent(this);
this.jAddEvent("mousedown",a.Event.Custom.mousedrag.handler.handleMouseDown,1),this.jAddEvent("mouseup",a.Event.Custom.mousedrag.handler.handleMouseUp,1),document.jAddEvent("mousemove",b,1),document.jAddEvent("mouseup",c,1),this.jStore("event:mousedrag:listeners:document:move",b),this.jStore("event:mousedrag:listeners:document:end",c)},jRemove:function(){this.jRemoveEvent("mousedown",a.Event.Custom.mousedrag.handler.handleMouseDown),this.jRemoveEvent("mouseup",a.Event.Custom.mousedrag.handler.handleMouseUp),b(document).jRemoveEvent("mousemove",this.jFetch("event:mousedrag:listeners:document:move")||a.$F),b(document).jRemoveEvent("mouseup",this.jFetch("event:mousedrag:listeners:document:end")||a.$F),this.jDel("event:mousedrag:listeners:document:move"),this.jDel("event:mousedrag:listeners:document:end")},handleMouseDown:function(b){var c;1==b.getButton()&&(c=new a.Event.Custom.mousedrag(this,b,"dragstart"),this.jStore("event:mousedrag:dragstart",c))},handleMouseUp:function(b){var c;c=this.jFetch("event:mousedrag:dragstart"),c&&(b.stopDefaults(),c=new a.Event.Custom.mousedrag(this,b,"dragend"),this.jDel("event:mousedrag:dragstart"),this.jCallEvent("mousedrag",c))},handleMouseMove:function(b){var c;c=this.jFetch("event:mousedrag:dragstart"),c&&(b.stopDefaults(),c.dragged||(c.dragged=!0,this.jCallEvent("mousedrag",c)),c=new a.Event.Custom.mousedrag(this,b,"dragmove"),this.jCallEvent("mousedrag",c))}}}(a),function(a){a.$;a.Event.Custom.dblbtnclick=new a.Class(a.extend(a.Event.Custom,{type:"dblbtnclick",timedout:!1,tm:null,init:function(a,b){var c=b.jGetPageXY();this.x=c.x,this.y=c.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b)}})),a.Event.Custom.dblbtnclick.handler={options:{threshold:200},add:function(b){this.jStore("event:dblbtnclick:options",a.extend(a.detach(a.Event.Custom.dblbtnclick.handler.options),b||{})),this.jAddEvent("btnclick",a.Event.Custom.dblbtnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("btnclick",a.Event.Custom.dblbtnclick.handler.handle)},handle:function(b){var c,d;c=this.jFetch("event:dblbtnclick:event"),d=this.jFetch("event:dblbtnclick:options"),c?(clearTimeout(c.tm),this.jDel("event:dblbtnclick:event"),c.timedout||(c.pushToEvents(b),b.stopQueue().stop(),this.jCallEvent("dblbtnclick",c))):(c=new a.Event.Custom.dblbtnclick(this,b),c.tm=setTimeout(function(){c.timedout=!0,b.isQueueStopped=a.$false,this.jCallEvent("btnclick",b),this.jDel("event:dblbtnclick:event")}.jBind(this),d.threshold+10),this.jStore("event:dblbtnclick:event",c),b.stopQueue())}}}(a),function(a){function c(a){return a.pointerType?("touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType)&&a.isPrimary:1===a.changedTouches.length&&(!a.targetTouches.length||a.targetTouches[0].identifier==a.changedTouches[0].identifier)}function d(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a.pointerId:null:a.changedTouches[0].identifier}function e(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a:null:a.changedTouches[0]}a.$;a.Event.Custom.tap=new a.Class(a.extend(a.Event.Custom,{type:"tap",id:null,init:function(a,b){var c=e(b);this.id=c.pointerId||c.identifier,this.x=c.pageX,this.y=c.pageY,this.pageX=c.pageX,this.pageY=c.pageY,this.clientX=c.clientX,this.clientY=c.clientY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b)}}));var f=10,g=200;a.Event.Custom.tap.handler={add:function(b){this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.tap.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.tap.handler.onTouchEnd,1),this.jAddEvent("click",a.Event.Custom.tap.handler.onClick,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.tap.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.tap.handler.onTouchEnd),this.jRemoveEvent("click",a.Event.Custom.tap.handler.onClick)},onClick:function(a){a.stopDefaults()},onTouchStart:function(b){return c(b)?(this.jStore("event:tap:event",new a.Event.Custom.tap(this,b)),void this.jStore("event:btnclick:ignore",!0)):void this.jDel("event:tap:event")},onTouchEnd:function(b){var i=(a.now(),this.jFetch("event:tap:event"));this.jFetch("event:tap:options");i&&c(b)&&(this.jDel("event:tap:event"),i.id==d(b)&&b.timeStamp-i.timeStamp<=g&&Math.sqrt(Math.pow(e(b).pageX-i.x,2)+Math.pow(e(b).pageY-i.y,2))<=f&&(this.jDel("event:btnclick:btnclickEvent"),b.stop(),i.pushToEvents(b),this.jCallEvent("tap",i)))}}}(a),b.Event.Custom.dbltap=new b.Class(b.extend(b.Event.Custom,{type:"dbltap",timedout:!1,tm:null,init:function(a,b){this.x=b.x,this.y=b.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b)}})),b.Event.Custom.dbltap.handler={options:{threshold:300},add:function(a){this.jStore("event:dbltap:options",b.extend(b.detach(b.Event.Custom.dbltap.handler.options),a||{})),this.jAddEvent("tap",b.Event.Custom.dbltap.handler.handle,1)},jRemove:function(){this.jRemoveEvent("tap",b.Event.Custom.dbltap.handler.handle)},handle:function(a){var c,d;c=this.jFetch("event:dbltap:event"),d=this.jFetch("event:dbltap:options"),c?(clearTimeout(c.tm),this.jDel("event:dbltap:event"),c.timedout||(c.pushToEvents(a),a.stopQueue().stop(),this.jCallEvent("dbltap",c))):(c=new b.Event.Custom.dbltap(this,a),c.tm=setTimeout(function(){c.timedout=!0,a.isQueueStopped=b.$false,this.jCallEvent("tap",a)}.jBind(this),d.threshold+10),this.jStore("event:dbltap:event",c),a.stopQueue())}},function(a){function c(a){return a.pointerType?("touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType)&&a.isPrimary:1===a.changedTouches.length&&(!a.targetTouches.length||a.targetTouches[0].identifier==a.changedTouches[0].identifier)}function d(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a.pointerId:null:a.changedTouches[0].identifier}function e(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a:null:a.changedTouches[0]}var b=a.$,f=10;a.Event.Custom.touchdrag=new a.Class(a.extend(a.Event.Custom,{type:"touchdrag",state:"dragstart",id:null,dragged:!1,init:function(a,b,c){var d=e(b);this.id=d.pointerId||d.identifier,this.clientX=d.clientX,this.clientY=d.clientY,this.pageX=d.pageX,this.pageY=d.pageY,this.x=d.pageX,this.y=d.pageY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b),this.state=c}})),a.Event.Custom.touchdrag.handler={add:function(){var c=a.Event.Custom.touchdrag.handler.onTouchMove.jBind(this),d=a.Event.Custom.touchdrag.handler.onTouchEnd.jBind(this);this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.touchdrag.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.touchdrag.handler.onTouchEnd,1),this.jAddEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],a.Event.Custom.touchdrag.handler.onTouchMove,1),this.jStore("event:touchdrag:listeners:document:move",c),this.jStore("event:touchdrag:listeners:document:end",d),b(document).jAddEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",c,1),b(document).jAddEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",d,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.touchdrag.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.touchdrag.handler.onTouchEnd),this.jRemoveEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],a.Event.Custom.touchdrag.handler.onTouchMove),b(document).jRemoveEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",this.jFetch("event:touchdrag:listeners:document:move")||a.$F,1),b(document).jRemoveEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",this.jFetch("event:touchdrag:listeners:document:end")||a.$F,1),this.jDel("event:touchdrag:listeners:document:move"),this.jDel("event:touchdrag:listeners:document:end")},onTouchStart:function(b){var d;c(b)&&(d=new a.Event.Custom.touchdrag(this,b,"dragstart"),this.jStore("event:touchdrag:dragstart",d))},onTouchEnd:function(b){var c;c=this.jFetch("event:touchdrag:dragstart"),c&&c.dragged&&c.id==d(b)&&(c=new a.Event.Custom.touchdrag(this,b,"dragend"),this.jDel("event:touchdrag:dragstart"),this.jCallEvent("touchdrag",c))},onTouchMove:function(b){var g;if(g=this.jFetch("event:touchdrag:dragstart"),g&&c(b)){if(g.id!=d(b))return void this.jDel("event:touchdrag:dragstart");!g.dragged&&Math.sqrt(Math.pow(e(b).pageX-g.x,2)+Math.pow(e(b).pageY-g.y,2))>f&&(g.dragged=!0,this.jCallEvent("touchdrag",g)),g.dragged&&(g=new a.Event.Custom.touchdrag(this,b,"dragmove"),this.jCallEvent("touchdrag",g))}}}}(a),b.Event.Custom.touchpinch=new b.Class(b.extend(b.Event.Custom,{type:"touchpinch",scale:1,previousScale:1,curScale:1,state:"pinchstart",init:function(a,b){this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.x=b.touches[0].clientX+(b.touches[1].clientX-b.touches[0].clientX)/2,this.y=b.touches[0].clientY+(b.touches[1].clientY-b.touches[0].clientY)/2,this._initialDistance=Math.sqrt(Math.pow(b.touches[0].clientX-b.touches[1].clientX,2)+Math.pow(b.touches[0].clientY-b.touches[1].clientY,2)),this.pushToEvents(b)},update:function(a){var b;this.state="pinchupdate",a.changedTouches[0].identifier==this.events[0].touches[0].identifier&&a.changedTouches[1].identifier==this.events[0].touches[1].identifier&&(b=Math.sqrt(Math.pow(a.changedTouches[0].clientX-a.changedTouches[1].clientX,2)+Math.pow(a.changedTouches[0].clientY-a.changedTouches[1].clientY,2)),this.previousScale=this.scale,this.scale=b/this._initialDistance,this.curScale=this.scale/this.previousScale,this.x=a.changedTouches[0].clientX+(a.changedTouches[1].clientX-a.changedTouches[0].clientX)/2,this.y=a.changedTouches[0].clientY+(a.changedTouches[1].clientY-a.changedTouches[0].clientY)/2,this.pushToEvents(a))}})),b.Event.Custom.touchpinch.handler={add:function(){this.jAddEvent("touchstart",b.Event.Custom.touchpinch.handler.handleTouchStart,1),this.jAddEvent("touchend",b.Event.Custom.touchpinch.handler.handleTouchEnd,1),this.jAddEvent("touchmove",b.Event.Custom.touchpinch.handler.handleTouchMove,1)},jRemove:function(){this.jRemoveEvent("touchstart",b.Event.Custom.touchpinch.handler.handleTouchStart),this.jRemoveEvent("touchend",b.Event.Custom.touchpinch.handler.handleTouchEnd),this.jRemoveEvent("touchmove",b.Event.Custom.touchpinch.handler.handleTouchMove)},handleTouchStart:function(a){var c;2==a.touches.length&&(a.stopDefaults(),c=new b.Event.Custom.touchpinch(this,a),this.jStore("event:touchpinch:event",c))},handleTouchEnd:function(a){var b;b=this.jFetch("event:touchpinch:event"),b&&(a.stopDefaults(),this.jDel("event:touchpinch:event"))},handleTouchMove:function(a){var b;b=this.jFetch("event:touchpinch:event"),b&&(a.stopDefaults(),b.update(a),this.jCallEvent("touchpinch",b))}},function(a){function e(){c=null}function f(b,c){return b>50||1===c&&!("win"==a.browser.platform&&b<1)||0===b%12||0==b%4.000244140625}a.$;a.Event.Custom.mousescroll=new a.Class(a.extend(a.Event.Custom,{type:"mousescroll",init:function(a,b,c,d,e,f,g){var h=b.jGetPageXY();this.x=h.x,this.y=h.y,this.timeStamp=b.timeStamp,this.target=a,this.delta=c||0,this.deltaX=d||0,this.deltaY=e||0,this.deltaZ=f||0,this.deltaFactor=g||0,this.deltaMode=b.deltaMode||0,this.isMouse=!1,this.pushToEvents(b)}}));var c,d;a.Event.Custom.mousescroll.handler={eventType:"onwheel"in document||a.browser.ieMode>8?"wheel":"mousewheel",add:function(){this.jAddEvent(a.Event.Custom.mousescroll.handler.eventType,a.Event.Custom.mousescroll.handler.handle,1)},jRemove:function(){this.jRemoveEvent(a.Event.Custom.mousescroll.handler.eventType,a.Event.Custom.mousescroll.handler.handle,1)},handle:function(b){var k,l,g=0,h=0,i=0,j=0;b.detail&&(i=b.detail*-1),void 0!==b.wheelDelta&&(i=b.wheelDelta),void 0!==b.wheelDeltaY&&(i=b.wheelDeltaY),void 0!==b.wheelDeltaX&&(h=b.wheelDeltaX*-1),b.deltaY&&(i=-1*b.deltaY),b.deltaX&&(h=b.deltaX),0===i&&0===h||(g=0===i?h:i,j=Math.max(Math.abs(i),Math.abs(h)),(!c||j<c)&&(c=j),k=g>0?"floor":"ceil",g=Math[k](g/c),h=Math[k](h/c),i=Math[k](i/c),d&&clearTimeout(d),d=setTimeout(e,200),l=new a.Event.Custom.mousescroll(this,b,g,h,i,0,c),l.isMouse=f(c,b.deltaMode||0),this.jCallEvent("mousescroll",l))}}}(a),b.win=b.$(window),b.doc=b.$(document),a}(),function(b){if(!b)throw"MagicJS not found";var c=b.$,d=window.URL||window.webkitURL||null;a.ImageLoader=new b.Class({img:null,ready:!1,options:{onprogress:b.$F,onload:b.$F,onabort:b.$F,onerror:b.$F,oncomplete:b.$F,onxhrerror:b.$F,xhr:!1,progressiveLoad:!0},size:null,_timer:null,loadedBytes:0,_handlers:{onprogress:function(a){a.target&&(200===a.target.status||304===a.target.status)&&a.lengthComputable&&(this.options.onprogress.jBind(null,(a.loaded-(this.options.progressiveLoad?this.loadedBytes:0))/a.total).jDelay(1),this.loadedBytes=a.loaded)},onload:function(a){a&&c(a).stop(),this._unbind(),this.ready||(this.ready=!0,this._cleanup(),!this.options.xhr&&this.options.onprogress.jBind(null,1).jDelay(1),this.options.onload.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1))},onabort:function(a){a&&c(a).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onabort.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)},onerror:function(a){a&&c(a).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onerror.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)}},_bind:function(){c(["load","abort","error"]).jEach(function(a){this.img.jAddEvent(a,this._handlers["on"+a].jBindAsEvent(this).jDefer(1))},this)},_unbind:function(){if(this._timer){try{clearTimeout(this._timer)}catch(a){}this._timer=null}c(["load","abort","error"]).jEach(function(a){this.img.jRemoveEvent(a)},this)},_cleanup:function(){if(this.jGetSize(),this.img.jFetch("new")){var a=this.img.parentNode;this.img.jRemove().jDel("new").jSetCss({position:"static",top:"auto"}),a.kill()}},loadBlob:function(a){var f,e=new XMLHttpRequest;c(["abort","progress"]).jEach(function(a){e["on"+a]=c(function(b){this._handlers["on"+a].call(this,b)}).jBind(this)},this),e.onerror=c(function(){this.options.onxhrerror.jBind(null,this).jDelay(1),this.options.xhr=!1,this._bind(),this.img.src=a}).jBind(this),e.onload=c(function(){return 200!==e.status&&304!==e.status?void this._handlers.onerror.call(this):(f=e.response,this._bind(),void(!d||b.browser.trident||"ios"===b.browser.platform&&b.browser.version<537?this.img.src=a:this.img.setAttribute("src",d.createObjectURL(f))))}).jBind(this),e.open("GET",a),e.responseType="blob",e.send()},init:function(a,d){if(this.options=b.extend(this.options,d),this.img=c(a)||b.$new("img",{},{"max-width":"none","max-height":"none"}).jAppendTo(b.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e4,width:10,height:10,overflow:"hidden"}).jAppendTo(document.body)).jStore("new",!0),b.browser.features.xhr2&&this.options.xhr&&"string"==b.jTypeOf(a))return void this.loadBlob(a);var e=function(){this.isReady()?this._handlers.onload.call(this):this._handlers.onerror.call(this),e=null}.jBind(this);this._bind(),"string"==b.jTypeOf(a)?this.img.src=a:(b.browser.trident&&5==b.browser.version&&b.browser.ieMode<9&&(this.img.onreadystatechange=function(){/loaded|complete/.test(this.img.readyState)&&(this.img.onreadystatechange=null,e&&e())}.jBind(this)),this.img.src=a.getAttribute("src")),this.img&&this.img.complete&&e&&(this._timer=e.jDelay(100))},destroy:function(){return this._unbind(),this._cleanup(),this.ready=!1,this},isReady:function(){var a=this.img;return a.naturalWidth?a.naturalWidth>0:a.readyState?"complete"==a.readyState:a.width>0},jGetSize:function(){return this.size||(this.size={width:this.img.naturalWidth||this.img.width,height:this.img.naturalHeight||this.img.height})}})}(a),function(a){if(!a)throw"MagicJS not found";if(!a.FX){var b=a.$;a.FX=new a.Class({init:function(b,c){var d;this.el=a.$(b),this.options=a.extend(this.options,c),this.timer=!1,this.easeFn=this.cubicBezierAtTime,d=a.FX.Transition[this.options.transition]||this.options.transition,"function"===a.jTypeOf(d)?this.easeFn=d:this.cubicBezier=this.parseCubicBezier(d)||this.parseCubicBezier("ease"),"string"==a.jTypeOf(this.options.cycles)&&(this.options.cycles="infinite"===this.options.cycles?1/0:parseInt(this.options.cycles)||1)},options:{fps:60,duration:600,transition:"ease",cycles:1,direction:"normal",onStart:a.$F,onComplete:a.$F,onBeforeRender:a.$F,onAfterRender:a.$F,forceAnimation:!1,roundCss:!1},styles:null,cubicBezier:null,easeFn:null,setTransition:function(b){this.options.transition=b,b=a.FX.Transition[this.options.transition]||this.options.transition,"function"===a.jTypeOf(b)?this.easeFn=b:(this.easeFn=this.cubicBezierAtTime,this.cubicBezier=this.parseCubicBezier(b)||this.parseCubicBezier("ease"))},start:function(b){var d,c=/\%$/;this.styles=b,this.cycle=0,this.state=0,this.curFrame=0,this.pStyles={},this.alternate="alternate"===this.options.direction||"alternate-reverse"===this.options.direction,this.continuous="continuous"===this.options.direction||"continuous-reverse"===this.options.direction;for(d in this.styles)c.test(this.styles[d][0])&&(this.pStyles[d]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles[d].reverse();return this.startTime=a.now(),this.finishTime=this.startTime+this.options.duration,this.options.onStart.call(),0===this.options.duration?(this.render(1),this.options.onComplete.call()):(this.loopBind=this.loop.jBind(this),!this.options.forceAnimation&&a.browser.features.requestAnimationFrame?this.timer=a.browser.requestAnimationFrame.call(window,this.loopBind):this.timer=this.loopBind.interval(Math.round(1e3/this.options.fps))),this},stopAnimation:function(){this.timer&&(!this.options.forceAnimation&&a.browser.features.requestAnimationFrame&&a.browser.cancelAnimationFrame?a.browser.cancelAnimationFrame.call(window,this.timer):clearInterval(this.timer),this.timer=!1)},stop:function(b){return b=!!a.defined(b)&&b,this.stopAnimation(),b&&(this.render(1),this.options.onComplete.jDelay(10)),this},calc:function(a,b,c){return a=parseFloat(a),b=parseFloat(b),(b-a)*c+a},loop:function(){var b=a.now(),c=(b-this.startTime)/this.options.duration,d=Math.floor(c);if(b>=this.finishTime&&d>=this.options.cycles)return this.stopAnimation(),this.render(1),this.options.onComplete.jDelay(10),this;if(this.alternate&&this.cycle<d)for(var e in this.styles)this.styles[e].reverse();this.cycle=d,!this.options.forceAnimation&&a.browser.features.requestAnimationFrame&&(this.timer=a.browser.requestAnimationFrame.call(window,this.loopBind)),this.render((this.continuous?d:0)+this.easeFn(c%1))},render:function(a){var b={};for(var d in this.styles)"opacity"===d?b[d]=Math.round(100*this.calc(this.styles[d][0],this.styles[d][1],a))/100:(b[d]=this.calc(this.styles[d][0],this.styles[d][1],a),this.pStyles[d]&&(b[d]+="%"));this.options.onBeforeRender(b,this.el),this.set(b),this.options.onAfterRender(b,this.el)},set:function(a){return this.el.jSetCss(a)},parseCubicBezier:function(c){var d,e=null;if("string"!==a.jTypeOf(c))return null;switch(c){case"linear":e=b([0,0,1,1]);break;case"ease":e=b([.25,.1,.25,1]);break;case"ease-in":e=b([.42,0,1,1]);break;case"ease-out":e=b([0,0,.58,1]);break;case"ease-in-out":e=b([.42,0,.58,1]);break;case"easeInSine":e=b([.47,0,.745,.715]);break;case"easeOutSine":e=b([.39,.575,.565,1]);break;case"easeInOutSine":e=b([.445,.05,.55,.95]);break;case"easeInQuad":e=b([.55,.085,.68,.53]);break;case"easeOutQuad":e=b([.25,.46,.45,.94]);break;case"easeInOutQuad":e=b([.455,.03,.515,.955]);break;case"easeInCubic":e=b([.55,.055,.675,.19]);break;case"easeOutCubic":e=b([.215,.61,.355,1]);break;case"easeInOutCubic":e=b([.645,.045,.355,1]);break;case"easeInQuart":e=b([.895,.03,.685,.22]);break;case"easeOutQuart":e=b([.165,.84,.44,1]);break;case"easeInOutQuart":e=b([.77,0,.175,1]);break;case"easeInQuint":e=b([.755,.05,.855,.06]);break;case"easeOutQuint":e=b([.23,1,.32,1]);break;case"easeInOutQuint":e=b([.86,0,.07,1]);break;case"easeInExpo":e=b([.95,.05,.795,.035]);break;case"easeOutExpo":e=b([.19,1,.22,1]);break;case"easeInOutExpo":e=b([1,0,0,1]);break;case"easeInCirc":e=b([.6,.04,.98,.335]);break;case"easeOutCirc":e=b([.075,.82,.165,1]);break;case"easeInOutCirc":e=b([.785,.135,.15,.86]);break;case"easeInBack":e=b([.6,-.28,.735,.045]);break;case"easeOutBack":e=b([.175,.885,.32,1.275]);break;case"easeInOutBack":e=b([.68,-.55,.265,1.55]);break;default:if(c=c.replace(/\s/g,""),c.match(/^cubic-bezier\((?:-?[0-9\.]{0,}[0-9]{1,},){3}(?:-?[0-9\.]{0,}[0-9]{1,})\)$/))for(e=c.replace(/^cubic-bezier\s*\(|\)$/g,"").split(","),d=e.length-1;d>=0;d--)e[d]=parseFloat(e[d])}return b(e)},cubicBezierAtTime:function(a){function i(a){return((b*a+c)*a+d)*a}function j(a){return((e*a+f)*a+g)*a}function k(a){return(3*b*a+2*c)*a+d}function l(a){return 1/(200*a)}function m(a,b){return j(n(a,b))}function n(a,b){function j(a){return a>=0?a:0-a}var c,d,e,f,g,h;for(e=a,h=0;h<8;h++){if(f=i(e)-a,j(f)<b)return e;if(g=k(e),j(g)<1e-6)break;e-=f/g}if(c=0,d=1,e=a,e<c)return c;if(e>d)return d;for(;c<d;){if(f=i(e),j(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e}var b=0,c=0,d=0,e=0,f=0,g=0,h=this.options.duration;return d=3*this.cubicBezier[0],c=3*(this.cubicBezier[2]-this.cubicBezier[0])-d,b=1-d-c,g=3*this.cubicBezier[1],f=3*(this.cubicBezier[3]-this.cubicBezier[1])-g,e=1-g-f,m(a,l(h))}}),a.FX.Transition={linear:"linear",sineIn:"easeInSine",sineOut:"easeOutSine",expoIn:"easeInExpo",expoOut:"easeOutExpo",quadIn:"easeInQuad",quadOut:"easeOutQuad",cubicIn:"easeInCubic",cubicOut:"easeOutCubic",backIn:"easeInBack",backOut:"easeOutBack",elasticIn:function(a,b){return b=b||[],Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b[0]||1)/3)},elasticOut:function(b,c){return 1-a.FX.Transition.elasticIn(1-b,c)},bounceIn:function(a){for(var b=0,c=1;1;b+=c,c/=2)if(a>=(7-4*b)/11)return c*c-Math.pow((11-6*b-11*a)/4,2)},bounceOut:function(b){return 1-a.FX.Transition.bounceIn(1-b)},none:function(a){return 0}}}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.PFX){a.$;a.PFX=new a.Class(a.FX,{init:function(b,c){this.el_arr=b,this.options=a.extend(this.options,c),this.timer=!1,this.$parent.init()},start:function(a){var c,d,b=/\%$/,e=a.length;for(this.styles_arr=a,this.pStyles_arr=new Array(e),d=0;d<e;d++){this.pStyles_arr[d]={};for(c in a[d])b.test(a[d][c][0])&&(this.pStyles_arr[d][c]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles_arr[d][c].reverse()}return this.$parent.start([]),this},render:function(b){for(var c=0;c<this.el_arr.length;c++)this.el=a.$(this.el_arr[c]),this.styles=this.styles_arr[c],this.pStyles=this.pStyles_arr[c],this.$parent.render(b)}})}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.Tooltip){a.$;a.Tooltip=function(b,c){var d=this.tooltip=a.$new("div",null,{position:"absolute","z-index":999}).jAddClass("MagicToolboxTooltip");a.$(b).jAddEvent("mouseover",function(){d.jAppendTo(document.body)}),a.$(b).jAddEvent("mouseout",function(){d.jRemove()}),a.$(b).jAddEvent("mousemove",function(b){function i(a,b,c){return c<(a-b)/2?c:c>(a+b)/2?c-b:(a-b)/2}var c=20,e=a.$(b).jGetPageXY(),f=d.jGetSize(),g=a.$(window).jGetSize(),h=a.$(window).jGetScroll();d.jSetCss({left:h.x+i(g.width,f.width+2*c,e.x-h.x)+c,top:h.y+i(g.height,f.height+2*c,e.y-h.y)+c})}),this.text(c)},a.Tooltip.prototype.text=function(a){this.tooltip.firstChild&&this.tooltip.removeChild(this.tooltip.firstChild),this.tooltip.append(document.createTextNode(a))}}}(a),function(b){if(!b)throw"MagicJS not found";if(!b.MessageBox){b.$;b.Message=function(a,c,d,e){this.hideTimer=null,this.messageBox=b.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden",opacity:.8}).jAddClass(e||"").jAppendTo(d||document.body),this.setMessage(a),this.show(c)},b.Message.prototype.show=function(a){this.messageBox.show(),this.hideTimer=this.hide.jBind(this).jDelay(b.ifndef(a,5e3))},b.Message.prototype.hide=function(c){clearTimeout(this.hideTimer),this.hideTimer=null,this.messageBox&&!this.hideFX&&(this.hideFX=new a.FX(this.messageBox,{duration:b.ifndef(c,500),onComplete:function(){this.messageBox.kill(),delete this.messageBox,this.hideFX=null}.jBind(this)}).start({opacity:[this.messageBox.jGetCss("opacity"),0]}))},b.Message.prototype.setMessage=function(a){this.messageBox.firstChild&&this.tooltip.removeChild(this.messageBox.firstChild),this.messageBox.append(document.createTextNode(a))}}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.Options){var b=a.$,c=null,d={boolean:1,array:2,number:3,function:4,string:100},e={boolean:function(d,e,f){if("boolean"!=a.jTypeOf(e)){if(f||"string"!=a.jTypeOf(e))return!1;if(!/^(true|false)$/.test(e))return!1;e=e.jToBool()}return!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(c=e,!0)},string:function(d,e,f){return"string"===a.jTypeOf(e)&&(!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(c=""+e,!0))},number:function(d,e,f){var h=/%$/,i="string"==a.jTypeOf(e)&&h.test(e);return(!f||0!=typeof e)&&(e=parseFloat(e),!isNaN(e)&&(isNaN(d.minimum)&&(d.minimum=Number.NEGATIVE_INFINITY),isNaN(d.maximum)&&(d.maximum=Number.POSITIVE_INFINITY),!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(!(d.minimum>e||e>d.maximum)&&(c=i?e+"%":e,!0))))},array:function(b,d,e){if("string"===a.jTypeOf(d))try{d=window.JSON.parse(d)}catch(a){return!1}return"array"===a.jTypeOf(d)&&(c=d,!0)},function:function(b,d,e){return"function"===a.jTypeOf(d)&&(c=d,!0)}},f=function(b,c,d){var f;if(f=b.hasOwnProperty("oneOf")?b.oneOf:[b],"array"!=a.jTypeOf(f))return!1;for(var g=0,h=f.length-1;g<=h;g++)if(e[f[g].type](f[g],c,d))return!0;return!1},g=function(a){var b,c,f,g;if(a.hasOwnProperty("oneOf"))for(f=a.oneOf.length,b=0;b<f;b++)for(c=b+1;c<f;c++)d[a.oneOf[b].type]>d[a.oneOf[c].type]&&(g=a.oneOf[b],a.oneOf[b]=a.oneOf[c],a.oneOf[c]=g);return a},h=function(b){var c;if(c=b.hasOwnProperty("oneOf")?b.oneOf:[b],"array"!=a.jTypeOf(c))return!1;for(var g=c.length-1;g>=0;g--){if(!c[g].type||!d.hasOwnProperty(c[g].type))return!1;if(a.defined(c[g].enum)){if("array"!==a.jTypeOf(c[g].enum))return!1;for(var h=c[g].enum.length-1;h>=0;h--)if(!e[c[g].type]({type:c[g].type},c[g].enum[h],!0))return!1}}return!(b.hasOwnProperty("default")&&!f(b,b.default,!0))},i=function(a){this.schema={},this.options={},this.parseSchema(a)};a.extend(i.prototype,{parseSchema:function(a){var b,c;for(b in a)if(a.hasOwnProperty(b)&&(c=(b+"").jTrim().jCamelize(),!this.schema.hasOwnProperty(c))){if(this.schema[c]=g(a[b]),!h(this.schema[c]))throw"Incorrect definition of the '"+b+"' parameter in "+a;this.options[c]=void 0}},set:function(b,d){b=(b+"").jTrim().jCamelize(),"string"==a.jTypeOf(d)&&(d=d.jTrim()),this.schema.hasOwnProperty(b)&&(c=d,f(this.schema[b],d)&&(this.options[b]=c),c=null)},get:function(b){if(b=(b+"").jTrim().jCamelize(),this.schema.hasOwnProperty(b))return a.defined(this.options[b])?this.options[b]:this.schema[b].default},fromJSON:function(a){for(var b in a)this.set(b,a[b])},getJSON:function(){var b=a.extend({},this.options);for(var c in b)void 0===b[c]&&void 0!==this.schema[c].default&&(b[c]=this.schema[c].default);return b},fromString:function(a){b(a.split(";")).jEach(b(function(a){a=a.split(":"),this.set(a.shift().jTrim(),a.join(":"))}).jBind(this))},exists:function(a){return a=(a+"").jTrim().jCamelize(),this.schema.hasOwnProperty(a)},isset:function(b){return b=(b+"").jTrim().jCamelize(),this.exists(b)&&a.defined(this.options[b])},jRemove:function(a){a=(a+"").jTrim().jCamelize(),this.exists(a)&&(delete this.options[a],delete this.schema[a])}}),a.Options=i}}(a),function(a){if(!a)throw"MagicJS not found";var b=a.$;if(!a.SVGImage){var c="http://www.w3.org/2000/svg",d="http://www.w3.org/1999/xlink",e=function(a){this.filters={},this.originalImage=b(a),this.canvas=b(document.createElementNS(c,"svg")),this.canvas.setAttribute("width",this.originalImage.naturalWidth||this.originalImage.width),this.canvas.setAttribute("height",this.originalImage.naturalHeight||this.originalImage.height),this.image=b(document.createElementNS(c,"image")),this.image.setAttributeNS(d,"href",this.originalImage.getAttribute("src")),this.image.setAttribute("width","100%"),this.image.setAttribute("height","100%"),this.image.jAppendTo(this.canvas)};e.prototype.getNode=function(){return this.canvas},e.prototype.blur=function(a){if(!(Math.round(a)<1))return this.filters.blur?this.filters.blur.firstChild.setAttribute("stdDeviation",a):(this.filters.blur=b(document.createElementNS(c,"filter")),this.filters.blur.setAttribute("id","filterBlur"),this.filters.blur.appendChild(b(document.createElementNS(c,"feGaussianBlur")).setProps({in:"SourceGraphic",stdDeviation:a})),this.filters.blur.jAppendTo(this.canvas),this.image.setAttribute("filter","url(#filterBlur)")),this},a.SVGImage=e}}(a);var c=function(a){var b=a.$,c=function(b,c){this.settings={cssPrefix:"magic",orientation:"horizontal",position:"bottom",size:{units:"px",width:"auto",height:"auto"},sides:["height","width"]},this.parent=b,this.root=null,this.wrapper=null,this.context=null,this.buttons={},this.items=[],this.selectedItem=null,this.scrollFX=null,this.resizeCallback=null,this.settings=a.extend(this.settings,c),this.rootCSS=this.settings.cssPrefix+"-thumbs",this.itemCSS=this.settings.cssPrefix+"-thumb",this.setupContent()};return c.prototype={setupContent:function(){this.root=a.$new("div").jAddClass(this.rootCSS).jAddClass(this.rootCSS+"-"+this.settings.orientation).jSetCss({visibility:"hidden"}),this.wrapper=a.$new("div").jAddClass(this.rootCSS+"-wrapper").jAppendTo(this.root),this.root.jAppendTo(this.parent),b(["prev","next"]).jEach(function(c){this.buttons[c]=a.$new("button").jAddClass(this.rootCSS+"-button").jAddClass(this.rootCSS+"-button-"+c).jAppendTo(this.root).jAddEvent("btnclick tap",function(a,c){b(a).events[0].stop().stopQueue(),b(a).stopDistribution(),this.scroll(c)}.jBindAsEvent(this,c))}.jBind(this)),this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"),this.context=a.$new("ul").jAddEvent("btnclick tap",function(a){a.stop()})},addItem:function(b){var c=a.$new("li").jAddClass(this.itemCSS).append(b).jAppendTo(this.context);return new a.ImageLoader(b,{oncomplete:this.reflow.jBind(this)}),this.items.push(c),c},selectItem:function(a){var c=this.selectedItem||this.context.byClass(this.itemCSS+"-selected")[0];c&&b(c).jRemoveClass(this.itemCSS+"-selected"),this.selectedItem=b(a),this.selectedItem&&(this.selectedItem.jAddClass(this.itemCSS+"-selected"),this.scroll(this.selectedItem))},run:function(){if(this.wrapper!==this.context.parentNode)return b(this.context).jAppendTo(this.wrapper),this.initDrag(),b(window).jAddEvent("resize",this.resizeCallback=this.reflow.jBind(this)),void this.run.jBind(this).jDelay(1);var a=this.parent.jGetSize();a.height>0&&a.height>a.width?this.setOrientation("vertical"):this.setOrientation("horizontal"),this.reflow(),this.root.jSetCss({visibility:""})},stop:function(){this.resizeCallback&&b(window).jRemoveEvent("resize",this.resizeCallback),this.root.kill()},scroll:function(b,c){var k,l,m,q,d={x:0,y:0},e="vertical"==this.settings.orientation?"top":"left",f="vertical"==this.settings.orientation?"height":"width",g="vertical"==this.settings.orientation?"y":"x",h=this.context.parentNode.jGetSize()[f],i=this.context.parentNode.jGetPosition(),j=this.context.jGetSize()[f],r=[];if(this.scrollFX?this.scrollFX.stop():this.context.jSetCss("transition",a.browser.cssTransformProp+String.fromCharCode(32)+"0s"),
void 0===c&&(c=600),k=this.context.jGetPosition(),"string"==a.jTypeOf(b))d[g]="next"==b?Math.max(k[e]-i[e]-h,h-j):Math.min(k[e]-i[e]+h,0);else{if("element"!=a.jTypeOf(b))return;l=b.jGetSize(),m=b.jGetPosition(),d[g]=Math.min(0,Math.max(h-j,k[e]+h/2-m[e]-l[f]/2))}a.browser.gecko&&"android"==a.browser.platform||a.browser.ieMode&&a.browser.ieMode<10?("string"==a.jTypeOf(b)&&d[g]==k[e]-i[e]&&(k[e]+=0===k[e]-i[e]?30:-30),d["margin-"+e]=[j<=h?0:k[e]-i[e],d[g]],delete d.x,delete d.y,this.selectorsMoveFX||(this.selectorsMoveFX=new a.PFX([this.context],{duration:500})),r.push(d),this.selectorsMoveFX.start(r),q=d["margin-"+e][1]):(this.context.jSetCss({transition:a.browser.cssTransformProp+String.fromCharCode(32)+c+"ms ease",transform:"translate3d("+d.x+"px, "+d.y+"px, 0)"}),q=d[g]),q>=0?this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.prev.jRemoveClass(this.rootCSS+"-button-disabled"),q<=h-j?this.buttons.next.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled"),q=null},initDrag:function(){var c,e,f,g,h,i,j,k,l,m,n,o,q,r,p={x:0,y:0},s=300,t=function(a){var b,c=0;for(b=1.5;b<=90;b+=1.5)c+=a*Math.cos(b/Math.PI/2);return f<0&&(c*=-1),c};g=b(function(b){if(p={x:0,y:0},q="vertical"==this.settings.orientation?"top":"left",r="vertical"==this.settings.orientation?"height":"width",c="vertical"==this.settings.orientation?"y":"x",n=this.context.parentNode.jGetSize()[r],m=this.context.jGetSize()[r],e=n-m,!(e>=0))if("dragstart"==b.state)void 0===o&&(o=0),this.context.jSetCssProp("transition",a.browser.cssTransformProp+String.fromCharCode(32)+"0ms"),h=b[c],k=b.y,j=b.x,l=!1;else{if("dragend"==b.state){if(l)return;i=t(Math.abs(f)),o+=i,o<=e&&(o=e),o>=0&&(o=0),p[c]=o,this.context.jSetCssProp("transition",a.browser.cssTransformProp+String.fromCharCode(32)+s+"ms  cubic-bezier(.0, .0, .0, 1)"),this.context.jSetCssProp("transform","translate3d("+p.x+"px, "+p.y+"px, 0px)"),f=0}else{if(l)return;"horizontal"==this.settings.orientation&&Math.abs(b.x-j)>Math.abs(b.y-k)||"vertical"==this.settings.orientation&&Math.abs(b.x-j)<Math.abs(b.y-k)?(b.stop(),f=b[c]-h,o+=f,p[c]=o,this.context.jSetCssProp("transform","translate3d("+p.x+"px, "+p.y+"px, 0px)"),o>=0?this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.prev.jRemoveClass(this.rootCSS+"-button-disabled"),o<=e?this.buttons.next.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled")):l=!0}h=b[c]}}).jBind(this),this.context.jAddEvent("touchdrag",g)},reflow:function(){var a,b,c,d=this.parent.jGetSize();d.height>0&&d.height>d.width?this.setOrientation("vertical"):this.setOrientation("horizontal"),a="vertical"==this.settings.orientation?"height":"width",b=this.context.jGetSize()[a],c=this.root.jGetSize()[a],b<=c?(this.root.jAddClass("no-buttons"),this.context.jSetCssProp("transition","").jGetSize(),this.context.jSetCssProp("transform","translate3d(0,0,0)"),this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"),this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled")):this.root.jRemoveClass("no-buttons"),this.selectedItem&&this.scroll(this.selectedItem,0)},setOrientation:function(a){"vertical"!==a&&"horizontal"!==a||a==this.settings.orientation||(this.root.jRemoveClass(this.rootCSS+"-"+this.settings.orientation),this.settings.orientation=a,this.root.jAddClass(this.rootCSS+"-"+this.settings.orientation),this.context.jSetCssProp("transition","none").jGetSize(),this.context.jSetCssProp("transform","").jSetCssProp("margin",""))}},c}(a),d=b.$;b.browser.cssTransform||(b.browser.cssTransform=b.normalizeCSS("transform").dashize());var k,n,p,e={zoomOn:{type:"string",enum:["click","hover"],default:"hover"},zoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","preview","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},zoomWidth:{oneOf:[{type:"string",enum:["auto"]},{type:"number",minimum:1}],default:"auto"},zoomHeight:{oneOf:[{type:"string",enum:["auto"]},{type:"number",minimum:1}],default:"auto"},zoomPosition:{type:"string",default:"right"},zoomDistance:{type:"number",minimum:0,default:15},zoomCaption:{oneOf:[{type:"string",enum:["bottom","top","off"],default:"off"},{type:"boolean",enum:[!1]}],default:"off"},expand:{oneOf:[{type:"string",enum:["window","fullscreen","off"]},{type:"boolean",enum:[!1]}],default:"window"},expandZoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},expandZoomOn:{type:"string",enum:["click","always"],default:"click"},expandCaption:{type:"boolean",default:!0},closeOnClickOutside:{type:"boolean",default:!0},hint:{oneOf:[{type:"string",enum:["once","always","off"]},{type:"boolean",enum:[!1]}],default:"once"},smoothing:{type:"boolean",default:!0},upscale:{type:"boolean",default:!0},variableZoom:{type:"boolean",default:!1},lazyZoom:{type:"boolean",default:!1},autostart:{type:"boolean",default:!0},rightClick:{type:"boolean",default:!1},transitionEffect:{type:"boolean",default:!0},selectorTrigger:{type:"string",enum:["click","hover"],default:"click"},cssClass:{type:"string"},forceTouch:{type:"boolean",default:!1},textHoverZoomHint:{type:"string",default:"Hover to zoom"},textClickZoomHint:{type:"string",default:"Click to zoom"},textExpandHint:{type:"string",default:"Click to expand"},textBtnClose:{type:"string",default:"Close"},textBtnNext:{type:"string",default:"Next"},textBtnPrev:{type:"string",default:"Previous"}},f={zoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},expandZoomOn:{type:"string",enum:["click","always"],default:"click"},textExpandHint:{type:"string",default:"Tap to expand"},textHoverZoomHint:{type:"string",default:"Touch to zoom"},textClickZoomHint:{type:"string",default:"Double tap to zoom"}},h="mz",i=20,j=["onZoomReady","onUpdate","onZoomIn","onZoomOut","onExpandOpen","onExpandClose"],l={},m=d([]),o=window.devicePixelRatio||1,q=!0,r=b.browser.features.perspective?"translate3d(":"translate(",s=b.browser.features.perspective?",0)":")",t=null,u=function(){var e;return e}(),v=function(){return"mgctlbxN$MZ"+"p".toUpperCase()+" mgctlbxV$"+"v5.1.11".replace("v","")+" mgctlbxL$"+"c".toUpperCase()+(window.mgctlbx$Pltm&&"string"==b.jTypeOf(window.mgctlbx$Pltm)?" mgctlbxP$"+window.mgctlbx$Pltm.toLowerCase():"")},F=function(a,c,d,e,f){this.small={src:null,url:null,dppx:1,node:null,state:0,size:{width:0,height:0},loaded:!1},this.zoom={src:null,url:null,dppx:1,node:null,state:0,size:{width:0,height:0},loaded:!1},"object"==b.jTypeOf(a)?this.small=a:"string"==b.jTypeOf(a)&&(this.small.url=b.getAbsoluteURL(a)),"object"==b.jTypeOf(c)?this.zoom=c:"string"==b.jTypeOf(c)&&(this.zoom.url=b.getAbsoluteURL(c)),this.caption=d,this.options=e,this.origin=f,this.callback=null,this.link=null,this.node=null};F.prototype={parseNode:function(a,c,d){var e=a.byTag("img")[0];return d&&(this.small.node=e||b.$new("img").jAppendTo(a)),o>1&&(this.small.url=a.getAttribute("data-image-2x"),this.small.url&&(this.small.dppx=2),this.zoom.url=a.getAttribute("data-zoom-image-2x"),this.zoom.url&&(this.zoom.dppx=2)),this.small.src=a.getAttribute("data-image")||a.getAttribute("rev")||(e?e.getAttribute("src"):null),this.small.src&&(this.small.src=b.getAbsoluteURL(this.small.src)),this.small.url=this.small.url||this.small.src,this.small.url&&(this.small.url=b.getAbsoluteURL(this.small.url)),this.zoom.src=a.getAttribute("data-zoom-image")||a.getAttribute("href"),this.zoom.src&&(this.zoom.src=b.getAbsoluteURL(this.zoom.src)),this.zoom.url=this.zoom.url||this.zoom.src,this.zoom.url&&(this.zoom.url=b.getAbsoluteURL(this.zoom.url)),this.caption=a.getAttribute("data-caption")||a.getAttribute("title")||c,this.link=a.getAttribute("data-link"),this.origin=a,this},loadImg:function(a){var c=null;return arguments.length>1&&"function"===b.jTypeOf(arguments[1])&&(c=arguments[1]),0!==this[a].state?void(this[a].loaded&&this.onload(c)):(this[a].url&&this[a].node&&!this[a].node.getAttribute("src")&&!this[a].node.getAttribute("srcset")&&this[a].node.setAttribute("src",this[a].url),this[a].state=1,void new b.ImageLoader(this[a].node||this[a].url,{oncomplete:d(function(e){this[a].loaded=!0,this[a].state=e.ready?2:-1,e.ready&&(this[a].size=e.jGetSize(),this[a].node?(this[a].node.jSetCss({"max-width":this[a].size.width,"max-height":this[a].size.height}),this[a].node.currentSrc&&this[a].node.currentSrc!=this[a].node.src?this[a].url=this[a].node.currentSrc:b.getAbsoluteURL(this[a].node.getAttribute("src")||"")!=this[a].url&&this[a].node.setAttribute("src",this[a].url)):(this[a].node=d(e.img),this[a].node.getAttribute("style"),this[a].node.removeAttribute("style"),this[a].size.width/=this[a].dppx,this[a].size.height/=this[a].dppx)),this.onload(c)}).jBind(this)}))},loadSmall:function(){this.loadImg("small",arguments[0])},loadZoom:function(){this.loadImg("zoom",arguments[0])},load:function(){this.callback=null,arguments.length>0&&"function"===b.jTypeOf(arguments[0])&&(this.callback=arguments[0]),this.loadSmall(),this.loadZoom()},onload:function(a){if(a&&a.call(null,this),this.callback&&this.small.loaded&&this.zoom.loaded)return this.callback.call(null,this),void(this.callback=null)},loaded:function(){return this.small.loaded&&this.zoom.loaded},ready:function(){return 2===this.small.state&&2===this.zoom.state},getURL:function(a){var b="small"==a?"zoom":"small";return!this[a].loaded||this[a].loaded&&2===this[a].state?this[a].url:!this[b].loaded||this[b].loaded&&2===this[b].state?this[b].url:null},getNode:function(a){var b="small"==a?"zoom":"small";return!this[a].loaded||this[a].loaded&&2===this[a].state?this[a].node:!this[b].loaded||this[b].loaded&&2===this[b].state?this[b].node:null},jGetSize:function(a){var b="small"==a?"zoom":"small";return!this[a].loaded||this[a].loaded&&2===this[a].state?this[a].size:!this[b].loaded||this[b].loaded&&2===this[b].state?this[b].size:{width:0,height:0}},getRatio:function(a){var b="small"==a?"zoom":"small";return!this[a].loaded||this[a].loaded&&2===this[a].state?this[a].dppx:!this[b].loaded||this[b].loaded&&2===this[b].state?this[b].dppx:1},setCurNode:function(a){this.node=this.getNode(a)}};var G=function(a,c){this.options=new b.Options(e),this.option=d(function(){return arguments.length>1?this.set(arguments[0],arguments[1]):this.get(arguments[0])}).jBind(this.options),this.touchOptions=new b.Options(f),this.additionalImages=[],this.image=null,this.primaryImage=null,this.placeholder=d(a).jAddEvent("dragstart selectstart click",function(a){a.stop()}),this.id=null,this.node=null,this.stubNode=null,this.originalImg=null,this.originalImgSrc=null,this.originalTitle=null,this.normalSize={width:0,height:0},this.size={width:0,height:0},this.zoomSize={width:0,height:0},this.zoomSizeOrigin={width:0,height:0},this.boundaries={top:0,left:0,bottom:0,right:0},this.ready=!1,this.expanded=!1,this.activateTimer=null,this.resizeTimer=null,this.resizeCallback=d(function(){this.expanded&&(this.image.node.jSetCss({"max-height":Math.min(this.image.jGetSize("zoom").height,this.expandMaxHeight())}),this.image.node.jSetCss({"max-width":Math.min(this.image.jGetSize("zoom").width,this.expandMaxWidth())})),this.reflowZoom(arguments[0])}).jBind(this),this.onResize=d(function(a){clearTimeout(this.resizeTimer),this.resizeTimer=d(this.resizeCallback).jDelay(10,"scroll"===a.type)}).jBindAsEvent(this),v&&(n.append(b.$new("div",{},{display:"none",visibility:"hidden"}).append(document.createTextNode(v))),v=void 0),this.lens=null,this.zoomBox=null,this.hint=null,this.hintMessage=null,this.hintRuns=0,this.mobileZoomHint=!0,this.loadingBox=null,this.loadTimer=null,this.thumb=null,this.expandBox=null,this.expandBg=null,this.expandCaption=null,this.expandStage=null,this.expandImageStage=null,this.expandFigure=null,this.expandControls=null,this.expandNav=null,this.expandThumbs=null,this.expandGallery=[],this.buttons={},this.start(c)};return G.prototype={loadOptions:function(a){switch(this.options.fromJSON(window[h+"Options"]||{}),this.options.fromString(this.placeholder.getAttribute("data-options")||""),b.browser.touchScreen||this.option("forceTouch",!1),(b.browser.mobile||this.option("forceTouch"))&&(this.options.fromJSON(this.touchOptions.getJSON()),this.options.fromJSON(window[h+"MobileOptions"]||{}),this.options.fromString(this.placeholder.getAttribute("data-mobile-options")||"")),"string"==b.jTypeOf(a)?this.options.fromString(a||""):this.options.fromJSON(a||{}),this.option("cssClass")&&this.option("cssClass",this.option("cssClass").replace(","," ")),!1===this.option("zoomCaption")&&this.option("zoomCaption","off"),!1===this.option("hint")&&this.option("hint","off"),this.option("hint")){case"off":this.hintRuns=0;break;case"once":this.hintRuns=2;break;case"always":this.hintRuns=1/0}"off"===this.option("zoomMode")&&this.option("zoomMode",!1),"off"===this.option("expand")&&this.option("expand",!1),"off"===this.option("expandZoomMode")&&this.option("expandZoomMode",!1),b.browser.mobile&&"zoom"==this.option("zoomMode")&&"inner"==this.option("zoomPosition")&&(this.option("expand")?this.option("zoomMode",!1):this.option("zoomOn","click"))},start:function(a){var c;if(this.loadOptions(a),!q||this.option("autostart")){if(this.id=this.placeholder.getAttribute("id")||"mz-"+Math.floor(Math.random()*b.now()),this.placeholder.setAttribute("id",this.id),this.node=b.$new("figure").jAddClass("mz-figure"),C(this.placeholder),this.originalImg=this.placeholder.querySelector("img"),this.originalImgSrc=this.originalImg?this.originalImg.getAttribute("src"):null,this.originalTitle=d(this.placeholder).getAttribute("title"),d(this.placeholder).removeAttribute("title"),this.primaryImage=(new F).parseNode(this.placeholder,this.originalTitle,!0),this.image=this.primaryImage,this.node.enclose(this.image.small.node).jAddClass(this.option("cssClass")),!0!==this.option("rightClick")&&this.node.jAddEvent("contextmenu",function(a){return a.stop(),!1}),this.node.jAddClass("mz-"+this.option("zoomOn")+"-zoom"),this.option("expand")||this.node.jAddClass("mz-no-expand"),this.lens={node:b.$new("div",{class:"mz-lens"},{top:0}).jAppendTo(this.node),image:b.$new("img",{src:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},{position:"absolute",top:0,left:0}),width:0,height:0,pos:{x:0,y:0},spos:{x:0,y:0},size:{width:0,height:0},border:{x:0,y:0},dx:0,dy:0,innertouch:!1,hide:function(){b.browser.features.transform?this.node.jSetCss({transform:"translate(-10000px,-10000px)"}):this.node.jSetCss({top:-1e4})}},this.lens.hide(),this.lens.node.append(this.lens.image),this.zoomBox={node:b.$new("div",{class:"mz-zoom-window"},{top:-1e5}).jAddClass(this.option("cssClass")).jAppendTo(n),image:b.$new("img",{src:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},{position:"absolute"}),aspectRatio:0,width:0,height:0,innerWidth:0,innerHeight:0,size:{width:"auto",wunits:"px",height:"auto",hunits:"px"},mode:this.option("zoomMode"),position:this.option("zoomPosition"),trigger:this.option("zoomOn"),custom:!1,active:!1,activating:!1,enabled:!1,enable:d(function(){this.zoomBox.enabled=!1!==arguments[0],this.node[this.zoomBox.enabled?"jRemoveClass":"jAddClass"]("mz-no-zoom")}).jBind(this),hide:d(function(){var a=d(this.node).jFetch("cr");this.zoomBox.node.jRemoveEvent("transitionend"),this.zoomBox.node.jSetCss({top:-1e5}).jAppendTo(n),this.zoomBox.node.jRemoveClass("mz-deactivating mz-p-"+("zoom"==this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode)),!this.expanded&&a&&a.jRemove(),this.zoomBox.image.getAttribute("style"),this.zoomBox.image.removeAttribute("style")}).jBind(this),setMode:d(function(a){this.node[!1===a?"jAddClass":"jRemoveClass"]("mz-no-zoom"),this.node["magnifier"==a?"jAddClass":"jRemoveClass"]("mz-magnifier-zoom"),this.zoomBox.node["magnifier"==a?"jAddClass":"jRemoveClass"]("mz-magnifier"),this.zoomBox.node["preview"==a?"jAddClass":"jRemoveClass"]("mz-preview"),"zoom"!=a&&(this.node.jRemoveClass("mz-inner-zoom"),this.zoomBox.node.jRemoveClass("mz-inner")),this.zoomBox.mode=a,!1===a?this.zoomBox.enable(!1):"preview"===a&&this.zoomBox.enable(!0)}).jBind(this)},this.zoomBox.node.append(this.zoomBox.image),this.zoomBox.setMode(this.option("zoomMode")),this.zoomBox.image.removeAttribute("width"),this.zoomBox.image.removeAttribute("height"),"undefined"!=typeof u){var e=Math.floor(Math.random()*b.now());d(this.node).jStore("cr",b.$new((Math.floor(101*Math.random())+1)%2?"span":"div").setProps({id:"crMz"+e}).jSetCss({display:"inline",overflow:"hidden",visibility:"visible",color:u[1],fontSize:u[2],fontWeight:u[3],fontFamily:"sans-serif",position:"absolute",top:8,left:8,margin:"auto",width:"auto",textAlign:"right","line-height":"2em",zIndex:2147483647}).changeContent(w(u[0]))),d(d(this.node).jFetch("cr")).byTag("a")[0]&&d(d(d(this.node).jFetch("cr")).byTag("a")[0]).jAddEvent("tap btnclick",function(a){a.stopDistribution(),window.open(this.href)}).setProps({id:"mzCrA"+e}),b.addCSS("#"+this.id+" > figure.mz-figure > #crMz"+e+",#"+this.id+" > figure.mz-figure > #crMz"+e+" > #mzCrA"+e+",html body .mz-expand > #crMz"+e+" > #mzCrA"+e+",html body .mz-expand > #crMz"+e+" > #mzCrA"+e,{display:"inline !important;",visibility:"visible !important;",zIndex:"2147483647 !important;",fontSize:u[2]+" !important;",color:u[1]+" !important;"},"mz-runtime-css",!0)}(c=(""+this.option("zoomWidth")).match(/^([0-9]+)?(px|%)?$/))&&(this.zoomBox.size.wunits=c[2]||"px",this.zoomBox.size.width=parseFloat(c[1])||"auto"),(c=(""+this.option("zoomHeight")).match(/^([0-9]+)?(px|%)?$/))&&(this.zoomBox.size.hunits=c[2]||"px",this.zoomBox.size.height=parseFloat(c[1])||"auto"),"magnifier"==this.zoomBox.mode?(this.node.jAddClass("mz-magnifier-zoom"),this.zoomBox.node.jAddClass("mz-magnifier"),"auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="%",this.zoomBox.size.width=70),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="%")):(this.option("zoom-position").match(/^#/)&&((this.zoomBox.custom=d(this.option("zoom-position").replace(/^#/,"")))?d(this.zoomBox.custom).jGetSize().height>50&&("auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="%",this.zoomBox.size.width=100),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="%",this.zoomBox.size.height=100)):this.option("zoom-position","right")),"preview"==this.zoomBox.mode&&("auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="px"),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="px")),"zoom"==this.zoomBox.mode&&("auto"!==this.zoomBox.size.width&&"inner"!=this.option("zoom-position")||(this.zoomBox.size.wunits="%",this.zoomBox.size.width=100),"auto"!==this.zoomBox.size.height&&"inner"!=this.option("zoom-position")||(this.zoomBox.size.hunits="%",this.zoomBox.size.height=100)),"inner"==this.option("zoom-position")&&this.node.jAddClass("mz-inner-zoom")),this.zoomBox.position=this.zoomBox.custom?"custom":this.option("zoom-position"),this.lens.border.x=parseFloat(this.lens.node.jGetCss("border-left-width")||"0"),this.lens.border.y=parseFloat(this.lens.node.jGetCss("border-top-width")||"0"),this.image.loadSmall(function(){2===this.image.small.state&&(this.image.setCurNode("small"),this.size=this.image.node.jGetSize(),this.registerEvents(),this.ready=!0,!0===this.option("lazyZoom")&&this.showHint())}.jBind(this)),!0===this.option("lazyZoom")&&"always"!=this.option("zoomOn")||(this.image.load(d(function(a){this.setupZoom(a,!0)}).jBind(this)),this.loadTimer=d(this.showLoading).jBind(this).jDelay(400)),this.setupSelectors()}},stop:function(){this.unregisterEvents(),this.zoomBox&&this.zoomBox.node.kill(),this.expandThumbs&&(this.expandThumbs.stop(),this.expandThumbs=null),this.expandBox&&this.expandBox.kill(),this.expanded&&d(b.browser.getDoc()).jSetCss({overflow:""}),d(this.additionalImages).jEach(function(a){d(a.origin).jRemoveClass("mz-thumb-selected").jRemoveClass(this.option("cssClass")||"mz-$dummy-css-class-to-jRemove$")},this),this.originalImg&&(this.placeholder.append(this.originalImg),this.originalImgSrc&&this.originalImg.setAttribute("src",this.originalImgSrc)),this.originalTitle&&this.placeholder.setAttribute("title",this.originalTitle),this.node&&this.node.kill()},setupZoom:function(a,c){var e=this.image;return 2!==a.zoom.state?(this.image=a,this.ready=!0,void this.zoomBox.enable(!1)):(this.image=a,this.image.setCurNode(this.expanded?"zoom":"small"),this.zoomBox.image.src=this.image.getURL("zoom"),this.zoomBox.node.jRemoveClass("mz-preview"),this.zoomBox.image.getAttribute("style"),this.zoomBox.image.removeAttribute("style"),this.zoomBox.node.jGetSize(),void setTimeout(d(function(){var d,a=this.zoomBox.image.jGetSize();this.zoomSizeOrigin=this.image.jGetSize("zoom"),a.width*a.height>1&&a.width*a.height<this.zoomSizeOrigin.width*this.zoomSizeOrigin.height&&(this.zoomSizeOrigin=a),this.zoomSize=b.detach(this.zoomSizeOrigin),"preview"==this.zoomBox.mode&&this.zoomBox.node.jAddClass("mz-preview"),this.setCaption(),this.lens.image.src=this.image.node.currentSrc||this.image.node.src,this.zoomBox.enable(this.zoomBox.mode&&!(this.expanded&&"preview"==this.zoomBox.mode)),this.ready=!0,this.activateTimer=null,this.resizeCallback(),this.node.jAddClass("mz-ready"),this.hideLoading(),e!==this.image?(B("onUpdate",this.id,e.origin,this.image.origin),this.nextImage&&(d=this.nextImage,this.nextImage=null,this.update(d.image,d.onswipe))):B("onZoomReady",this.id),this.initEvent?this.node.jCallEvent(this.initEvent.type,this.initEvent):this.expanded&&"always"==this.option("expandZoomOn")?this.activate():c&&this.showHint()}).jBind(this),256))},setupSelectors:function(){var c,e,a=this.id;e=new RegExp("zoom\\-id(\\s+)?:(\\s+)?"+a+"($|;)"),b.browser.features.query?(c=b.$A(document.querySelectorAll('[data-zoom-id="'+this.id+'"]')),c=d(c).concat(b.$A(document.querySelectorAll('[rel*="zoom-id"]')).filter(function(a){return e.test(a.getAttribute("rel")||"")}))):c=b.$A(document.getElementsByTagName("A")).filter(function(b){return a==b.getAttribute("data-zoom-id")||e.test(b.getAttribute("rel")||"")}),d(c).jEach(function(a){var b,c;d(a).jAddEvent("click",function(a){a.stopDefaults()}),b=(new F).parseNode(a,this.originalTitle),this.image.zoom.src.has(b.zoom.src)&&this.image.small.src.has(b.small.src)&&(d(b.origin).jAddClass("mz-thumb-selected"),b=this.image,b.origin=a),!b.link&&this.image.link&&(b.link=this.image.link),c=d(function(){this.update(b)}).jBind(this),d(a).jAddEvent("mousedown",function(a){"stopImmediatePropagation"in a&&a.stopImmediatePropagation()},5),d(a).jAddEvent("tap "+("hover"==this.option("selectorTrigger")?"mouseover mouseout":"btnclick"),d(function(a,b){this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=!1,"mouseover"==a.type?this.updateTimer=d(c).jDelay(b):"tap"!=a.type&&"btnclick"!=a.type||c()}).jBindAsEvent(this,60)).jAddClass(this.option("cssClass")).jAddClass("mz-thumb"),b.loadSmall(),!0!==this.option("lazyZoom")&&b.loadZoom(),this.additionalImages.push(b)},this)},update:function(a,c){return this.ready?!(!a||a===this.image)&&(this.deactivate(null,!0),this.ready=!1,this.node.jRemoveClass("mz-ready"),this.loadTimer=d(this.showLoading).jBind(this).jDelay(400),void a.load(d(function(a){var e,f,g,h,j,k,l=b.browser.ieMode<10?"jGetSize":"getBoundingClientRect";return this.hideLoading(),a.setCurNode("small"),a.node?(this.setActiveThumb(a),e=this.image.node[l](),this.expanded&&(a.setCurNode("zoom"),g=b.$new("div").jAddClass("mz-expand-bg"),b.browser.features.cssFilters||b.browser.ieMode<10?g.append(b.$new("img",{src:a.getURL("zoom")}).jSetCss({opacity:0})):g.append(new b.SVGImage(a.node).blur(i).getNode().jSetCss({opacity:0})),d(g).jSetCss({"z-index":-99}).jAppendTo(this.expandBox)),this.expanded&&"zoom"===this.zoomBox.mode&&"always"===this.option("expandZoomOn")?(d(a.node).jSetCss({opacity:0}).jAppendTo(this.node),f=e,j=[a.node,this.image.node],k=[{opacity:[0,1]},{opacity:[1,0]}],d(a.node).jSetCss({"max-width":Math.min(a.jGetSize("zoom").width,this.expandMaxWidth()),"max-height":Math.min(a.jGetSize("zoom").height,this.expandMaxHeight())})):(this.node.jSetCss({height:this.node[l]().height}),this.image.node.jSetCss({position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",height:"100%","max-width":"","max-height":""}),d(a.node).jSetCss({"max-width":Math.min(a.jGetSize(this.expanded?"zoom":"small").width,this.expanded?this.expandMaxWidth():1/0),"max-height":Math.min(a.jGetSize(this.expanded?"zoom":"small").height,this.expanded?this.expandMaxHeight():1/0),position:"relative",top:0,left:0,opacity:0,transform:""}).jAppendTo(this.node),f=d(a.node)[l](),c||d(a.node).jSetCss({"min-width":e.width,height:e.height,"max-width":e.width,"max-height":""}),this.node.jSetCss({height:"",overflow:""}).jGetSize(),d(a.node).jGetSize(),j=[a.node,this.image.node],k=[b.extend({opacity:[0,1]},c?{scale:[.6,1]}:{"min-width":[e.width,f.width],"max-width":[e.width,f.width],height:[e.height,f.height]}),{opacity:[1,0]}]),this.expanded&&this.expandBg.firstChild&&g.firstChild&&(h=d(this.expandBg.firstChild).jGetCss("opacity"),b.browser.gecko?(j=j.concat([g.firstChild]),k=k.concat([{opacity:[1e-4,h]}])):(j=j.concat([g.firstChild,this.expandBg.firstChild]),k=k.concat([{opacity:[1e-4,h]},{opacity:[h,1e-4]}]))),void new b.PFX(j,{duration:c||this.option("transitionEffect")?c?400:350:0,transition:c?"cubic-bezier(0.175, 0.885, 0.320, 1.275)":e.width==f.width?"linear":"cubic-bezier(0.25, .1, .1, 1)",onComplete:d(function(){this.image.node.jRemove().getAttribute("style"),this.image.node.removeAttribute("style"),d(a.node).jSetCss(this.expanded?{width:"auto",height:"auto"}:{width:"",height:""}).jSetCss({"min-width":"","min-height":"",opacity:"","max-width":Math.min(a.jGetSize(this.expanded?"zoom":"small").width,this.expanded?this.expandMaxWidth():1/0),"max-height":Math.min(a.jGetSize(this.expanded?"zoom":"small").height,this.expanded?this.expandMaxHeight():1/0)}),this.expanded&&(this.expandBg.jRemove(),this.expandBg=void 0,this.expandBg=g.jSetCssProp("z-index",-100),d(this.expandBg.firstChild).jSetCss({opacity:""}),this.expandCaption&&(a.caption?a.link?this.expandCaption.changeContent("").append(b.$new("a",{href:a.link}).jAddEvent("tap btnclick",this.openLink.jBind(this)).changeContent(a.caption)):this.expandCaption.changeContent(a.caption).jAddClass("mz-show"):this.expandCaption.jRemoveClass("mz-show"))),this.setupZoom(a)}).jBind(this),onBeforeRender:d(function(a,b){void 0!==a.scale&&b.jSetCssProp("transform","scale("+a.scale+")")})}).start(k)):(this.ready=!0,void this.node.jAddClass("mz-ready"))}).jBind(this))):void(this.nextImage={image:a,onswipe:c})},setActiveThumb:function(a){var b=!1;d(this.additionalImages).jEach(function(c){d(c.origin).jRemoveClass("mz-thumb-selected"),c===a&&(b=!0)}),b&&a.origin&&d(a.origin).jAddClass("mz-thumb-selected"),this.expandThumbs&&this.expandThumbs.selectItem(a.selector)},setCaption:function(a){this.image.caption&&"off"!==this.option("zoomCaption")&&"magnifier"!==this.zoomBox.mode&&(this.zoomBox.caption||(this.zoomBox.caption=b.$new("div",{class:"mz-caption"}).jAppendTo(this.zoomBox.node.jAddClass("caption-"+this.option("zoomCaption")))),this.zoomBox.caption.changeContent(this.image.caption))},showHint:function(a,c,e){var f;if(!this.expanded){if(this.hintRuns<=0)return;!0!==e&&this.hintRuns--}return void 0!==c&&null!==c||(this.zoomBox.active||this.zoomBox.activating?c=this.option("expand")?this.option("textExpandHint"):"":!this.option("zoomMode")||!this.zoomBox.enabled&&this.image.loaded()?c=this.option("expand")?this.option("textExpandHint"):"":"hover"==this.zoomBox.trigger?c=this.option("textHoverZoomHint"):"click"==this.zoomBox.trigger&&(c=this.option("textClickZoomHint"))),c?(f=this.node,this.hint?d(this.hintMessage).changeContent(c):(this.hint=b.$new("div",{class:"mz-hint"}),this.hintMessage=b.$new("span",{class:"mz-hint-message"}).append(document.createTextNode(c)).jAppendTo(this.hint),d(this.hint).jAppendTo(this.node)),this.hint.jSetCss({"transition-delay":""}).jRemoveClass("mz-hint-hidden"),this.expanded?f=this.expandFigure:(this.zoomBox.active||this.zoomBox.activating)&&"magnifier"!==this.zoomBox.mode&&"inner"==this.zoomBox.position&&(f=this.zoomBox.node),!0===a&&setTimeout(d(function(){this.hint.jAddClass("mz-hint-hidden")}).jBind(this),16),void this.hint.jAppendTo(f)):void this.hideHint()},hideHint:function(){this.hint&&this.hint.jSetCss({"transition-delay":"0ms"}).jAddClass("mz-hint-hidden")},showLoading:function(){this.loadingBox||(this.loadingBox=b.$new("div",{class:"mz-loading"}),this.node.append(this.loadingBox),this.loadingBox.jGetSize()),this.loadingBox.jAddClass("shown")},hideLoading:function(){clearTimeout(this.loadTimer),this.loadTimer=null,this.loadingBox&&d(this.loadingBox).jRemoveClass("shown")},setSize:function(a,c){var g,h,e=b.detach(this.zoomBox.size),f=!this.expanded&&this.zoomBox.custom?d(this.zoomBox.custom).jGetSize():{width:0,height:0},i=this.size,j={x:0,y:0};c=c||this.zoomBox.position,this.normalSize=this.image.node.jGetSize(),this.size=this.image.node.jGetSize(),this.boundaries=this.image.node.getBoundingClientRect(),f.height||(f=this.size),!1!==this.option("upscale")&&!1!==this.zoomBox.mode&&"preview"!==this.zoomBox.mode||(a=!1),"preview"==this.zoomBox.mode&&("auto"===e.width&&(e.width=this.zoomSizeOrigin.width),"auto"===e.height&&(e.height=this.zoomSizeOrigin.height)),this.expanded&&"magnifier"==this.zoomBox.mode&&(e.width=70,e.height="auto"),"magnifier"==this.zoomBox.mode&&"auto"===e.height?(this.zoomBox.width=parseFloat(e.width/100)*Math.min(f.width,f.height),this.zoomBox.height=this.zoomBox.width):"zoom"==this.zoomBox.mode&&"inner"==c?(this.size=this.node.jGetSize(),f=this.size,this.boundaries=this.node.getBoundingClientRect(),this.zoomBox.width=f.width,this.zoomBox.height=f.height):(this.zoomBox.width="%"===e.wunits?parseFloat(e.width/100)*f.width:parseInt(e.width),this.zoomBox.height="%"===e.hunits?parseFloat(e.height/100)*f.height:parseInt(e.height)),"preview"==this.zoomBox.mode&&(h=Math.min(Math.min(this.zoomBox.width/this.zoomSizeOrigin.width,this.zoomBox.height/this.zoomSizeOrigin.height),1),this.zoomBox.width=this.zoomSizeOrigin.width*h,this.zoomBox.height=this.zoomSizeOrigin.height*h),this.zoomBox.width=Math.ceil(this.zoomBox.width),this.zoomBox.height=Math.ceil(this.zoomBox.height),this.zoomBox.aspectRatio=this.zoomBox.width/this.zoomBox.height,this.zoomBox.node.jSetCss({width:this.zoomBox.width,height:this.zoomBox.height}),a&&(f=this.expanded?this.expandBox.jGetSize():this.zoomBox.node.jGetSize(),!this.expanded&&this.normalSize.width*this.normalSize.height/(this.zoomSizeOrigin.width*this.zoomSizeOrigin.height)>.8?(this.zoomSize.width=1.5*this.zoomSizeOrigin.width,this.zoomSize.height=1.5*this.zoomSizeOrigin.height):this.zoomSize=b.detach(this.zoomSizeOrigin)),!1===this.zoomBox.mode||this.zoomBox.active||this.expanded&&"always"==this.option("expandZoomOn")||(this.normalSize.width*this.normalSize.height/(this.zoomSize.width*this.zoomSize.height)>.8?(this.zoomSize=b.detach(this.zoomSizeOrigin),this.zoomBox.enable(!1)):this.zoomBox.enable(!0)),this.zoomBox.image.jSetCss({width:this.zoomSize.width,height:this.zoomSize.height}),g=this.zoomBox.node.getInnerSize(),this.zoomBox.innerWidth=Math.ceil(g.width),this.zoomBox.innerHeight=Math.ceil(g.height),this.lens.width=Math.ceil(this.zoomBox.innerWidth/(this.zoomSize.width/this.size.width)),this.lens.height=Math.ceil(this.zoomBox.innerHeight/(this.zoomSize.height/this.size.height)),this.lens.node.jSetCss({width:this.lens.width,height:this.lens.height}),this.lens.image.jSetCss(this.size),b.extend(this.lens,this.lens.node.jGetSize()),this.zoomBox.active&&(clearTimeout(this.moveTimer),this.moveTimer=null,this.lens.innertouch?(this.lens.pos.x*=this.size.width/i.width,this.lens.pos.y*=this.size.height/i.height,j.x=this.lens.spos.x,j.y=this.lens.spos.y):(j.x=this.boundaries.left+this.lens.width/2+this.lens.pos.x*(this.size.width/i.width),j.y=this.boundaries.top+this.lens.height/2+this.lens.pos.y*(this.size.height/i.height)),this.animate(null,j))},reflowZoom:function(a){var c,e,f,g,h,i,j=d(this.node).jFetch("cr");
if(f=y(5),h=this.zoomBox.position,g=this.expanded?"inner":this.zoomBox.custom?"custom":this.option("zoom-position"),i=this.expanded&&"zoom"==this.zoomBox.mode?this.expandBox:document.body,this.expanded&&(f.y=0,f.x=0),a||this.setSize(!0,g),c=this.boundaries.top,"magnifier"!==this.zoomBox.mode){if(a)return void this.setSize(!1);switch(g){case"inner":case"custom":c=0,e=0;break;case"top":c=this.boundaries.top-this.zoomBox.height-this.option("zoom-distance"),f.top>c&&(c=this.boundaries.bottom+this.option("zoom-distance"),g="bottom"),e=this.boundaries.left;break;case"bottom":c=this.boundaries.bottom+this.option("zoom-distance"),f.bottom<c+this.zoomBox.height&&(c=this.boundaries.top-this.zoomBox.height-this.option("zoom-distance"),g="top"),e=this.boundaries.left;break;case"left":e=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance"),f.left>e&&f.right>=this.boundaries.right+this.option("zoom-distance")+this.zoomBox.width&&(e=this.boundaries.right+this.option("zoom-distance"),g="right");break;case"right":default:e=this.boundaries.right+this.option("zoom-distance"),f.right<e+this.zoomBox.width&&f.left<=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance")&&(e=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance"),g="left")}switch(this.option("zoom-position")){case"top":case"bottom":(f.top>c||f.bottom<c+this.zoomBox.height)&&(g="inner");break;case"left":case"right":(f.left>e||f.right<e+this.zoomBox.width)&&(g="inner")}if(this.zoomBox.position=g,!this.zoomBox.activating&&!this.zoomBox.active)return void(b.browser.mobile&&!this.expanded&&"zoom"==this.zoomBox.mode&&(this.option("expand")?this.zoomBox.enable("inner"!==g):"click"!==this.option("zoomOn")&&(this.zoomBox.trigger="inner"===g?"click":this.option("zoomOn"),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),this.registerActivateEvent("click"===this.zoomBox.trigger),this.registerDeactivateEvent("click"===this.zoomBox.trigger&&!this.option("expand"))),this.showHint(!1,null,!0)));if(this.setSize(!1),a)return;"custom"==g&&(i=this.zoomBox.custom,f.y=0,f.x=0),"inner"==g?("preview"!==this.zoomBox.mode&&(this.zoomBox.node.jAddClass("mz-inner"),this.node.jAddClass("mz-inner-zoom")),this.lens.hide(),c=this.boundaries.top+f.y,e=this.boundaries.left+f.x,!this.expanded&&b.browser.ieMode&&b.browser.ieMode<11&&(c=0,e=0,i=this.node)):(c+=f.y,e+=f.x,this.node.jRemoveClass("mz-inner-zoom"),this.zoomBox.node.jRemoveClass("mz-inner")),this.zoomBox.node.jSetCss({top:c,left:e})}else this.setSize(!1),i=this.node;this.zoomBox.node[this.expanded?"jAddClass":"jRemoveClass"]("mz-expanded"),!this.expanded&&j&&j.jAppendTo("zoom"==this.zoomBox.mode&&"inner"==g?this.zoomBox.node:this.node,(Math.floor(101*Math.random())+1)%2?"top":"bottom"),this.zoomBox.node.jAppendTo(i)},changeZoomLevel:function(a){var c,e,f,g,h=!1,i=a.isMouse?5:3/54;if(d(a).stop(),i=(100+i*Math.abs(a.deltaY))/100,a.deltaY<0&&(i=1/i),"magnifier"==this.zoomBox.mode)e=Math.max(100,Math.round(this.zoomBox.width*i)),e=Math.min(e,.9*this.size.width),f=e/this.zoomBox.aspectRatio,this.zoomBox.width=Math.ceil(e),this.zoomBox.height=Math.ceil(f),this.zoomBox.node.jSetCss({width:this.zoomBox.width,height:this.zoomBox.height}),c=this.zoomBox.node.getInnerSize(),this.zoomBox.innerWidth=Math.ceil(c.width),this.zoomBox.innerHeight=Math.ceil(c.height),h=!0;else{if(this.expanded||"zoom"!=this.zoomBox.mode)return;e=Math.max(50,Math.round(this.lens.width*i)),e=Math.min(e,.9*this.size.width),f=e/this.zoomBox.aspectRatio,this.zoomSize.width=Math.ceil(this.zoomBox.innerWidth/e*this.size.width),this.zoomSize.height=Math.ceil(this.zoomBox.innerHeight/f*this.size.height),this.zoomBox.image.jSetCss({width:this.zoomSize.width,height:this.zoomSize.height})}g=d(window).jGetScroll(),this.lens.width=Math.ceil(this.zoomBox.innerWidth/(this.zoomSize.width/this.size.width)),this.lens.height=Math.ceil(this.zoomBox.innerHeight/(this.zoomSize.height/this.size.height)),this.lens.node.jSetCss({width:this.lens.width,height:this.lens.height}),b.extend(this.lens,this.lens.node.jGetSize()),this.zoomBox.active&&(clearTimeout(this.moveTimer),this.moveTimer=null,h&&(this.moveTimer=!0),this.animate(null,{x:a.x-g.x,y:a.y-g.y}),h&&(this.moveTimer=null))},registerActivateEvent:function(a){var c,e=a?"dbltap btnclick":"touchstart"+(window.navigator.pointerEnabled?" pointerdown":window.navigator.msPointerEnabled?" MSPointerDown":"")+(window.navigator.pointerEnabled?" pointermove":window.navigator.msPointerEnabled?" MSPointerMove":" mousemove"),f=this.node.jFetch("mz:handlers:activate:fn",a?d(this.activate).jBindAsEvent(this):d(function(a){z(a)&&!A(a)||a&&"touch"===a.pointerType&&"pointerdown"!==a.type||(c=b.browser.ieMode<9?b.extend({},a):a,this.activateTimer||(clearTimeout(this.activateTimer),this.activateTimer=setTimeout(d(function(){this.activate(c)}).jBind(this),120)))}).jBindAsEvent(this));this.node.jStore("mz:handlers:activate:event",e).jAddEvent(e,f,10)},unregisterActivateEvent:function(a){var b=this.node.jFetch("mz:handlers:activate:event"),c=this.node.jFetch("mz:handlers:activate:fn");this.node.jRemoveEvent(b,c),this.node.jDel("mz:handlers:activate:fn")},registerDeactivateEvent:function(a){var b=a?"dbltap btnclick":"touchend"+(window.navigator.pointerEnabled?" pointerup pointerout":window.navigator.msPointerEnabled?" MSPointerUp MSPointerOut":" mouseout"),c=this.node.jFetch("mz:handlers:deactivate:fn",d(function(a){z(a)&&!A(a)||this.zoomBox.node===a.getRelated()||("inner"==this.zoomBox.position||"magnifier"==this.zoomBox.mode)&&this.zoomBox.node.hasChild(a.getRelated())||this.node.hasChild(a.getRelated())||this.deactivate(a)}).jBindAsEvent(this));this.node.jStore("mz:handlers:deactivate:event",b).jAddEvent(b,c,20)},unregisterDeactivateEvent:function(){var a=this.node.jFetch("mz:handlers:deactivate:event"),b=this.node.jFetch("mz:handlers:deactivate:fn");this.node.jRemoveEvent(a,b),this.node.jDel("mz:handlers:deactivate:fn")},registerEvents:function(){this.moveBind=this.move.jBind(this),this.node.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],d(function(a){(b.browser.androidBrowser||"android"===b.browser.platform&&b.browser.gecko)&&this.option("zoomMode")&&"click"!==this.option("zoomOn")&&"touchstart"===a.type&&(a.stopDefaults(),b.browser.gecko&&a.stopDistribution()),this.zoomBox.active&&"inner"===this.zoomBox.position&&(this.lens.spos=a.getClientXY())}).jBindAsEvent(this),10),this.node.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],d(function(a){z(a)&&A(a)&&(this.lens.touchmovement=!1)}).jBindAsEvent(this),10),this.node.jAddEvent("touchmove "+("android"===b.browser.platform?"":window.navigator.pointerEnabled?"pointermove":window.navigator.msPointerEnabled?"MSPointerMove":"mousemove"),d(this.animate).jBindAsEvent(this)),this.option("zoomMode")&&(this.registerActivateEvent("click"===this.option("zoomOn")),this.registerDeactivateEvent("click"===this.option("zoomOn")&&!this.option("expand"))),this.node.jAddEvent("mousedown",function(a){a.stopDistribution()},10).jAddEvent("btnclick",d(function(a){this.node.jRaiseEvent("MouseEvent","click"),this.expanded&&this.expandBox.jCallEvent("btnclick",a)}).jBind(this),15),this.option("expand")?this.node.jAddEvent("tap btnclick",d(this.expand).jBindAsEvent(this),15):this.node.jAddEvent("tap btnclick",d(this.openLink).jBindAsEvent(this),15),this.additionalImages.length>1&&this.swipe(),!b.browser.mobile&&this.option("variableZoom")&&this.node.jAddEvent("mousescroll",this.changeZoomLevel.jBindAsEvent(this)),d(window).jAddEvent(b.browser.mobile?"resize":"resize scroll",this.onResize)},unregisterEvents:function(){this.node&&this.node.jRemoveEvent("mousescroll"),d(window).jRemoveEvent("resize scroll",this.onResize),d(this.additionalImages).jEach(function(a){d(a.origin).jClearEvents()})},activate:function(a){var c,e,f,g,h,i=0,j=0;if(!this.ready||!this.zoomBox.enabled||this.zoomBox.active||this.zoomBox.activating)return void(this.image.loaded()||(a&&(this.initEvent=b.extend({},a),this.initEvent.type=a.type,a.stopQueue()),this.image.load(this.setupZoom.jBind(this)),this.loadTimer||(this.loadTimer=d(this.showLoading).jBind(this).jDelay(400))));if(!a||"pointermove"!=a.type||"touch"!=a.pointerType){if(!this.option("zoomMode")&&this.option("expand")&&!this.expanded)return void(this.zoomBox.active=!0);this.zoomBox.activating=!0,this.expanded&&"zoom"==this.zoomBox.mode&&(g=this.image.node.jGetRect(),this.expandStage.jAddClass("mz-zoom-in"),h=this.expandFigure.jGetRect(),j=(g.left+g.right)/2-(h.left+h.right)/2,i=(g.top+g.bottom)/2-(h.top+h.bottom)/2),this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-deactivating").jRemoveEvent("transitionend"),this.zoomBox.node.jAddClass("mz-activating"),this.node.jAddClass("mz-activating"),this.reflowZoom(),e="zoom"==this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode,!b.browser.features.transition||this.expanded&&"always"==this.option("expandZoomOn")?(this.zoomBox.node.jRemoveClass("mz-activating"),this.zoomBox.activating=!1,this.zoomBox.active=!0):"inner"==e?(f=this.image.node.jGetSize(),this.zoomBox.image.jSetCss({transform:"translate3d(0,"+i+"px, 0) scale("+f.width/this.zoomSize.width+", "+f.height/this.zoomSize.height+")"}).jGetSize(),this.zoomBox.image.jAddEvent("transitionend",d(function(){this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating mz-p-"+e),this.zoomBox.activating=!1,this.zoomBox.active=!0}).jBind(this)),this.zoomBox.node.jAddClass("mz-p-"+e).jGetSize(),b.browser.mobile||!b.browser.chrome||"chrome"!==b.browser.uaName&&"opera"!==b.browser.uaName||(this.zoomBox.activating=!1,this.zoomBox.active=!0)):(this.zoomBox.node.jAddEvent("transitionend",d(function(){this.zoomBox.node.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating mz-p-"+e)}).jBind(this)),this.zoomBox.node.jAddClass("mz-p-"+e).jGetSize(),this.zoomBox.node.jRemoveClass("mz-p-"+e),this.zoomBox.activating=!1,this.zoomBox.active=!0),this.expanded||this.showHint(!0),a?(a.stop().stopQueue(),c=a.getClientXY(),"magnifier"==this.zoomBox.mode&&/tap/i.test(a.type)&&(c.y-=this.zoomBox.height/2+10),"inner"==e&&(/tap/i.test(a.type)||z(a))&&(this.lens.pos={x:0,y:0},c.x=-(c.x-this.boundaries.left-this.size.width/2)*(this.zoomSize.width/this.size.width),c.y=-(c.y-this.boundaries.top-this.size.height/2)*(this.zoomSize.height/this.size.height))):(c={x:this.boundaries.left+(this.boundaries.right-this.boundaries.left)/2,y:this.boundaries.top+(this.boundaries.bottom-this.boundaries.top)/2},b.browser.mobile&&this.expanded&&"always"===this.option("expandZoomOn")&&(this.lens.innertouch=!0,this.lens.pos={x:0,y:0},c.x=-(c.x-this.boundaries.left-this.size.width/2)*(this.zoomSize.width/this.size.width),c.y=-(c.y-this.boundaries.top-this.size.height/2)*(this.zoomSize.height/this.size.height))),this.node.jRemoveClass("mz-activating").jAddClass("mz-active"),c.x+=-j,c.y+=-i,this.lens.spos={x:0,y:0},this.lens.dx=0,this.lens.dy=0,this.animate(a,c,!0),B("onZoomIn",this.id)}},deactivate:function(a,c){var e,f,g,h,i=0,j=0,k=this.zoomBox.active;this.initEvent=null,this.ready&&(a&&"pointerout"==a.type&&"touch"==a.pointerType||(clearTimeout(this.moveTimer),this.moveTimer=null,clearTimeout(this.activateTimer),this.activateTimer=null,this.zoomBox.activating=!1,this.zoomBox.active=!1,!0===c||this.expanded||k&&(b.browser.mobile&&!this.expanded&&"zoom"==this.zoomBox.mode?this.reflowZoom():this.showHint()),this.zoomBox.enabled&&(a&&a.stop(),this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating").jRemoveEvent("transitionend"),this.expanded&&(h=this.expandFigure.jGetRect(),"always"!==this.option("expandZoomOn")&&this.expandStage.jRemoveClass("mz-zoom-in"),this.image.node.jSetCss({"max-height":this.expandMaxHeight()}),g=this.image.node.jGetRect(),j=(g.left+g.right)/2-(h.left+h.right)/2,i=(g.top+g.bottom)/2-(h.top+h.bottom)/2),e="zoom"==this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode,!b.browser.features.transition||!a||this.expanded&&"always"==this.option("expandZoomOn")?(this.zoomBox.hide(),this.node.jRemoveClass("mz-active")):"inner"==e?(this.zoomBox.image.jAddEvent("transitionend",d(function(){this.zoomBox.image.jRemoveEvent("transitionend"),this.node.jRemoveClass("mz-active"),setTimeout(d(function(){this.zoomBox.hide()}).jBind(this),32)}).jBind(this)),f=this.image.node.jGetSize(),this.zoomBox.node.jAddClass("mz-deactivating mz-p-"+e).jGetSize(),this.zoomBox.image.jSetCss({transform:"translate3d(0,"+i+"px,0) scale("+f.width/this.zoomSize.width+", "+f.height/this.zoomSize.height+")"})):(this.zoomBox.node.jAddEvent("transitionend",d(function(){this.zoomBox.hide(),this.node.jRemoveClass("mz-active")}).jBind(this)),this.zoomBox.node.jGetCss("opacity"),this.zoomBox.node.jAddClass("mz-deactivating mz-p-"+e),this.node.jRemoveClass("mz-active")),this.lens.dx=0,this.lens.dy=0,this.lens.spos={x:0,y:0},this.lens.hide(),k&&B("onZoomOut",this.id))))},animate:function(a,c,e){var g,h,j,l,f=c,i=0,k=0,n=!1;if(this.zoomBox.active||e){if(a){if(d(a).stopDefaults().stopDistribution(),z(a)&&!A(a))return;n=/tap/i.test(a.type)||z(a),n&&!this.lens.touchmovement&&(this.lens.touchmovement=n),f||(f=a.getClientXY())}"preview"!=this.zoomBox.mode&&("zoom"==this.zoomBox.mode&&"inner"===this.zoomBox.position&&(a&&n||!a&&this.lens.innertouch)?(this.lens.innertouch=!0,g=this.lens.pos.x+(f.x-this.lens.spos.x),h=this.lens.pos.y+(f.y-this.lens.spos.y),this.lens.spos=f,i=Math.min(0,this.zoomBox.innerWidth-this.zoomSize.width)/2,j=-i,k=Math.min(0,this.zoomBox.innerHeight-this.zoomSize.height)/2,l=-k):(this.lens.innertouch=!1,"magnifier"==this.zoomBox.mode&&(f.y=Math.max(this.boundaries.top,Math.min(f.y,this.boundaries.bottom)),f.x=Math.max(this.boundaries.left,Math.min(f.x,this.boundaries.right))),g=f.x-this.boundaries.left,h=f.y-this.boundaries.top,j=this.size.width-this.lens.width,l=this.size.height-this.lens.height,g-=this.lens.width/2,h-=this.lens.height/2),"magnifier"!==this.zoomBox.mode&&(g=Math.max(i,Math.min(g,j)),h=Math.max(k,Math.min(h,l))),this.lens.pos.x=g=Math.round(g),this.lens.pos.y=h=Math.round(h),"zoom"==this.zoomBox.mode&&"inner"!=this.zoomBox.position&&(b.browser.features.transform?(this.lens.node.jSetCss({transform:"translate("+this.lens.pos.x+"px,"+this.lens.pos.y+"px)"}),this.lens.image.jSetCss({transform:"translate("+-(this.lens.pos.x+this.lens.border.x)+"px, "+-(this.lens.pos.y+this.lens.border.y)+"px)"})):(this.lens.node.jSetCss({top:this.lens.pos.y,left:this.lens.pos.x}),this.lens.image.jSetCss({top:-(this.lens.pos.y+this.lens.border.y),left:-(this.lens.pos.x+this.lens.border.x)}))),"magnifier"==this.zoomBox.mode&&(!this.lens.touchmovement||a&&"dbltap"==a.type||(f.y-=this.zoomBox.height/2+10),this.zoomBox.node.jSetCss({top:f.y-this.boundaries.top-this.zoomBox.height/2,left:f.x-this.boundaries.left-this.zoomBox.width/2})),this.moveTimer||(this.lens.dx=0,this.lens.dy=0,this.move(1)))}},move:function(a){var c,d;isFinite(a)||(a=this.lens.innertouch?this.lens.touchmovement?.4:.16:this.option("smoothing")?.2:this.lens.touchmovement?.4:.8),c=(this.lens.pos.x-this.lens.dx)*a,d=(this.lens.pos.y-this.lens.dy)*a,this.lens.dx+=c,this.lens.dy+=d,(!this.moveTimer||Math.abs(c)>1e-6||Math.abs(d)>1e-6)&&this.zoomBox.image.jSetCss(b.browser.features.transform?{transform:r+(this.lens.innertouch?this.lens.dx:-(this.lens.dx*(this.zoomSize.width/this.size.width)-Math.max(0,this.zoomSize.width-this.zoomBox.innerWidth)/2))+"px,"+(this.lens.innertouch?this.lens.dy:-(this.lens.dy*(this.zoomSize.height/this.size.height)-Math.max(0,this.zoomSize.height-this.zoomBox.innerHeight)/2))+"px"+s+" scale(1)"}:{left:-(this.lens.dx*(this.zoomSize.width/this.size.width)+Math.min(0,this.zoomSize.width-this.zoomBox.innerWidth)/2),top:-(this.lens.dy*(this.zoomSize.height/this.size.height)+Math.min(0,this.zoomSize.height-this.zoomBox.innerHeight)/2)}),"magnifier"!=this.zoomBox.mode&&(this.moveTimer=setTimeout(this.moveBind,16))},swipe:function(){var a,c,g,j,k,n,o,e=30,f=201,h="",i={},l=0,m={transition:b.browser.cssTransform+String.fromCharCode(32)+"300ms cubic-bezier(.18,.35,.58,1)"},p=d(function(b){if(this.ready&&!this.zoomBox.active)if("dragstart"==b.state)clearTimeout(this.activateTimer),this.activateTimer=null,l=0,i={x:b.x,y:b.y,ts:b.timeStamp},a=this.size.width,c=a/2,this.image.node.jRemoveEvent("transitionend"),this.image.node.jSetCssProp("transition",""),this.image.node.jSetCssProp("transform","translate3d(0, 0, 0)"),o=null;else{if(j=b.x-i.x,k={x:0,y:0,z:0},null===o&&(o=Math.abs(b.x-i.x)<Math.abs(b.y-i.y)),o)return;if(b.stop(),"dragend"==b.state)return l=0,n=null,g=b.timeStamp-i.ts,(Math.abs(j)>c||g<f&&Math.abs(j)>e)&&(h=j>0?"backward":j<=0?"forward":"")&&("backward"==h?(n=this.getPrev(),l+=10*a):(n=this.getNext(),l-=10*a)),k.x=l,k.deg=-90*(k.x/a),this.image.node.jAddEvent("transitionend",d(function(a){this.image.node.jRemoveEvent("transitionend"),this.image.node.jSetCssProp("transition",""),n&&(this.image.node.jSetCss({transform:"translate3d("+k.x+"px, 0px, 0px)"}),this.update(n,!0))}).jBind(this)),this.image.node.jSetCss(m),this.image.node.jSetCss({"transition-duration":k.x?"100ms":"300ms",opacity:1-.7*Math.abs(k.x/a),transform:"translate3d("+k.x+"px, 0px, 0px)"}),void(j=0);k.x=j,k.z=-50*Math.abs(k.x/c),k.deg=-60*(k.x/c),this.image.node.jSetCss({opacity:1-.7*Math.abs(k.x/c),transform:"translate3d("+k.x+"px, 0px, "+k.z+"px)"})}}).jBind(this);this.node.jAddEvent("touchdrag",p)},setupExpandGallery:function(){var a,e;this.additionalImages.length?this.expandGallery=this.additionalImages:(a=this.placeholder.getAttribute("data-gallery"),a&&(e=b.browser.features.query?b.$A(document.querySelectorAll('.MagicZoom[data-gallery="'+a+'"]')):b.$A(document.getElementsByTagName("A")).filter(function(b){return a==b.getAttribute("data-gallery")}),d(e).jEach(function(a){var b,c;b=x(a),b&&b.additionalImages.length>0||(c=b?new F(b.image.small.url,b.image.zoom.url,b.image.caption,null,b.image.origin):(new F).parseNode(a,b?b.originalTitle:null),this.image.zoom.src.has(c.zoom.url)&&this.image.small.src.has(c.small.url)&&(c=this.image),this.expandGallery.push(c))},this),this.primaryImage=this.image)),this.expandGallery.length>1?(this.expandStage.jAddClass("with-thumbs"),this.expandNav=b.$new("div",{class:"mz-expand-thumbnails"}).jAppendTo(this.expandStage),this.expandThumbs=new c(this.expandNav),d(this.expandGallery).jEach(function(a){var c=d(function(b){this.setActiveThumb(a),this.update(a)}).jBind(this);a.selector=this.expandThumbs.addItem(b.$new("img",{src:a.getURL("small")}).jAddEvent("tap btnclick",function(a){a.stop()}).jAddEvent("tap "+("hover"==this.option("selectorTrigger")?"mouseover mouseout":"btnclick"),d(function(a,b){this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=!1,"mouseover"==a.type?this.updateTimer=d(c).jDelay(b):"tap"!=a.type&&"btnclick"!=a.type||c()}).jBindAsEvent(this,60)))},this),this.buttons.next.show(),this.buttons.prev.show()):(this.expandStage.jRemoveClass("with-thumbs"),this.buttons.next.hide(),this.buttons.prev.hide())},destroyExpandGallery:function(){var a;if(this.expandThumbs&&(this.expandThumbs.stop(),this.expandThumbs=null),this.expandNav&&(this.expandNav.jRemove(),this.expandNav=null),this.expandGallery.length>1&&!this.additionalImages.length)for(this.node.jRemoveEvent("touchdrag"),this.image.node.jRemove().getAttribute("style"),this.image.node.removeAttribute("style"),this.primaryImage.node.jAppendTo(this.node),this.setupZoom(this.primaryImage);a=this.expandGallery.pop();)a!==this.primaryImage&&(a.small.node&&(a.small.node.kill(),a.small.node=null),a.zoom.node&&(a.zoom.node.kill(),a.zoom.node=null),a=null);this.expandGallery=[]},close:function(){this.ready&&this.expanded&&("ios"==b.browser.platform&&"safari"==b.browser.uaName&&7==parseInt(b.browser.uaVersion)&&(clearInterval(t),t=null),d(document).jRemoveEvent("keydown",this.keyboardCallback),this.deactivate(null,!0),this.ready=!1,a.browser.fullScreen.capable&&a.browser.fullScreen.enabled()?a.browser.fullScreen.cancel():b.browser.features.transition?(this.node.jRemoveEvent("transitionend").jSetCss({transition:""}),this.node.jAddEvent("transitionend",this.onClose),!b.browser.chrome||"chrome"!==b.browser.uaName&&"opera"!==b.browser.uaName||setTimeout(d(function(){this.onClose()}).jBind(this),600),this.expandBg.jRemoveEvent("transitionend").jSetCss({transition:""}),this.expandBg.jSetCss({transition:"all 0.6s cubic-bezier(0.895, 0.030, 0.685, 0.220) 0.0s"}).jGetSize(),b.browser.androidBrowser&&"chrome"!==b.browser.uaName?this.node.jSetCss({transition:"all .4s cubic-bezier(0.600, 0, 0.735, 0.045) 0s"}).jGetSize():this.node.jSetCss({transition:"all .4s cubic-bezier(0.600, -0.280, 0.735, 0.045) 0s"}).jGetSize(),!1!==this.zoomBox.mode&&"always"==this.option("expandZoomOn")&&"magnifier"!==this.option("expandZoomMode")&&(this.image.node.jSetCss({"max-height":this.image.jGetSize("zoom").height}),this.image.node.jSetCss({"max-width":this.image.jGetSize("zoom").width})),this.expandBg.jSetCss({opacity:.4}),this.node.jSetCss({opacity:.01,transform:"scale(0.4)"})):this.onClose())},expand:function(c){if(!this.image.loaded()||!this.ready||this.expanded)return void(this.image.loaded()||(c&&(this.initEvent=b.extend({},c),this.initEvent.type=c.type,c.stopQueue()),this.image.load(this.setupZoom.jBind(this)),this.loadTimer||(this.loadTimer=d(this.showLoading).jBind(this).jDelay(400))));c&&c.stopQueue();var e=d(this.node).jFetch("cr"),f=document.createDocumentFragment();this.hideHint(),this.hintRuns--,this.deactivate(null,!0),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),this.ready=!1,this.expandBox||(this.expandBox=b.$new("div").jAddClass("mz-expand").jAddClass(this.option("cssClass")).jSetCss({opacity:0}),this.expandStage=b.$new("div").jAddClass("mz-expand-stage").jAppendTo(this.expandBox),this.expandControls=b.$new("div").jAddClass("mz-expand-controls").jAppendTo(this.expandStage),d(["prev","next","close"]).jEach(function(a){var c="mz-button";switch(this.buttons[a]=b.$new("button",{title:this.option("text-btn-"+a)}).jAddClass(c).jAddClass(c+"-"+a),f.appendChild(this.buttons[a]),a){case"prev":this.buttons[a].jAddEvent("tap btnclick",function(a){a.stop(),this.update(this.getPrev())}.jBindAsEvent(this));break;case"next":this.buttons[a].jAddEvent("tap btnclick",function(a){a.stop(),this.update(this.getNext())}.jBindAsEvent(this));break;case"close":this.buttons[a].jAddEvent("tap btnclick",function(a){a.stop(),this.close()}.jBindAsEvent(this))}},this),this.expandControls.append(f),this.expandBox.jAddEvent("mousescroll touchstart dbltap",d(function(a){d(a).stop()})),this.option("closeOnClickOutside")&&this.expandBox.jAddEvent("tap btnclick",function(a){var b=a.jGetPageXY(),c=d("magnifier"===this.option("expandZoomMode")?this.zoomBox.node:this.zoomBox.image).jGetRect();return"always"!==this.option("expandZoomOn")&&c.top<=b.y&&b.y<=c.bottom&&c.left<=b.x&&b.x<=c.right?(a.stopQueue(),void this.deactivate(a)):void("always"!==this.option("expandZoomOn")&&this.node.hasChild(a.getOriginalTarget())||(a.stop(),this.close()))}.jBindAsEvent(this)),this.keyboardCallback=d(function(a){var b=null;27!==a.keyCode&&37!==a.keyCode&&39!==a.keyCode||(d(a).stop(),27===a.keyCode?this.close():(b=37===a.keyCode?this.getPrev():this.getNext(),b&&this.update(b)))}).jBindAsEvent(this),this.onExpand=d(function(){this.node.jRemoveEvent("transitionend").jSetCss({transition:"",transform:"translate3d(0,0,0)"}),this.expanded||(this.expanded=!0,this.expandBox.jRemoveClass("mz-expand-opening").jSetCss({opacity:1}),this.zoomBox.setMode(this.option("expandZoomMode")),this.zoomSize=b.detach(this.zoomSizeOrigin),this.resizeCallback(),this.expandCaption&&this.image.caption&&(this.image.link?this.expandCaption.append(b.$new("a",{href:this.image.link}).jAddEvent("tap btnclick",this.openLink.jBind(this)).changeContent(this.image.caption)):this.expandCaption.changeContent(this.image.caption),this.expandCaption.jAddClass("mz-show")),"always"!==this.option("expandZoomOn")&&(this.registerActivateEvent(!0),this.registerDeactivateEvent(!0)),this.ready=!0,"always"===this.option("expandZoomOn")&&(!1!==this.zoomBox.mode&&this.zoomBox.enable(!0),b.browser.mobile&&this.mobileZoomHint&&(this.mobileZoomHint=!1),this.activate()),(b.browser.mobile||this.option("forceTouch"))&&this.zoomBox.enabled&&((this.mobileZoomHint||this.hintRuns>0)&&this.showHint(!0,this.option("textClickZoomHint")),this.mobileZoomHint=!1),this.expandControls.jRemoveClass("mz-hidden").jAddClass("mz-fade mz-visible"),this.expandNav&&this.expandNav.jRemoveClass("mz-hidden").jAddClass("mz-fade mz-visible"),this.expandThumbs&&(this.expandThumbs.run(),this.setActiveThumb(this.image)),e&&e.jAppendTo(this.expandBox,(Math.floor(101*Math.random())+1)%2?"top":"bottom"),this.expandGallery.length&&!this.additionalImages.length&&this.swipe(),d(document).jAddEvent("keydown",this.keyboardCallback),"ios"==b.browser.platform&&"safari"==b.browser.uaName&&7==parseInt(b.browser.uaVersion)&&(t=D()),B("onExpandOpen",this.id))}).jBind(this),this.onClose=d(function(){this.node.jRemoveEvent("transitionend"),this.expanded&&(this.expanded&&(d(document).jRemoveEvent("keydown",this.keyboardCallback),this.deactivate(null,!0)),this.destroyExpandGallery(),this.expanded=!1,this.zoomBox.setMode(this.option("zoomMode")),this.node.replaceChild(this.image.getNode("small"),this.image.node),this.image.setCurNode("small"),d(this.image.node).jSetCss({width:"",height:"","max-width":Math.min(this.image.jGetSize("small").width),"max-height":Math.min(this.image.jGetSize("small").height)}),this.node.jSetCss({opacity:"",transition:""}),this.node.jSetCss({transform:"translate3d(0,0,0)"}),d(this.placeholder).replaceChild(this.node,this.stubNode),this.setSize(!0),this.expandCaption&&(this.expandCaption.jRemove(),this.expandCaption=null),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),"always"==this.option("zoomOn")?this.activate():!1!==this.option("zoomMode")&&(this.registerActivateEvent("click"===this.option("zoomOn")),this.registerDeactivateEvent("click"===this.option("zoomOn")&&!this.option("expand"))),this.showHint(),this.expandBg.jRemoveEvent("transitionend"),this.expandBox.jRemove(),this.expandBg.jRemove(),this.expandBg=null,d(b.browser.getDoc()).jRemoveClass("mz-expanded-view-open"),this.ready=!0,b.browser.ieMode<10?this.resizeCallback():d(window).jRaiseEvent("UIEvent","resize"),B("onExpandClose",this.id))}).jBind(this),this.expandImageStage=b.$new("div",{class:"mz-image-stage"}).jAppendTo(this.expandStage),this.expandFigure=b.$new("figure").jAppendTo(this.expandImageStage),this.stubNode=this.node.cloneNode(!1)),this.setupExpandGallery(),d(b.browser.getDoc()).jAddClass("mz-expanded-view-open"),d(document.body).jGetSize(),"fullscreen"==this.option("expand")?(this.prepareExpandedView(),a.browser.fullScreen.request(this.expandBox,{onEnter:d(function(){this.onExpand()}).jBind(this),onExit:this.onClose,fallback:d(function(){this.expandToWindow()}).jBind(this)})):setTimeout(d(function(){this.prepareExpandedView(),this.expandToWindow()}).jBind(this),96)},prepareExpandedView:function(){var a,c;a=b.$new("img",{src:this.image.getURL("zoom")}),this.expandBg=b.$new("div").jAddClass("mz-expand-bg").append(b.browser.features.cssFilters||b.browser.ieMode<10?a:new b.SVGImage(a).blur(i).getNode()).jAppendTo(this.expandBox),"always"===this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&this.expandStage.jAddClass("mz-always-zoom"+("zoom"===this.option("expandZoomMode")?" mz-zoom-in":"")).jGetSize(),c=d(this.node)[b.browser.ieMode<10?"jGetSize":"getBoundingClientRect"](),d(this.stubNode).jSetCss({width:c.width,height:c.height}),this.node.replaceChild(this.image.getNode("zoom"),this.image.node),this.image.setCurNode("zoom"),this.expandBox.jAppendTo(document.body),this.expandMaxWidth=function(){var a=this.expandImageStage;return d(this.expandFigure).jGetSize().width>50&&(a=this.expandFigure),function(){return"always"==this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&"magnifier"!==this.option("expandZoomMode")?1/0:Math.round(d(a).getInnerSize().width)}}.call(this),this.expandMaxHeight=function(){var a=this.expandImageStage;return d(this.expandFigure).jGetSize().height>50&&(a=this.expandFigure),function(){return"always"==this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&"magnifier"!==this.option("expandZoomMode")?1/0:Math.round(d(a).getInnerSize().height)}}.call(this),this.expandControls.jRemoveClass("mz-fade mz-visible").jAddClass("mz-hidden"),this.expandNav&&this.expandNav.jRemoveClass("mz-fade mz-visible").jAddClass("mz-hidden"),this.image.node.jSetCss({"max-height":Math.min(this.image.jGetSize("zoom").height,this.expandMaxHeight())}),this.image.node.jSetCss({"max-width":Math.min(this.image.jGetSize("zoom").width,this.expandMaxWidth())}),this.expandFigure.append(d(this.placeholder).replaceChild(this.stubNode,this.node)),this.option("expandCaption")&&(this.expandCaption=b.$new("figcaption",{class:"mz-caption"}).jAppendTo(this.expandFigure))},expandToWindow:function(){this.node.jSetCss({transition:""}),this.node.jSetCss({transform:"scale(0.6)"}).jGetSize(),b.browser.androidBrowser&&"chrome"!==b.browser.uaName?this.node.jSetCss({transition:b.browser.cssTransform+" 0.6s cubic-bezier(0.175, 0.885, 0.320, 1) 0s"}):this.node.jSetCss({transition:b.browser.cssTransform+" 0.6s cubic-bezier(0.175, 0.885, 0.320, 1.275) 0s"}),b.browser.features.transition?(this.node.jAddEvent("transitionend",this.onExpand),!b.browser.chrome||"chrome"!==b.browser.uaName&&"opera"!==b.browser.uaName||setTimeout(d(function(){this.onExpand()}).jBind(this),800)):this.onExpand.jDelay(16,this),this.expandBox.jSetCss({opacity:1}),this.node.jSetCss({transform:"scale(1)"})},openLink:function(){this.image.link&&window.open(this.image.link,"_self")},getNext:function(){var a=(this.expanded?this.expandGallery:this.additionalImages).filter(function(a){return-1!==a.small.state||-1!==a.zoom.state}),b=a.length,c=d(a).indexOf(this.image)+1;return 1>=b?null:a[c>=b?0:c]},getPrev:function(){var a=(this.expanded?this.expandGallery:this.additionalImages).filter(function(a){return-1!==a.small.state||-1!==a.zoom.state}),b=a.length,c=d(a).indexOf(this.image)-1;return 1>=b?null:a[c<0?b-1:c]},imageByURL:function(a,c){var d=this.additionalImages.filter(function(b){return(b.zoom.src.has(a)||b.zoom.url.has(a))&&(b.small.src.has(c)||b.small.url.has(c))})||[];return d[0]||(c&&a&&"string"===b.jTypeOf(c)&&"string"===b.jTypeOf(a)?new F(c,a):null)},imageByOrigin:function(a){var b=this.additionalImages.filter(function(b){return b.origin===a})||[];return b[0]},imageByIndex:function(a){return this.additionalImages[a]}},k={version:"v5.1.11 (Plus)",start:function(a,c){var e=null,f=[];return b.$A(a?[d(a)]:b.$A(document.byClass("MagicZoom")).concat(b.$A(document.byClass("MagicZoomPlus")))).jEach(function(a){d(a)&&(x(a)||(e=new G(a,c),q&&!e.option("autostart")?(e.stop(),e=null):(m.push(e),f.push(e))))}.jBind(this)),a?f[0]:f},stop:function(a){var b,c;if(a)return void((c=x(a))&&(c=m.splice(m.indexOf(c),1))&&c[0].stop()&&delete c[0]);for(;b=m.length;)c=m.splice(b-1,1),c[0].stop(),delete c[0]},refresh:function(a){return this.stop(a),this.start(a)},update:function(a,c,d,e){var g,f=x(a);f&&(g="element"===b.jTypeOf(c)?f.imageByOrigin(c):f.imageByURL(c,d),g&&f.update(g))},switchTo:function(a,c){var e,d=x(a);if(d){switch(b.jTypeOf(c)){case"element":e=d.imageByOrigin(c);break;case"number":e=d.imageByIndex(c)}e&&d.update(e)}},prev:function(a){var b;(b=x(a))&&b.update(b.getPrev())},next:function(a){var b;(b=x(a))&&b.update(b.getNext())},zoomIn:function(a){var b;(b=x(a))&&b.activate()},zoomOut:function(a){var b;(b=x(a))&&b.deactivate()},expand:function(a){var b;(b=x(a))&&b.expand()},close:function(a){var b;(b=x(a))&&b.close()},registerCallback:function(a,c){l[a]||(l[a]=[]),"function"==b.jTypeOf(c)&&l[a].push(c)},running:function(a){return!!x(a)}},d(document).jAddEvent("domready",function(){var a=window[h+"Options"]||{};v=v(),E(),n=b.$new("div",{
class:"magic-hidden-wrapper"}).jAppendTo(document.body),p=b.browser.mobile&&window.matchMedia&&window.matchMedia("(max-device-width: 767px), (max-device-height: 767px)").matches,b.browser.mobile&&b.extend(e,f);for(var c=0;c<j.length;c++)a[j[c]]&&b.$F!==a[j[c]]&&k.registerCallback(j[c],a[j[c]]);k.start(),q=!1}),window.MagicZoomPlus=window.MagicZoomPlus||{},k}();

/*   Magic scroll js  */
window.MagicScroll=function(){var a,b;a=b=function(){function j(a){var b=a.charAt(0).toUpperCase()+a.slice(1);return a in i||"Webkit"+b in i||"Moz"+b in i||"ms"+b in i||"O"+b in i}function p(a){var c,d;return d=(!b.browser.webkit||"filter"!=a)&&a in i,!d&&(c=b.browser.cssDomPrefix+a.charAt(0).toUpperCase()+a.slice(1),c in i)?c:a}var a={version:"v3.3-b4",UUID:0,storage:{},$uuid:function(a){return a.$J_UUID||(a.$J_UUID=++b.UUID)},getStorage:function(a){return b.storage[a]||(b.storage[a]={})},$F:function(){},$false:function(){return!1},$true:function(){return!0},stylesId:"mjs-"+Math.floor(Math.random()*(new Date).getTime()),defined:function(a){return void 0!=a},ifndef:function(a,b){return void 0!=a?a:b},exists:function(a){return!!a},jTypeOf:function(a){if(!b.defined(a))return!1;if(a.$J_TYPE)return a.$J_TYPE;if(a.nodeType){if(1==a.nodeType)return"element";if(3==a.nodeType)return"textnode"}if(a.length&&a.item)return"collection";if(a.length&&a.callee)return"arguments";if((a instanceof window.Object||a instanceof window.Function)&&a.constructor===b.Class)return"class";if(a instanceof window.Array)return"array";if(a instanceof window.Function)return"function";if(a instanceof window.String)return"string";if(b.browser.trident){if(b.defined(a.cancelBubble))return"event"}else if(a===window.event||a.constructor==window.Event||a.constructor==window.MouseEvent||a.constructor==window.UIEvent||a.constructor==window.KeyboardEvent||a.constructor==window.KeyEvent)return"event";return a instanceof window.Date?"date":a instanceof window.RegExp?"regexp":a===window?"window":a===document?"document":typeof a},extend:function(a,c){if(a instanceof window.Array||(a=[a]),!c)return a[0];for(var d=0,e=a.length;d<e;d++)if(b.defined(a))for(var f in c)if(Object.prototype.hasOwnProperty.call(c,f))try{a[d][f]=c[f]}catch(a){}return a[0]},implement:function(a,c){a instanceof window.Array||(a=[a]);for(var d=0,e=a.length;d<e;d++)if(b.defined(a[d])&&a[d].prototype)for(var f in c||{})a[d].prototype[f]||(a[d].prototype[f]=c[f]);return a[0]},nativize:function(a,c){if(!b.defined(a))return a;for(var d in c||{})a[d]||(a[d]=c[d]);return a},$try:function(){for(var a=0,b=arguments.length;a<b;a++)try{return arguments[a]()}catch(a){}return null},$A:function(a){if(!b.defined(a))return b.$([]);if(a.toArray)return b.$(a.toArray());if(a.item){for(var c=a.length||0,d=new Array(c);c--;)d[c]=a[c];return b.$(d)}return b.$(Array.prototype.slice.call(a))},now:function(){return(new Date).getTime()},detach:function(a){var c;switch(b.jTypeOf(a)){case"object":c={};for(var d in a)c[d]=b.detach(a[d]);break;case"array":c=[];for(var e=0,f=a.length;e<f;e++)c[e]=b.detach(a[e]);break;default:return a}return b.$(c)},$:function(a){var c=!0;if(!b.defined(a))return null;if(a.$J_EXT)return a;switch(b.jTypeOf(a)){case"array":return a=b.nativize(a,b.extend(b.Array,{$J_EXT:b.$F})),a.jEach=a.forEach,a;case"string":var d=document.getElementById(a);return b.defined(d)?b.$(d):null;case"window":case"document":b.$uuid(a),a=b.extend(a,b.Doc);break;case"element":b.$uuid(a),a=b.extend(a,b.Element);break;case"event":a=b.extend(a,b.Event);break;case"textnode":case"function":case"array":case"date":default:c=!1}return c?b.extend(a,{$J_EXT:b.$F}):a},$new:function(a,c,d){return b.$(b.doc.createElement(a)).setProps(c||{}).jSetCss(d||{})},addCSS:function(a,c,d){var e,f,g,h=[],i=-1;if(d||(d=b.stylesId),e=b.$(d)||b.$new("style",{id:d,type:"text/css"}).jAppendTo(document.head||document.body,"top"),f=e.sheet||e.styleSheet,"string"!=b.jTypeOf(c)){for(var g in c)h.push(g+":"+c[g]);c=h.join(";")}return i=f.insertRule?f.insertRule(a+" {"+c+"}",f.cssRules.length):f.addRule(a,c)},removeCSS:function(a,c){var d,e;d=b.$(a),"element"===b.jTypeOf(d)&&(e=d.sheet||d.styleSheet,e.deleteRule?e.deleteRule(c):e.removeRule&&e.removeRule(c))},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)}).toUpperCase()},getAbsoluteURL:function(){var a;return function(b){return a||(a=document.createElement("a")),a.setAttribute("href",b),("!!"+a.href).replace("!!","")}}(),getHashCode:function(a){for(var b=0,c=a.length,d=0;d<c;++d)b=31*b+a.charCodeAt(d),b%=4294967296;return b}},b=a;a.$;window.magicJS||(window.magicJS=a,window.$mjs=a.$),b.Array={$J_TYPE:"array",indexOf:function(a,b){for(var d=(this.length,this.length),e=b<0?Math.max(0,d+b):b||0;e<d;e++)if(this[e]===a)return e;return-1},contains:function(a,b){return this.indexOf(a,b)!=-1},forEach:function(a,b){for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)},filter:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)if(d in this){var f=this[d];a.call(b,this[d],d,this)&&c.push(f)}return c},map:function(a,b){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c}},b.implement(String,{$J_TYPE:"string",jTrim:function(){return this.replace(/^\s+|\s+$/g,"")},eq:function(a,b){return b?this.toString()===a.toString():this.toLowerCase().toString()===a.toLowerCase().toString()},jCamelize:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},dashize:function(){return this.replace(/[A-Z]/g,function(a){return"-"+a.charAt(0).toLowerCase()})},jToInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},jToBool:function(){return!this.replace(/true/i,"").jTrim()},has:function(a,b){return b=b||"",(b+this+b).indexOf(b+a+b)>-1}}),a.implement(Function,{$J_TYPE:"function",jBind:function(){var a=b.$A(arguments),c=this,d=a.shift();return function(){return c.apply(d||null,a.concat(b.$A(arguments)))}},jBindAsEvent:function(){var a=b.$A(arguments),c=this,d=a.shift();return function(e){return c.apply(d||null,b.$([e||(b.browser.ieMode?window.event:null)]).concat(a))}},jDelay:function(){var a=b.$A(arguments),c=this,d=a.shift();return window.setTimeout(function(){return c.apply(c,a)},d||0)},jDefer:function(){var a=b.$A(arguments),c=this;return function(){return c.jDelay.apply(c,a)}},interval:function(){var a=b.$A(arguments),c=this,d=a.shift();return window.setInterval(function(){return c.apply(c,a)},d||0)}});var d={},e=navigator.userAgent.toLowerCase(),f=e.match(/(webkit|gecko|trident|presto)\/(\d+\.?\d*)/i),g=e.match(/(edge|opr)\/(\d+\.?\d*)/i)||e.match(/(crios|chrome|safari|firefox|opera|opr)\/(\d+\.?\d*)/i),h=e.match(/version\/(\d+\.?\d*)/i),i=document.documentElement.style;b.browser={features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,fullScreen:!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.exitFullscreen||document.cancelFullScreen||document.webkitexitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.msCancelFullScreen),xhr2:!!window.ProgressEvent&&!!window.FormData&&window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,transition:j("transition"),transform:j("transform"),perspective:j("perspective"),animation:j("animation"),requestAnimationFrame:!1,multibackground:!1,cssFilters:!1,canvas:!1,svg:function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")}()},touchScreen:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}(),mobile:!!e.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/),engine:f&&f[1]?f[1].toLowerCase():window.opera?"presto":window.ActiveXObject?"trident":void 0!==document.getBoxObjectFor||null!=window.mozInnerScreenY?"gecko":null===window.WebKitPoint&&navigator.taintEnabled?"unknown":"webkit",version:f&&f[2]?parseFloat(f[2]):0,uaName:g&&g[1]?g[1].toLowerCase():"",uaVersion:g&&g[2]?parseFloat(g[2]):0,cssPrefix:"",cssDomPrefix:"",domPrefix:"",ieMode:0,platform:e.match(/ip(?:ad|od|hone)/)?"ios":(e.match(/(?:webos|android)/)||navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),backCompat:document.compatMode&&"backcompat"==document.compatMode.toLowerCase(),scrollbarsWidth:0,getDoc:function(){return document.compatMode&&"backcompat"==document.compatMode.toLowerCase()?document.body:document.documentElement},requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||void 0,cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||void 0,ready:!1,onready:function(){if(!b.browser.ready){var a,c;b.browser.ready=!0,b.body=b.$(document.body),b.win=b.$(window);try{var e=b.$new("div").jSetCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).jAppendTo(document.body);b.browser.scrollbarsWidth=e.offsetWidth-e.clientWidth,e.jRemove()}catch(a){}try{a=b.$new("div"),c=a.style,c.cssText="background:url(https://),url(https://),red url(https://)",b.browser.features.multibackground=/(url\s*\(.*?){3}/.test(c.background),c=null,a=null}catch(a){}b.browser.cssTransformProp||(b.browser.cssTransformProp=b.normalizeCSS("transform").dashize());try{a=b.$new("div"),a.style.cssText=b.normalizeCSS("filter").dashize()+":blur(2px);",b.browser.features.cssFilters=!!a.style.length&&(!b.browser.ieMode||b.browser.ieMode>9),a=null}catch(a){}b.browser.features.cssFilters||b.$(document.documentElement).jAddClass("no-cssfilters-magic");try{b.browser.features.canvas=function(){var a=b.$new("canvas");return!(!a.getContext||!a.getContext("2d"))}()}catch(a){}void 0===window.TransitionEvent&&void 0!==window.WebKitTransitionEvent&&(d.transitionend="webkitTransitionEnd"),b.Doc.jCallEvent.call(b.$(document),"domready")}}},function(){var c,d,e,a=[];switch(b.browser.engine){case"trident":b.browser.version||(b.browser.version=window.XMLHttpRequest?3:2);break;case"gecko":b.browser.version=g&&g[2]?parseFloat(g[2]):0}if(b.browser[b.browser.engine]=!0,g&&"crios"===g[1]&&(b.browser.uaName="chrome"),window.chrome&&(b.browser.chrome=!0),g&&"opr"===g[1]&&(b.browser.uaName="opera",b.browser.opera=!0),"safari"===b.browser.uaName&&h&&h[1]&&(b.browser.uaVersion=parseFloat(h[1])),"android"==b.browser.platform&&b.browser.webkit&&h&&h[1]&&(b.browser.androidBrowser=!0),c={gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"],presto:["-o-","O","o"]}[b.browser.engine]||["","",""],b.browser.cssPrefix=c[0],b.browser.cssDomPrefix=c[1],b.browser.domPrefix=c[2],b.browser.ieMode=b.browser.trident?document.documentMode?document.documentMode:function(){var a=0;if(b.browser.backCompat)return 5;switch(b.browser.version){case 2:a=6;break;case 3:a=7}return a}():void 0,a.push(b.browser.platform+"-magic"),b.browser.mobile&&a.push("mobile-magic"),b.browser.androidBrowser&&a.push("android-browser-magic"),b.browser.ieMode)for(b.browser.uaName="ie",b.browser.uaVersion=b.browser.ieMode,a.push("ie"+b.browser.ieMode+"-magic"),d=11;d>b.browser.ieMode;d--)a.push("lt-ie"+d+"-magic");b.browser.webkit&&b.browser.version<536&&(b.browser.features.fullScreen=!1),b.browser.requestAnimationFrame&&b.browser.requestAnimationFrame.call(window,function(){b.browser.features.requestAnimationFrame=!0}),b.browser.features.svg?a.push("svg-magic"):a.push("no-svg-magic"),e=(document.documentElement.className||"").match(/\S+/g)||[],document.documentElement.className=b.$(e).concat(a).join(" ");try{document.documentElement.setAttribute("data-magic-ua",b.browser.uaName),document.documentElement.setAttribute("data-magic-ua-ver",b.browser.uaVersion)}catch(a){}b.browser.ieMode&&b.browser.ieMode<9&&(document.createElement("figure"),document.createElement("figcaption"))}(),function(){b.browser.fullScreen={capable:b.browser.features.fullScreen,enabled:function(){return!!(document.fullscreenElement||document[b.browser.domPrefix+"FullscreenElement"]||document.fullScreen||document.webkitIsFullScreen||document[b.browser.domPrefix+"FullScreen"])},request:function(a,c){c||(c={}),this.capable?(b.$(document).jAddEvent(this.changeEventName,this.onchange=function(a){this.enabled()?c.onEnter&&c.onEnter():(b.$(document).jRemoveEvent(this.changeEventName,this.onchange),c.onExit&&c.onExit())}.jBindAsEvent(this)),b.$(document).jAddEvent(this.errorEventName,this.onerror=function(a){c.fallback&&c.fallback(),b.$(document).jRemoveEvent(this.errorEventName,this.onerror)}.jBindAsEvent(this)),(a[b.browser.domPrefix+"RequestFullscreen"]||a[b.browser.domPrefix+"RequestFullScreen"]||a.requestFullscreen||function(){}).call(a)):c.fallback&&c.fallback()},cancel:(document.exitFullscreen||document.cancelFullScreen||document[b.browser.domPrefix+"ExitFullscreen"]||document[b.browser.domPrefix+"CancelFullScreen"]||function(){}).jBind(document),changeEventName:document.msExitFullscreen?"MSFullscreenChange":(document.exitFullscreen?"":b.browser.domPrefix)+"fullscreenchange",errorEventName:document.msExitFullscreen?"MSFullscreenError":(document.exitFullscreen?"":b.browser.domPrefix)+"fullscreenerror",prefix:b.browser.domPrefix,activeElement:null}}();var k=/\S+/g,l=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,m={float:"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat"},n={fontWeight:!0,lineHeight:!0,opacity:!0,zIndex:!0,zoom:!0},o=window.getComputedStyle?function(a,b){var c=window.getComputedStyle(a,null);return c?c.getPropertyValue(b)||c[b]:null}:function(a,b){var c=a.currentStyle,d=null;return d=c?c[b]:null,null==d&&a.style&&a.style[b]&&(d=a.style[b]),d};return b.normalizeCSS=p,b.Element={jHasClass:function(a){return!(a||"").has(" ")&&(this.className||"").has(a," ")},jAddClass:function(a){for(var c=(this.className||"").match(k)||[],d=(a||"").match(k)||[],e=d.length,f=0;f<e;f++)b.$(c).contains(d[f])||c.push(d[f]);return this.className=c.join(" "),this},jRemoveClass:function(a){for(var g,c=(this.className||"").match(k)||[],d=(a||"").match(k)||[],e=d.length,f=0;f<e;f++)(g=b.$(c).indexOf(d[f]))>-1&&c.splice(g,1);return this.className=a?c.join(" "):"",this},jToggleClass:function(a){return this.jHasClass(a)?this.jRemoveClass(a):this.jAddClass(a)},jGetCss:function(a){var c=a.jCamelize(),d=null;if(a=m[c]||(m[c]=p(c)),d=o(this,a),"auto"===d&&(d=null),null!==d){if("opacity"==a)return b.defined(d)?parseFloat(d):1;l.test(a)&&(d=parseInt(d,10)?d:"0px")}return d},jSetCssProp:function(a,c){var d=a.jCamelize();try{if("opacity"==a)return this.jSetOpacity(c),this;a=m[d]||(m[d]=p(d)),this.style[a]=c+("number"!=b.jTypeOf(c)||n[d]?"":"px")}catch(a){}return this},jSetCss:function(a){for(var b in a)this.jSetCssProp(b,a[b]);return this},jGetStyles:function(){var a={};return b.$A(arguments).jEach(function(b){a[b]=this.jGetCss(b)},this),a},jSetOpacity:function(a,c){return c=c||!1,this.style.opacity=a,a=parseInt(100*parseFloat(a)),c&&(0===a?"hidden"!=this.style.visibility&&(this.style.visibility="hidden"):"visible"!=this.style.visibility&&(this.style.visibility="visible")),b.browser.ieMode&&b.browser.ieMode<9&&(isNaN(a)?(this.style.filter=this.style.filter.replace(/progid:DXImageTransform.Microsoft.Alpha\(Opacity=\d*\)/i,"").jTrim(),""===this.style.filter&&this.style.removeAttribute("filter")):~this.style.filter.indexOf("Alpha")?this.style.filter=this.style.filter.replace(/Opacity=\d*/i,"Opacity="+a):this.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+a+")"),this},setProps:function(a){for(var b in a)"class"===b?this.jAddClass(""+a[b]):this.setAttribute(b,""+a[b]);return this},jGetTransitionDuration:function(){var a=0,b=0;return a=this.jGetCss("transition-duration"),b=this.jGetCss("transition-delay"),a=a.indexOf("ms")>-1?parseFloat(a):a.indexOf("s")>-1?1e3*parseFloat(a):0,b=b.indexOf("ms")>-1?parseFloat(b):b.indexOf("s")>-1?1e3*parseFloat(b):0,a+b},hide:function(){return this.jSetCss({display:"none",visibility:"hidden"})},show:function(){return this.jSetCss({display:"",visibility:"visible"})},jGetSize:function(){return{width:this.offsetWidth,height:this.offsetHeight}},getInnerSize:function(a){var b=this.jGetSize();return b.width-=parseFloat(this.jGetCss("border-left-width")||0)+parseFloat(this.jGetCss("border-right-width")||0),b.height-=parseFloat(this.jGetCss("border-top-width")||0)+parseFloat(this.jGetCss("border-bottom-width")||0),a||(b.width-=parseFloat(this.jGetCss("padding-left")||0)+parseFloat(this.jGetCss("padding-right")||0),b.height-=parseFloat(this.jGetCss("padding-top")||0)+parseFloat(this.jGetCss("padding-bottom")||0)),b},jGetScroll:function(){return{top:this.scrollTop,left:this.scrollLeft}},jGetFullScroll:function(){var a=this,b={top:0,left:0};do b.left+=a.scrollLeft||0,b.top+=a.scrollTop||0,a=a.parentNode;while(a);return b},jGetPosition:function(){var a=this,c=0,d=0;if(b.defined(document.documentElement.getBoundingClientRect)){var e=this.getBoundingClientRect(),f=b.$(document).jGetScroll(),g=b.browser.getDoc();return{top:e.top+f.y-g.clientTop,left:e.left+f.x-g.clientLeft}}do c+=a.offsetLeft||0,d+=a.offsetTop||0,a=a.offsetParent;while(a&&!/^(?:body|html)$/i.test(a.tagName));return{top:d,left:c}},jGetRect:function(){var a=this.jGetPosition(),b=this.jGetSize();return{top:a.top,bottom:a.top+b.height,left:a.left,right:a.left+b.width}},changeContent:function(a){try{this.innerHTML=a}catch(b){this.innerText=a}return this},jRemove:function(){return this.parentNode?this.parentNode.removeChild(this):this},kill:function(){return b.$A(this.childNodes).jEach(function(a){3!=a.nodeType&&8!=a.nodeType&&b.$(a).kill()}),this.jRemove(),this.jClearEvents(),this.$J_UUID&&(b.storage[this.$J_UUID]=null,delete b.storage[this.$J_UUID]),null},append:function(a,b){b=b||"bottom";var c=this.firstChild;return"top"==b&&c?this.insertBefore(a,c):this.appendChild(a),this},jAppendTo:function(a,c){b.$(a).append(this,c);return this},enclose:function(a){return this.append(a.parentNode.replaceChild(this,a)),this},hasChild:function(a){return"element"===b.jTypeOf("string"==b.jTypeOf(a)?a=document.getElementById(a):a)&&(this!=a&&(this.contains&&!b.browser.webkit419?this.contains(a):this.compareDocumentPosition?!!(16&this.compareDocumentPosition(a)):b.$A(this.byTag(a.tagName)).contains(a)))}},b.Element.jGetStyle=b.Element.jGetCss,b.Element.jSetStyle=b.Element.jSetCss,window.Element||(window.Element=b.$F,b.browser.engine.webkit&&window.document.createElement("iframe"),window.Element.prototype=b.browser.engine.webkit?window["[[DOMElement.prototype]]"]:{}),b.implement(window.Element,{$J_TYPE:"element"}),b.Doc={jGetSize:function(){return b.browser.touchScreen||b.browser.presto925||b.browser.webkit419?{width:window.innerWidth,height:window.innerHeight}:{width:b.browser.getDoc().clientWidth,height:b.browser.getDoc().clientHeight}},jGetScroll:function(){return{x:window.pageXOffset||b.browser.getDoc().scrollLeft,y:window.pageYOffset||b.browser.getDoc().scrollTop}},jGetFullSize:function(){var a=this.jGetSize();return{width:Math.max(b.browser.getDoc().scrollWidth,a.width),height:Math.max(b.browser.getDoc().scrollHeight,a.height)}}},b.extend(document,{$J_TYPE:"document"}),b.extend(window,{$J_TYPE:"window"}),b.extend([b.Element,b.Doc],{jFetch:function(a,c){var d=b.getStorage(this.$J_UUID),e=d[a];return void 0!==c&&void 0===e&&(e=d[a]=c),b.defined(e)?e:null},jStore:function(a,c){var d=b.getStorage(this.$J_UUID);return d[a]=c,this},jDel:function(a){var c=b.getStorage(this.$J_UUID);return delete c[a],this}}),window.HTMLElement&&window.HTMLElement.prototype&&window.HTMLElement.prototype.getElementsByClassName||b.extend([b.Element,b.Doc],{getElementsByClassName:function(a){return b.$A(this.getElementsByTagName("*")).filter(function(b){try{return 1==b.nodeType&&b.className.has(a," ")}catch(a){}})}}),b.extend([b.Element,b.Doc],{byClass:function(){return this.getElementsByClassName(arguments[0])},byTag:function(){return this.getElementsByTagName(arguments[0])}}),b.browser.fullScreen.capable&&!document.requestFullScreen&&(b.Element.requestFullScreen=function(){b.browser.fullScreen.request(this)}),b.Event={$J_TYPE:"event",isQueueStopped:b.$false,stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.stopPropagation?this.stopPropagation():this.cancelBubble=!0,this},stopDefaults:function(){return this.preventDefault?this.preventDefault():this.returnValue=!1,this},stopQueue:function(){return this.isQueueStopped=b.$true,this},getClientXY:function(){var a;return a=/touch/i.test(this.type)?this.changedTouches[0]:this,b.defined(a)?{x:a.clientX,y:a.clientY}:{x:0,y:0}},jGetPageXY:function(){var a;return a=/touch/i.test(this.type)?this.changedTouches[0]:this,b.defined(a)?{x:a.pageX||a.clientX+b.browser.getDoc().scrollLeft,y:a.pageY||a.clientY+b.browser.getDoc().scrollTop}:{x:0,y:0}},getTarget:function(){for(var a=this.target||this.srcElement;a&&3==a.nodeType;)a=a.parentNode;return a},getRelated:function(){var a=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":a=this.relatedTarget||this.fromElement;break;case"mouseout":case"pointerout":case"MSPointerOut":a=this.relatedTarget||this.toElement;break;default:return a}try{for(;a&&3==a.nodeType;)a=a.parentNode}catch(b){a=null}return a},getButton:function(){return this.which||void 0===this.button?this.which:1&this.button?1:2&this.button?3:4&this.button?2:0},isTouchEvent:function(){return this.pointerType&&("touch"===this.pointerType||this.pointerType===this.MSPOINTER_TYPE_TOUCH)||/touch/i.test(this.type)},isPrimaryTouch:function(){return this.pointerType?("touch"===this.pointerType||this.MSPOINTER_TYPE_TOUCH===this.pointerType)&&this.isPrimary:1===this.changedTouches.length&&(!this.targetTouches.length||this.targetTouches[0].identifier==this.changedTouches[0].identifier)}},b._event_add_="addEventListener",b._event_del_="removeEventListener",b._event_prefix_="",document.addEventListener||(b._event_add_="attachEvent",b._event_del_="detachEvent",b._event_prefix_="on"),b.Event.Custom={type:"",x:null,y:null,timeStamp:null,button:null,target:null,relatedTarget:null,$J_TYPE:"event.custom",isQueueStopped:b.$false,events:b.$([]),pushToEvents:function(a){var b=a;this.events.push(b)},stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.events.jEach(function(a){try{a.stopDistribution()}catch(a){}}),this},stopDefaults:function(){return this.events.jEach(function(a){try{a.stopDefaults()}catch(a){}}),this},stopQueue:function(){return this.isQueueStopped=b.$true,this},getClientXY:function(){return{x:this.clientX,y:this.clientY}},jGetPageXY:function(){return{x:this.x,y:this.y}},getTarget:function(){return this.target},getRelated:function(){return this.relatedTarget},getButton:function(){return this.button},getOriginalTarget:function(){return this.events.length>0?this.events[0].getTarget():void 0}},b.extend([b.Element,b.Doc],{jAddEvent:function(a,c,e,f){var g,h,i,j,k;return"string"==b.jTypeOf(a)&&(k=a.split(" "),k.length>1&&(a=k)),"array"==b.jTypeOf(a)?(b.$(a).jEach(this.jAddEvent.jBindAsEvent(this,c,e,f)),this):a&&c&&"string"==b.jTypeOf(a)&&"function"==b.jTypeOf(c)?"domready"==a&&b.browser.ready?(c.call(this),this):(a=d[a]||a,e=parseInt(e||50),c.$J_EUID||(c.$J_EUID=Math.floor(Math.random()*b.now())),g=b.Doc.jFetch.call(this,"_EVENTS_",{}),h=g[a],h||(g[a]=h=b.$([]),i=this,b.Event.Custom[a]?b.Event.Custom[a].handler.add.call(this,f):(h.handle=function(c){c=b.extend(c||window.e,{$J_TYPE:"event"}),b.Doc.jCallEvent.call(i,a,b.$(c))},this[b._event_add_](b._event_prefix_+a,h.handle,!1))),j={type:a,fn:c,priority:e,euid:c.$J_EUID},h.push(j),h.sort(function(a,b){return a.priority-b.priority}),this):this},jRemoveEvent:function(a){var e,f,g,h,i,j,c=b.Doc.jFetch.call(this,"_EVENTS_",{});if(i=arguments.length>1?arguments[1]:-100,"string"==b.jTypeOf(a)&&(j=a.split(" "),j.length>1&&(a=j)),"array"==b.jTypeOf(a))return b.$(a).jEach(this.jRemoveEvent.jBindAsEvent(this,i)),this;if(a=d[a]||a,!a||"string"!=b.jTypeOf(a)||!c||!c[a])return this;for(e=c[a]||[],g=0;g<e.length;g++)f=e[g],(-100==i||i&&i.$J_EUID===f.euid)&&(h=e.splice(g--,1));return 0===e.length&&(b.Event.Custom[a]?b.Event.Custom[a].handler.jRemove.call(this):this[b._event_del_](b._event_prefix_+a,e.handle,!1),delete c[a]),this},jCallEvent:function(a,c){var f,h,e=b.Doc.jFetch.call(this,"_EVENTS_",{});if(a=d[a]||a,!a||"string"!=b.jTypeOf(a)||!e||!e[a])return this;try{c=b.extend(c||{},{type:a})}catch(a){}for(void 0===c.timeStamp&&(c.timeStamp=b.now()),f=e[a]||[],h=0;h<f.length&&(!c.isQueueStopped||!c.isQueueStopped());h++)f[h].fn.call(this,c)},jRaiseEvent:function(a,c){var g,e="domready"!=a,f=this;return a=d[a]||a,e?(f===document&&document.createEvent&&!f.dispatchEvent&&(f=document.documentElement),document.createEvent?(g=document.createEvent(a),g.initEvent(c,!0,!0)):(g=document.createEventObject(),g.eventType=a),document.createEvent?f.dispatchEvent(g):f.fireEvent("on"+c,g),g):(b.Doc.jCallEvent.call(this,a),this)},jClearEvents:function(){var a=b.Doc.jFetch.call(this,"_EVENTS_");if(!a)return this;for(var c in a)b.Doc.jRemoveEvent.call(this,c);return b.Doc.jDel.call(this,"_EVENTS_"),this}}),function(a){return"complete"===document.readyState?a.browser.onready.jDelay(1):void(a.browser.webkit&&a.browser.version<420?!function(){a.$(["loaded","complete"]).contains(document.readyState)?a.browser.onready():arguments.callee.jDelay(50)}():a.browser.trident&&a.browser.ieMode<9&&window==top?!function(){a.$try(function(){return a.browser.getDoc().doScroll("left"),!0})?a.browser.onready():arguments.callee.jDelay(50)}():(a.Doc.jAddEvent.call(a.$(document),"DOMContentLoaded",a.browser.onready),a.Doc.jAddEvent.call(a.$(window),"load",a.browser.onready)))}(a),b.Class=function(){var a=null,c=b.$A(arguments);"class"==b.jTypeOf(c[0])&&(a=c.shift());var d=function(){for(var a in this)this[a]=b.detach(this[a]);if(this.constructor.$parent){this.$parent={};var c=this.constructor.$parent;for(var d in c){var e=c[d];switch(b.jTypeOf(e)){case"function":this.$parent[d]=b.Class.wrap(this,e);break;case"object":this.$parent[d]=b.detach(e);break;case"array":this.$parent[d]=b.detach(e)}}}var f=this.init?this.init.apply(this,arguments):this;return delete this.caller,f};if(d.prototype.init||(d.prototype.init=b.$F),a){var e=function(){};e.prototype=a.prototype,d.prototype=new e,d.$parent={};for(var f in a.prototype)d.$parent[f]=a.prototype[f]}else d.$parent=null;return d.constructor=b.Class,d.prototype.constructor=d,b.extend(d.prototype,c[0]),b.extend(d,{$J_TYPE:"class"}),d},a.Class.wrap=function(a,b){return function(){var d=(this.caller,b.apply(a,arguments));return d}},function(a){var c=(a.$,5),d=300;a.Event.Custom.btnclick=new a.Class(a.extend(a.Event.Custom,{type:"btnclick",init:function(a,b){var c=b.jGetPageXY();this.x=c.x,this.y=c.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b)}})),a.Event.Custom.btnclick.handler={options:{threshold:d,button:1},add:function(b){this.jStore("event:btnclick:options",a.extend(a.detach(a.Event.Custom.btnclick.handler.options),b||{})),this.jAddEvent("mousedown",a.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("mouseup",a.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("click",a.Event.Custom.btnclick.handler.onclick,1),a.browser.trident&&a.browser.ieMode<9&&this.jAddEvent("dblclick",a.Event.Custom.btnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("mousedown",a.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("mouseup",a.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("click",a.Event.Custom.btnclick.handler.onclick),a.browser.trident&&a.browser.ieMode<9&&this.jRemoveEvent("dblclick",a.Event.Custom.btnclick.handler.handle)},onclick:function(a){a.stopDefaults()},handle:function(b){var d,e,f;if(e=this.jFetch("event:btnclick:options"),"dblclick"==b.type||b.getButton()==e.button){if(this.jFetch("event:btnclick:ignore"))return void this.jDel("event:btnclick:ignore");if("mousedown"==b.type)d=new a.Event.Custom.btnclick(this,b),this.jStore("event:btnclick:btnclickEvent",d);else if("mouseup"==b.type){if(d=this.jFetch("event:btnclick:btnclickEvent"),!d)return;f=b.jGetPageXY(),this.jDel("event:btnclick:btnclickEvent"),d.pushToEvents(b),b.timeStamp-d.timeStamp<=e.threshold&&Math.sqrt(Math.pow(f.x-d.x,2)+Math.pow(f.y-d.y,2))<=c&&this.jCallEvent("btnclick",d),document.jCallEvent("mouseup",b)}else"dblclick"==b.type&&(d=new a.Event.Custom.btnclick(this,b),this.jCallEvent("btnclick",d))}}}}(a),function(a){var b=a.$;a.Event.Custom.mousedrag=new a.Class(a.extend(a.Event.Custom,{type:"mousedrag",state:"dragstart",dragged:!1,init:function(a,b,c){var d=b.jGetPageXY();this.x=d.x,this.y=d.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b),this.state=c}})),a.Event.Custom.mousedrag.handler={add:function(){var b=a.Event.Custom.mousedrag.handler.handleMouseMove.jBindAsEvent(this),c=a.Event.Custom.mousedrag.handler.handleMouseUp.jBindAsEvent(this);this.jAddEvent("mousedown",a.Event.Custom.mousedrag.handler.handleMouseDown,1),this.jAddEvent("mouseup",a.Event.Custom.mousedrag.handler.handleMouseUp,1),document.jAddEvent("mousemove",b,1),document.jAddEvent("mouseup",c,1),this.jStore("event:mousedrag:listeners:document:move",b),this.jStore("event:mousedrag:listeners:document:end",c)},jRemove:function(){this.jRemoveEvent("mousedown",a.Event.Custom.mousedrag.handler.handleMouseDown),this.jRemoveEvent("mouseup",a.Event.Custom.mousedrag.handler.handleMouseUp),b(document).jRemoveEvent("mousemove",this.jFetch("event:mousedrag:listeners:document:move")||a.$F),b(document).jRemoveEvent("mouseup",this.jFetch("event:mousedrag:listeners:document:end")||a.$F),this.jDel("event:mousedrag:listeners:document:move"),this.jDel("event:mousedrag:listeners:document:end")},handleMouseDown:function(b){var c;1==b.getButton()&&(c=new a.Event.Custom.mousedrag(this,b,"dragstart"),this.jStore("event:mousedrag:dragstart",c))},handleMouseUp:function(b){var c;c=this.jFetch("event:mousedrag:dragstart"),c&&(b.stopDefaults(),c=new a.Event.Custom.mousedrag(this,b,"dragend"),this.jDel("event:mousedrag:dragstart"),this.jCallEvent("mousedrag",c))},handleMouseMove:function(b){var c;c=this.jFetch("event:mousedrag:dragstart"),c&&(b.stopDefaults(),c.dragged||(c.dragged=!0,this.jCallEvent("mousedrag",c)),c=new a.Event.Custom.mousedrag(this,b,"dragmove"),this.jCallEvent("mousedrag",c))}}}(a),function(a){a.$;a.Event.Custom.dblbtnclick=new a.Class(a.extend(a.Event.Custom,{type:"dblbtnclick",timedout:!1,tm:null,init:function(a,b){var c=b.jGetPageXY();this.x=c.x,this.y=c.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=b.getButton(),this.target=a,this.pushToEvents(b)}})),a.Event.Custom.dblbtnclick.handler={options:{threshold:200},add:function(b){this.jStore("event:dblbtnclick:options",a.extend(a.detach(a.Event.Custom.dblbtnclick.handler.options),b||{})),this.jAddEvent("btnclick",a.Event.Custom.dblbtnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("btnclick",a.Event.Custom.dblbtnclick.handler.handle)},handle:function(b){var c,d;c=this.jFetch("event:dblbtnclick:event"),d=this.jFetch("event:dblbtnclick:options"),c?(clearTimeout(c.tm),this.jDel("event:dblbtnclick:event"),c.timedout||(c.pushToEvents(b),b.stopQueue().stop(),this.jCallEvent("dblbtnclick",c))):(c=new a.Event.Custom.dblbtnclick(this,b),c.tm=setTimeout(function(){c.timedout=!0,b.isQueueStopped=a.$false,this.jCallEvent("btnclick",b),this.jDel("event:dblbtnclick:event")}.jBind(this),d.threshold+10),this.jStore("event:dblbtnclick:event",c),b.stopQueue())}}}(a),function(a){function c(a){return a.pointerType?("touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType)&&a.isPrimary:1===a.changedTouches.length&&(!a.targetTouches.length||a.targetTouches[0].identifier==a.changedTouches[0].identifier);
}function d(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a.pointerId:null:a.changedTouches[0].identifier}function e(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a:null:a.changedTouches[0]}a.$;a.Event.Custom.tap=new a.Class(a.extend(a.Event.Custom,{type:"tap",id:null,init:function(a,b){var c=e(b);this.id=c.pointerId||c.identifier,this.x=c.pageX,this.y=c.pageY,this.pageX=c.pageX,this.pageY=c.pageY,this.clientX=c.clientX,this.clientY=c.clientY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b)}}));var f=10,g=200;a.Event.Custom.tap.handler={add:function(b){this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.tap.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.tap.handler.onTouchEnd,1),this.jAddEvent("click",a.Event.Custom.tap.handler.onClick,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.tap.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.tap.handler.onTouchEnd),this.jRemoveEvent("click",a.Event.Custom.tap.handler.onClick)},onClick:function(a){a.stopDefaults()},onTouchStart:function(b){return c(b)?(this.jStore("event:tap:event",new a.Event.Custom.tap(this,b)),void this.jStore("event:btnclick:ignore",!0)):void this.jDel("event:tap:event")},onTouchEnd:function(b){var i=(a.now(),this.jFetch("event:tap:event"));this.jFetch("event:tap:options");i&&c(b)&&(this.jDel("event:tap:event"),i.id==d(b)&&b.timeStamp-i.timeStamp<=g&&Math.sqrt(Math.pow(e(b).pageX-i.x,2)+Math.pow(e(b).pageY-i.y,2))<=f&&(this.jDel("event:btnclick:btnclickEvent"),b.stop(),i.pushToEvents(b),this.jCallEvent("tap",i)))}}}(a),b.Event.Custom.dbltap=new b.Class(b.extend(b.Event.Custom,{type:"dbltap",timedout:!1,tm:null,init:function(a,b){this.x=b.x,this.y=b.y,this.clientX=b.clientX,this.clientY=b.clientY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b)}})),b.Event.Custom.dbltap.handler={options:{threshold:300},add:function(a){this.jStore("event:dbltap:options",b.extend(b.detach(b.Event.Custom.dbltap.handler.options),a||{})),this.jAddEvent("tap",b.Event.Custom.dbltap.handler.handle,1)},jRemove:function(){this.jRemoveEvent("tap",b.Event.Custom.dbltap.handler.handle)},handle:function(a){var c,d;c=this.jFetch("event:dbltap:event"),d=this.jFetch("event:dbltap:options"),c?(clearTimeout(c.tm),this.jDel("event:dbltap:event"),c.timedout||(c.pushToEvents(a),a.stopQueue().stop(),this.jCallEvent("dbltap",c))):(c=new b.Event.Custom.dbltap(this,a),c.tm=setTimeout(function(){c.timedout=!0,a.isQueueStopped=b.$false,this.jCallEvent("tap",a)}.jBind(this),d.threshold+10),this.jStore("event:dbltap:event",c),a.stopQueue())}},function(a){function c(a){return a.pointerType?("touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType)&&a.isPrimary:1===a.changedTouches.length&&(!a.targetTouches.length||a.targetTouches[0].identifier==a.changedTouches[0].identifier)}function d(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a.pointerId:null:a.changedTouches[0].identifier}function e(a){return a.pointerType?"touch"===a.pointerType||a.MSPOINTER_TYPE_TOUCH===a.pointerType?a:null:a.changedTouches[0]}var b=a.$,f=10;a.Event.Custom.touchdrag=new a.Class(a.extend(a.Event.Custom,{type:"touchdrag",state:"dragstart",id:null,dragged:!1,init:function(a,b,c){var d=e(b);this.id=d.pointerId||d.identifier,this.clientX=d.clientX,this.clientY=d.clientY,this.pageX=d.pageX,this.pageY=d.pageY,this.x=d.pageX,this.y=d.pageY,this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.pushToEvents(b),this.state=c}})),a.Event.Custom.touchdrag.handler={add:function(){var c=a.Event.Custom.touchdrag.handler.onTouchMove.jBind(this),d=a.Event.Custom.touchdrag.handler.onTouchEnd.jBind(this);this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.touchdrag.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.touchdrag.handler.onTouchEnd,1),this.jAddEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],a.Event.Custom.touchdrag.handler.onTouchMove,1),this.jStore("event:touchdrag:listeners:document:move",c),this.jStore("event:touchdrag:listeners:document:end",d),b(document).jAddEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",c,1),b(document).jAddEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",d,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],a.Event.Custom.touchdrag.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],a.Event.Custom.touchdrag.handler.onTouchEnd),this.jRemoveEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],a.Event.Custom.touchdrag.handler.onTouchMove),b(document).jRemoveEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",this.jFetch("event:touchdrag:listeners:document:move")||a.$F,1),b(document).jRemoveEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",this.jFetch("event:touchdrag:listeners:document:end")||a.$F,1),this.jDel("event:touchdrag:listeners:document:move"),this.jDel("event:touchdrag:listeners:document:end")},onTouchStart:function(b){var d;c(b)&&(d=new a.Event.Custom.touchdrag(this,b,"dragstart"),this.jStore("event:touchdrag:dragstart",d))},onTouchEnd:function(b){var c;c=this.jFetch("event:touchdrag:dragstart"),c&&c.dragged&&c.id==d(b)&&(c=new a.Event.Custom.touchdrag(this,b,"dragend"),this.jDel("event:touchdrag:dragstart"),this.jCallEvent("touchdrag",c))},onTouchMove:function(b){var g;if(g=this.jFetch("event:touchdrag:dragstart"),g&&c(b)){if(g.id!=d(b))return void this.jDel("event:touchdrag:dragstart");!g.dragged&&Math.sqrt(Math.pow(e(b).pageX-g.x,2)+Math.pow(e(b).pageY-g.y,2))>f&&(g.dragged=!0,this.jCallEvent("touchdrag",g)),g.dragged&&(g=new a.Event.Custom.touchdrag(this,b,"dragmove"),this.jCallEvent("touchdrag",g))}}}}(a),b.Event.Custom.touchpinch=new b.Class(b.extend(b.Event.Custom,{type:"touchpinch",scale:1,previousScale:1,curScale:1,state:"pinchstart",init:function(a,b){this.timeStamp=b.timeStamp,this.button=0,this.target=a,this.x=b.touches[0].clientX+(b.touches[1].clientX-b.touches[0].clientX)/2,this.y=b.touches[0].clientY+(b.touches[1].clientY-b.touches[0].clientY)/2,this._initialDistance=Math.sqrt(Math.pow(b.touches[0].clientX-b.touches[1].clientX,2)+Math.pow(b.touches[0].clientY-b.touches[1].clientY,2)),this.pushToEvents(b)},update:function(a){var b;this.state="pinchupdate",a.changedTouches[0].identifier==this.events[0].touches[0].identifier&&a.changedTouches[1].identifier==this.events[0].touches[1].identifier&&(b=Math.sqrt(Math.pow(a.changedTouches[0].clientX-a.changedTouches[1].clientX,2)+Math.pow(a.changedTouches[0].clientY-a.changedTouches[1].clientY,2)),this.previousScale=this.scale,this.scale=b/this._initialDistance,this.curScale=this.scale/this.previousScale,this.x=a.changedTouches[0].clientX+(a.changedTouches[1].clientX-a.changedTouches[0].clientX)/2,this.y=a.changedTouches[0].clientY+(a.changedTouches[1].clientY-a.changedTouches[0].clientY)/2,this.pushToEvents(a))}})),b.Event.Custom.touchpinch.handler={add:function(){this.jAddEvent("touchstart",b.Event.Custom.touchpinch.handler.handleTouchStart,1),this.jAddEvent("touchend",b.Event.Custom.touchpinch.handler.handleTouchEnd,1),this.jAddEvent("touchmove",b.Event.Custom.touchpinch.handler.handleTouchMove,1)},jRemove:function(){this.jRemoveEvent("touchstart",b.Event.Custom.touchpinch.handler.handleTouchStart),this.jRemoveEvent("touchend",b.Event.Custom.touchpinch.handler.handleTouchEnd),this.jRemoveEvent("touchmove",b.Event.Custom.touchpinch.handler.handleTouchMove)},handleTouchStart:function(a){var c;2==a.touches.length&&(a.stopDefaults(),c=new b.Event.Custom.touchpinch(this,a),this.jStore("event:touchpinch:event",c))},handleTouchEnd:function(a){var b;b=this.jFetch("event:touchpinch:event"),b&&(a.stopDefaults(),this.jDel("event:touchpinch:event"))},handleTouchMove:function(a){var b;b=this.jFetch("event:touchpinch:event"),b&&(a.stopDefaults(),b.update(a),this.jCallEvent("touchpinch",b))}},function(a){function e(){c=null}function f(b,c){return b>50||1===c&&!("win"==a.browser.platform&&b<1)||0===b%12||0==b%4.000244140625}a.$;a.Event.Custom.mousescroll=new a.Class(a.extend(a.Event.Custom,{type:"mousescroll",init:function(a,b,c,d,e,f,g){var h=b.jGetPageXY();this.x=h.x,this.y=h.y,this.timeStamp=b.timeStamp,this.target=a,this.delta=c||0,this.deltaX=d||0,this.deltaY=e||0,this.deltaZ=f||0,this.deltaFactor=g||0,this.deltaMode=b.deltaMode||0,this.isMouse=!1,this.pushToEvents(b)}}));var c,d;a.Event.Custom.mousescroll.handler={eventType:"onwheel"in document||a.browser.ieMode>8?"wheel":"mousewheel",add:function(){this.jAddEvent(a.Event.Custom.mousescroll.handler.eventType,a.Event.Custom.mousescroll.handler.handle,1)},jRemove:function(){this.jRemoveEvent(a.Event.Custom.mousescroll.handler.eventType,a.Event.Custom.mousescroll.handler.handle,1)},handle:function(b){var k,l,g=0,h=0,i=0,j=0;b.detail&&(i=b.detail*-1),void 0!==b.wheelDelta&&(i=b.wheelDelta),void 0!==b.wheelDeltaY&&(i=b.wheelDeltaY),void 0!==b.wheelDeltaX&&(h=b.wheelDeltaX*-1),b.deltaY&&(i=-1*b.deltaY),b.deltaX&&(h=b.deltaX),0===i&&0===h||(g=0===i?h:i,j=Math.max(Math.abs(i),Math.abs(h)),(!c||j<c)&&(c=j),k=g>0?"floor":"ceil",g=Math[k](g/c),h=Math[k](h/c),i=Math[k](i/c),d&&clearTimeout(d),d=setTimeout(e,200),l=new a.Event.Custom.mousescroll(this,b,g,h,i,0,c),l.isMouse=f(c,b.deltaMode||0),this.jCallEvent("mousescroll",l))}}}(a),b.win=b.$(window),b.doc=b.$(document),a}(),function(b){if(!b)throw"MagicJS not found";var c=b.$,d=window.URL||window.webkitURL||null;a.ImageLoader=new b.Class({img:null,ready:!1,options:{onprogress:b.$F,onload:b.$F,onabort:b.$F,onerror:b.$F,oncomplete:b.$F,onxhrerror:b.$F,xhr:!1,progressiveLoad:!0},size:null,_timer:null,loadedBytes:0,_handlers:{onprogress:function(a){a.target&&(200===a.target.status||304===a.target.status)&&a.lengthComputable&&(this.options.onprogress.jBind(null,(a.loaded-(this.options.progressiveLoad?this.loadedBytes:0))/a.total).jDelay(1),this.loadedBytes=a.loaded)},onload:function(a){a&&c(a).stop(),this._unbind(),this.ready||(this.ready=!0,this._cleanup(),!this.options.xhr&&this.options.onprogress.jBind(null,1).jDelay(1),this.options.onload.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1))},onabort:function(a){a&&c(a).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onabort.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)},onerror:function(a){a&&c(a).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onerror.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)}},_bind:function(){c(["load","abort","error"]).jEach(function(a){this.img.jAddEvent(a,this._handlers["on"+a].jBindAsEvent(this).jDefer(1))},this)},_unbind:function(){if(this._timer){try{clearTimeout(this._timer)}catch(a){}this._timer=null}c(["load","abort","error"]).jEach(function(a){this.img.jRemoveEvent(a)},this)},_cleanup:function(){if(this.jGetSize(),this.img.jFetch("new")){var a=this.img.parentNode;this.img.jRemove().jDel("new").jSetCss({position:"static",top:"auto"}),a.kill()}},loadBlob:function(a){var f,e=new XMLHttpRequest;c(["abort","progress"]).jEach(function(a){e["on"+a]=c(function(b){this._handlers["on"+a].call(this,b)}).jBind(this)},this),e.onerror=c(function(){this.options.onxhrerror.jBind(null,this).jDelay(1),this.options.xhr=!1,this._bind(),this.img.src=a}).jBind(this),e.onload=c(function(){return 200!==e.status&&304!==e.status?void this._handlers.onerror.call(this):(f=e.response,this._bind(),void(!d||b.browser.trident||"ios"===b.browser.platform&&b.browser.version<537?this.img.src=a:this.img.setAttribute("src",d.createObjectURL(f))))}).jBind(this),e.open("GET",a),e.responseType="blob",e.send()},init:function(a,d){if(this.options=b.extend(this.options,d),this.img=c(a)||b.$new("img",{},{"max-width":"none","max-height":"none"}).jAppendTo(b.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e4,width:10,height:10,overflow:"hidden"}).jAppendTo(document.body)).jStore("new",!0),b.browser.features.xhr2&&this.options.xhr&&"string"==b.jTypeOf(a))return void this.loadBlob(a);var e=function(){this.isReady()?this._handlers.onload.call(this):this._handlers.onerror.call(this),e=null}.jBind(this);this._bind(),"string"==b.jTypeOf(a)?this.img.src=a:(b.browser.trident&&5==b.browser.version&&b.browser.ieMode<9&&(this.img.onreadystatechange=function(){/loaded|complete/.test(this.img.readyState)&&(this.img.onreadystatechange=null,e&&e())}.jBind(this)),this.img.src=a.getAttribute("src")),this.img&&this.img.complete&&e&&(this._timer=e.jDelay(100))},destroy:function(){return this._unbind(),this._cleanup(),this.ready=!1,this},isReady:function(){var a=this.img;return a.naturalWidth?a.naturalWidth>0:a.readyState?"complete"==a.readyState:a.width>0},jGetSize:function(){return this.size||(this.size={width:this.img.naturalWidth||this.img.width,height:this.img.naturalHeight||this.img.height})}})}(a),function(a){if(!a)throw"MagicJS not found";if(!a.FX){var b=a.$;a.FX=new a.Class({init:function(b,c){var d;this.el=a.$(b),this.options=a.extend(this.options,c),this.timer=!1,this.easeFn=this.cubicBezierAtTime,d=a.FX.Transition[this.options.transition]||this.options.transition,"function"===a.jTypeOf(d)?this.easeFn=d:this.cubicBezier=this.parseCubicBezier(d)||this.parseCubicBezier("ease"),"string"==a.jTypeOf(this.options.cycles)&&(this.options.cycles="infinite"===this.options.cycles?1/0:parseInt(this.options.cycles)||1)},options:{fps:60,duration:600,transition:"ease",cycles:1,direction:"normal",onStart:a.$F,onComplete:a.$F,onBeforeRender:a.$F,onAfterRender:a.$F,forceAnimation:!1,roundCss:!1},styles:null,cubicBezier:null,easeFn:null,setTransition:function(b){this.options.transition=b,b=a.FX.Transition[this.options.transition]||this.options.transition,"function"===a.jTypeOf(b)?this.easeFn=b:(this.easeFn=this.cubicBezierAtTime,this.cubicBezier=this.parseCubicBezier(b)||this.parseCubicBezier("ease"))},start:function(b){var d,c=/\%$/;this.styles=b,this.cycle=0,this.state=0,this.curFrame=0,this.pStyles={},this.alternate="alternate"===this.options.direction||"alternate-reverse"===this.options.direction,this.continuous="continuous"===this.options.direction||"continuous-reverse"===this.options.direction;for(d in this.styles)c.test(this.styles[d][0])&&(this.pStyles[d]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles[d].reverse();return this.startTime=a.now(),this.finishTime=this.startTime+this.options.duration,this.options.onStart.call(),0===this.options.duration?(this.render(1),this.options.onComplete.call()):(this.loopBind=this.loop.jBind(this),!this.options.forceAnimation&&a.browser.features.requestAnimationFrame?this.timer=a.browser.requestAnimationFrame.call(window,this.loopBind):this.timer=this.loopBind.interval(Math.round(1e3/this.options.fps))),this},stopAnimation:function(){this.timer&&(!this.options.forceAnimation&&a.browser.features.requestAnimationFrame&&a.browser.cancelAnimationFrame?a.browser.cancelAnimationFrame.call(window,this.timer):clearInterval(this.timer),this.timer=!1)},stop:function(b){return b=!!a.defined(b)&&b,this.stopAnimation(),b&&(this.render(1),this.options.onComplete.jDelay(10)),this},calc:function(a,b,c){return a=parseFloat(a),b=parseFloat(b),(b-a)*c+a},loop:function(){var b=a.now(),c=(b-this.startTime)/this.options.duration,d=Math.floor(c);if(b>=this.finishTime&&d>=this.options.cycles)return this.stopAnimation(),this.render(1),this.options.onComplete.jDelay(10),this;if(this.alternate&&this.cycle<d)for(var e in this.styles)this.styles[e].reverse();this.cycle=d,!this.options.forceAnimation&&a.browser.features.requestAnimationFrame&&(this.timer=a.browser.requestAnimationFrame.call(window,this.loopBind)),this.render((this.continuous?d:0)+this.easeFn(c%1))},render:function(a){var b={};for(var d in this.styles)"opacity"===d?b[d]=Math.round(100*this.calc(this.styles[d][0],this.styles[d][1],a))/100:(b[d]=this.calc(this.styles[d][0],this.styles[d][1],a),this.pStyles[d]&&(b[d]+="%"));this.options.onBeforeRender(b,this.el),this.set(b),this.options.onAfterRender(b,this.el)},set:function(a){return this.el.jSetCss(a)},parseCubicBezier:function(c){var d,e=null;if("string"!==a.jTypeOf(c))return null;switch(c){case"linear":e=b([0,0,1,1]);break;case"ease":e=b([.25,.1,.25,1]);break;case"ease-in":e=b([.42,0,1,1]);break;case"ease-out":e=b([0,0,.58,1]);break;case"ease-in-out":e=b([.42,0,.58,1]);break;case"easeInSine":e=b([.47,0,.745,.715]);break;case"easeOutSine":e=b([.39,.575,.565,1]);break;case"easeInOutSine":e=b([.445,.05,.55,.95]);break;case"easeInQuad":e=b([.55,.085,.68,.53]);break;case"easeOutQuad":e=b([.25,.46,.45,.94]);break;case"easeInOutQuad":e=b([.455,.03,.515,.955]);break;case"easeInCubic":e=b([.55,.055,.675,.19]);break;case"easeOutCubic":e=b([.215,.61,.355,1]);break;case"easeInOutCubic":e=b([.645,.045,.355,1]);break;case"easeInQuart":e=b([.895,.03,.685,.22]);break;case"easeOutQuart":e=b([.165,.84,.44,1]);break;case"easeInOutQuart":e=b([.77,0,.175,1]);break;case"easeInQuint":e=b([.755,.05,.855,.06]);break;case"easeOutQuint":e=b([.23,1,.32,1]);break;case"easeInOutQuint":e=b([.86,0,.07,1]);break;case"easeInExpo":e=b([.95,.05,.795,.035]);break;case"easeOutExpo":e=b([.19,1,.22,1]);break;case"easeInOutExpo":e=b([1,0,0,1]);break;case"easeInCirc":e=b([.6,.04,.98,.335]);break;case"easeOutCirc":e=b([.075,.82,.165,1]);break;case"easeInOutCirc":e=b([.785,.135,.15,.86]);break;case"easeInBack":e=b([.6,-.28,.735,.045]);break;case"easeOutBack":e=b([.175,.885,.32,1.275]);break;case"easeInOutBack":e=b([.68,-.55,.265,1.55]);break;default:if(c=c.replace(/\s/g,""),c.match(/^cubic-bezier\((?:-?[0-9\.]{0,}[0-9]{1,},){3}(?:-?[0-9\.]{0,}[0-9]{1,})\)$/))for(e=c.replace(/^cubic-bezier\s*\(|\)$/g,"").split(","),d=e.length-1;d>=0;d--)e[d]=parseFloat(e[d])}return b(e)},cubicBezierAtTime:function(a){function i(a){return((b*a+c)*a+d)*a}function j(a){return((e*a+f)*a+g)*a}function k(a){return(3*b*a+2*c)*a+d}function l(a){return 1/(200*a)}function m(a,b){return j(n(a,b))}function n(a,b){function j(a){return a>=0?a:0-a}var c,d,e,f,g,h;for(e=a,h=0;h<8;h++){if(f=i(e)-a,j(f)<b)return e;if(g=k(e),j(g)<1e-6)break;e-=f/g}if(c=0,d=1,e=a,e<c)return c;if(e>d)return d;for(;c<d;){if(f=i(e),j(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e}var b=0,c=0,d=0,e=0,f=0,g=0,h=this.options.duration;return d=3*this.cubicBezier[0],c=3*(this.cubicBezier[2]-this.cubicBezier[0])-d,b=1-d-c,g=3*this.cubicBezier[1],f=3*(this.cubicBezier[3]-this.cubicBezier[1])-g,e=1-g-f,m(a,l(h))}}),a.FX.Transition={linear:"linear",sineIn:"easeInSine",sineOut:"easeOutSine",expoIn:"easeInExpo",expoOut:"easeOutExpo",quadIn:"easeInQuad",quadOut:"easeOutQuad",cubicIn:"easeInCubic",cubicOut:"easeOutCubic",backIn:"easeInBack",backOut:"easeOutBack",elasticIn:function(a,b){return b=b||[],Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b[0]||1)/3)},elasticOut:function(b,c){return 1-a.FX.Transition.elasticIn(1-b,c)},bounceIn:function(a){for(var b=0,c=1;1;b+=c,c/=2)if(a>=(7-4*b)/11)return c*c-Math.pow((11-6*b-11*a)/4,2)},bounceOut:function(b){return 1-a.FX.Transition.bounceIn(1-b)},none:function(a){return 0}}}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.PFX){a.$;a.PFX=new a.Class(a.FX,{init:function(b,c){this.el_arr=b,this.options=a.extend(this.options,c),this.timer=!1,this.$parent.init()},start:function(a){var c,d,b=/\%$/,e=a.length;for(this.styles_arr=a,this.pStyles_arr=new Array(e),d=0;d<e;d++){this.pStyles_arr[d]={};for(c in a[d])b.test(a[d][c][0])&&(this.pStyles_arr[d][c]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles_arr[d][c].reverse()}return this.$parent.start([]),this},render:function(b){for(var c=0;c<this.el_arr.length;c++)this.el=a.$(this.el_arr[c]),this.styles=this.styles_arr[c],this.pStyles=this.pStyles_arr[c],this.$parent.render(b)}})}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.Tooltip){a.$;a.Tooltip=function(b,c){var d=this.tooltip=a.$new("div",null,{position:"absolute","z-index":999}).jAddClass("MagicToolboxTooltip");a.$(b).jAddEvent("mouseover",function(){d.jAppendTo(document.body)}),a.$(b).jAddEvent("mouseout",function(){d.jRemove()}),a.$(b).jAddEvent("mousemove",function(b){function i(a,b,c){return c<(a-b)/2?c:c>(a+b)/2?c-b:(a-b)/2}var c=20,e=a.$(b).jGetPageXY(),f=d.jGetSize(),g=a.$(window).jGetSize(),h=a.$(window).jGetScroll();d.jSetCss({left:h.x+i(g.width,f.width+2*c,e.x-h.x)+c,top:h.y+i(g.height,f.height+2*c,e.y-h.y)+c})}),this.text(c)},a.Tooltip.prototype.text=function(a){this.tooltip.firstChild&&this.tooltip.removeChild(this.tooltip.firstChild),this.tooltip.append(document.createTextNode(a))}}}(a),function(b){if(!b)throw"MagicJS not found";if(!b.MessageBox){b.$;b.Message=function(a,c,d,e){this.hideTimer=null,this.messageBox=b.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden",opacity:.8}).jAddClass(e||"").jAppendTo(d||document.body),this.setMessage(a),this.show(c)},b.Message.prototype.show=function(a){this.messageBox.show(),this.hideTimer=this.hide.jBind(this).jDelay(b.ifndef(a,5e3))},b.Message.prototype.hide=function(c){clearTimeout(this.hideTimer),this.hideTimer=null,this.messageBox&&!this.hideFX&&(this.hideFX=new a.FX(this.messageBox,{duration:b.ifndef(c,500),onComplete:function(){this.messageBox.kill(),delete this.messageBox,this.hideFX=null}.jBind(this)}).start({opacity:[this.messageBox.jGetCss("opacity"),0]}))},b.Message.prototype.setMessage=function(a){this.messageBox.firstChild&&this.tooltip.removeChild(this.messageBox.firstChild),this.messageBox.append(document.createTextNode(a))}}}(a),function(a){if(!a)throw"MagicJS not found";if(!a.Options){var b=a.$,c=null,d={boolean:1,array:2,number:3,function:4,string:100},e={boolean:function(d,e,f){if("boolean"!=a.jTypeOf(e)){if(f||"string"!=a.jTypeOf(e))return!1;if(!/^(true|false)$/.test(e))return!1;e=e.jToBool()}return!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(c=e,!0)},string:function(d,e,f){return"string"===a.jTypeOf(e)&&(!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(c=""+e,!0))},number:function(d,e,f){var h=/%$/,i="string"==a.jTypeOf(e)&&h.test(e);return(!f||0!=typeof e)&&(e=parseFloat(e),!isNaN(e)&&(isNaN(d.minimum)&&(d.minimum=Number.NEGATIVE_INFINITY),isNaN(d.maximum)&&(d.maximum=Number.POSITIVE_INFINITY),!(d.hasOwnProperty("enum")&&!b(d.enum).contains(e))&&(!(d.minimum>e||e>d.maximum)&&(c=i?e+"%":e,!0))))},array:function(b,d,e){if("string"===a.jTypeOf(d))try{d=window.JSON.parse(d)}catch(a){return!1}return"array"===a.jTypeOf(d)&&(c=d,!0)},function:function(b,d,e){return"function"===a.jTypeOf(d)&&(c=d,!0)}},f=function(b,c,d){var f;if(f=b.hasOwnProperty("oneOf")?b.oneOf:[b],"array"!=a.jTypeOf(f))return!1;for(var g=0,h=f.length-1;g<=h;g++)if(e[f[g].type](f[g],c,d))return!0;return!1},g=function(a){var b,c,f,g;if(a.hasOwnProperty("oneOf"))for(f=a.oneOf.length,b=0;b<f;b++)for(c=b+1;c<f;c++)d[a.oneOf[b].type]>d[a.oneOf[c].type]&&(g=a.oneOf[b],a.oneOf[b]=a.oneOf[c],a.oneOf[c]=g);return a},h=function(b){var c;if(c=b.hasOwnProperty("oneOf")?b.oneOf:[b],"array"!=a.jTypeOf(c))return!1;for(var g=c.length-1;g>=0;g--){if(!c[g].type||!d.hasOwnProperty(c[g].type))return!1;if(a.defined(c[g].enum)){if("array"!==a.jTypeOf(c[g].enum))return!1;for(var h=c[g].enum.length-1;h>=0;h--)if(!e[c[g].type]({type:c[g].type},c[g].enum[h],!0))return!1}}return!(b.hasOwnProperty("default")&&!f(b,b.default,!0))},i=function(a){this.schema={},this.options={},this.parseSchema(a)};a.extend(i.prototype,{parseSchema:function(a){var b,c;for(b in a)if(a.hasOwnProperty(b)&&(c=(b+"").jTrim().jCamelize(),!this.schema.hasOwnProperty(c))){if(this.schema[c]=g(a[b]),!h(this.schema[c]))throw"Incorrect definition of the '"+b+"' parameter in "+a;this.options[c]=void 0}},set:function(b,d){b=(b+"").jTrim().jCamelize(),"string"==a.jTypeOf(d)&&(d=d.jTrim()),this.schema.hasOwnProperty(b)&&(c=d,f(this.schema[b],d)&&(this.options[b]=c),c=null)},get:function(b){if(b=(b+"").jTrim().jCamelize(),this.schema.hasOwnProperty(b))return a.defined(this.options[b])?this.options[b]:this.schema[b].default},fromJSON:function(a){for(var b in a)this.set(b,a[b])},getJSON:function(){var b=a.extend({},this.options);for(var c in b)void 0===b[c]&&void 0!==this.schema[c].default&&(b[c]=this.schema[c].default);return b},fromString:function(a){b(a.split(";")).jEach(b(function(a){a=a.split(":"),this.set(a.shift().jTrim(),a.join(":"))}).jBind(this))},exists:function(a){return a=(a+"").jTrim().jCamelize(),this.schema.hasOwnProperty(a)},isset:function(b){return b=(b+"").jTrim().jCamelize(),this.exists(b)&&a.defined(this.options[b])},jRemove:function(a){a=(a+"").jTrim().jCamelize(),this.exists(a)&&(delete this.options[a],delete this.schema[a])}}),a.Options=i}}(a),b.$AA=function(a){var d,c=[];for(d in a)a.hasOwnProperty(d)&&"$J"!=(d+"").substring(0,2)&&c.push(a[d]);return b.$A(c)},b.nativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:1,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1},b.customEventsAllowed={document:!0,element:!0,class:!0,object:!0},b.customEvents={bindEvent:function(a,c,d){if("array"==b.jTypeOf(a))return g(a).jEach(this.bindEvent.jBindAsEvent(this,c,d)),this;if(!a||!c||"string"!=b.jTypeOf(a)||"function"!=b.jTypeOf(c))return this;if("domready"==a&&b.browser.ready)return c.call(this),this;d=parseInt(d||10),c.$J_EUID||(c.$J_EUID=Math.floor(Math.random()*b.now()));var e=this.jFetch("_events",{});if(e[a]||(e[a]={}),e[a][d]||(e[a][d]={}),e[a].orders||(e[a].orders={}),e[a][d][c.$J_EUID])return this;e[a].orders[c.$J_EUID]&&this.unbindEvent(a,c);var f=this,h=function(a){return c.call(f,g(a))};return b.nativeEvents[a]&&!e[a].function&&(2==b.nativeEvents[a]&&(h=function(a){return a=b.extend(a||window.e,{$J_TYPE:"event"}),c.call(f,g(a))}),e[a].function=function(b){f.jCallEvent(a,b)},this[b._event_add_](b._event_prefix_+a,e[a].function,!1)),e[a][d][c.$J_EUID]=h,e[a].orders[c.$J_EUID]=d,this},jCallEvent:function(a,c){try{c=b.extend(c||{},{type:a})}catch(a){}if(!a||"string"!=b.jTypeOf(a))return this;var d=this.jFetch("_events",{});return d[a]||(d[a]={}),d[a].orders||(d[a].orders={}),b.$AA(d[a]).jEach(function(c){c!=d[a].orders&&c!=d[a].function&&b.$AA(c).jEach(function(a){a(this)},this)},c),this},unbindEvent:function(a,c){if(!a||!c||"string"!=b.jTypeOf(a)||"function"!=b.jTypeOf(c))return this;c.$J_EUID||(c.$J_EUID=Math.floor(Math.random()*b.now()));var d=this.jFetch("_events",{});if(d[a]||(d[a]={}),d[a].orders||(d[a].orders={}),order=d[a].orders[c.$J_EUID],d[a][order]||(d[a][order]={}),order>=0&&d[a][order][c.$J_EUID]&&(delete d[a][order][c.$J_EUID],delete d[a].orders[c.$J_EUID],0==b.$AA(d[a][order]).length&&(delete d[a][order],b.nativeEvents[a]&&0==b.$AA(d[a]).length))){this[b._event_del_](b._event_prefix_+a,d[a].function,!1)}return this},destroyEvent:function(a){if(!a||"string"!=b.jTypeOf(a))return this;var c=this.jFetch("_events",{});if(b.nativeEvents[a]){this[b._event_del_](b._event_prefix_+a,c[a].function,!1)}return c[a]={},this},cloneEvents:function(a,b){var c=this.jFetch("_events",{});for(t in c)if(!b||t==b)for(order in c[t])if("orders"!=order&&"function"!=order)for(f in c[t][order])g(a).bindEvent(t,c[t][order][f],order);return this},jCopyEvents:function(a,b){if(1!==a.nodeType)return this;var c=this.jFetch("events");if(!c)return this;for(var d in c)if(!b||d==b)for(var e in c[d])g(a).bindEvent(d,c[d][e]);return this},jFetch:b.Element.jFetch,jStore:b.Element.jStore},function(a){if(!a)throw"MagicJS not found";a.extend=function(b,c){b instanceof window.Array||(b=[b]),c instanceof window.Array||(c=[c]);for(var d=0,e=b.length;d<e;d++)if(a.defined(b[d]))for(var f=0,g=c.length;f<g;f++)if(a.defined(c[f]))for(var h in c[f]||{})try{b[d][h]=c[f][h]}catch(a){}return b[0]},a.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.$parent=b.prototype,a.prototype=new c,a.prototype.constructor=a},a.extend([a.Element,window.magicJS.Element],{jGetSize_:a.Element.jGetSize,jGetSize:function(a,b){var c,d={width:0,height:0};return b?d=this.jGetSize_():(c=this.getBoundingClientRect(),d.width=c.width,d.height=c.height),a&&(d.width+=parseInt(this.jGetCss("margin-left")||0)+parseInt(this.jGetCss("margin-right")||0),d.height+=parseInt(this.jGetCss("margin-top")||0)+("block"!=this.jGetCss("display")?parseInt(this.jGetCss("margin-bottom")||0):0)),d}})}(a),b.Modules||(b.Modules={}),b.Modules.ArrowsPair=function(){function e(a,d){return b.$new("button",{type:"button"},{display:"inline-block"}).jAddClass(c.class).jAddClass(c.orientation).jAddClass(c.class+"-arrow").jAddClass(c.class+"-arrow-"+a).jAppendTo(d)}function f(a,b){b.stopDistribution(),this.jCallEvent(a)}var c,a=["next","prev"],g=function(a,d){b.$uuid(this),this.options={class:"",classHidden:"",classDisabled:"",position:"inside",orientation:"ms-horizontal",form:"button"},c=this.o=this.options,b.extend(this.o,a),this.prev=e("prev",d),this.next=e("next",d),this.next.jAddEvent("click",function(a){a.stop()}).jAddEvent("btnclick tap",f.jBind(this,"forward")),this.prev.jAddEvent("click",function(a){a.stop()}).jAddEvent("btnclick tap",f.jBind(this,"backward"))};return g.prototype={disable:function(b){d(b&&[b]||a).jEach(function(a){this[a].jAddClass(c.classDisabled)},this)},enable:function(b){d(b&&[b]||a).jEach(function(a){this[a].jRemoveClass(c.classDisabled)},this)},hide:function(b){d(b&&[b]||a).jEach(function(a){this[a].jAddClass(c.classHidden)},this)},show:function(b){d(b&&[b]||a).jEach(function(a){this[a].jRemoveClass(c.classHidden)},this)},jRemove:function(b){d(b&&[b]||a).jEach(function(a){this[a].kill()},this)},setOrientation:function(b){d(a).jEach(function(a){this[a].jRemoveClass("mcs-"+c.orientation),this[a].jAddClass("mcs-"+b)},this),this.o.orientation="mcs-"+b}},b.extend(g.prototype,b.customEvents),g}(),b.Modules||(b.Modules={}),b.Modules.Bullets=function(){var a="active",c=function(a,c,d){b.$uuid(this),this._options={},this.o=this._options,b.extend(this.o,a),this.bullets=b.$([]),this.callback=d,this.activeBullet={},this.ban=!1,this.container=b.$new("div",{class:"mcs-bullets"}),this.container.jAppendTo(c)};return c.prototype={push:function(a){var c=d(function(a){var c=this.bullets.length;this.bullets.push({index:c,enable:!1,jump:a,node:b.$new("div",{class:"mcs-bullet mcs-bullet-"+c})}),c||(this.activeBullet=this.bullets[c],this.activate(this.bullets[c]),this.bullets[c].enable=!0),this.bullets[c].node.jAddEvent("click",d(function(a){a.stop(),this.bullets[c].index!=this.activeBullet.index&&(this.ban=this.callback(),!this.ban&&this.jCallEvent("bullets-click",{direction:this.getDirection(this.bullets[c]),jumpIndex:this.bullets[c].jump}))}).jBind(this)),this.bullets[c].node.jAppendTo(this.container)}).jBind(this);this.reset(),a.jEach(d(function(a){c(a)}).jBind(this))},setActiveBullet:function(a,b){this.activeBullet.index!=a[0]&&this.activate(this.getBulletIndex(a,b))},show:function(){this.container.jAddClass("show")},update:function(){this.activeBullet.node&&(this.deactivate(),this.activate(this.bullets[0]))},jRemove:function(){this.bullets.jEach(function(a){a.node.kill()}),this.container.kill()},deactivate:function(){this.activeBullet.enable=!1,this.activeBullet.node.jRemoveClass(a)},activate:function(b){this.deactivate(),this.activeBullet=b,b.enable=!0,b.node.jAddClass(a)},getDirection:function(a){
var b=this.activeBullet.index>a.index?"backward":"forward";return this.activate(a),b},getBulletIndex:function(a,b){for(var c,d=this.bullets.length-1,e=this.activeBullet,c=d;c>=0;c--)if(this.bullets[c].jump<=a[0]){e=this.bullets[c];break}return b&&this.o.items-1==a[a.length-1]&&(e=this.bullets[d]),e},reset:function(){this.ban=!1,this.activeBullet={},this.bullets.jEach(function(a){a.node.kill()}),this.bullets.length=0}},b.extend(c.prototype,b.customEvents),c}(),b.Modules||(b.Modules={}),b.Modules.Progress=function(){var c=function(a,c){this.flag="none",this.node=b.$new("div",{class:"mcs-loader"}),b.browser.ieMode&&b.browser.ieMode<10?this.node.append(b.$new("div",{class:"mcs-loader-text"}).append(b.doc.createTextNode("Loading..."))):c?this.node.append(b.$new("div",{class:"mcs-loader-circles"}).append(b.$new("div",{class:"mcs-item-loader"},{"z-index":1e5}))):this.node.append(b.$new("div",{class:"mcs-loader-circles"}).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_01"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_02"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_03"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_04"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_05"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_06"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_07"})).append(b.$new("div",{class:"mcs-loader-circle mcs-loader-circle_08"}))),this.node.jAppendTo(a),this.node.hide()};return c.prototype={show:function(){"show"!==this.flag&&this.node&&(this.flag="show",this.node.jSetOpacity(1),this.node.show())},hide:function(a){"hide"!==this.flag&&this.node&&(this.flag="hide",this.node.jSetOpacity(0),this.node.hide())},jRemove:function(){this.node&&this.node.kill()}},c}(),b.Modules||(b.Modules={}),b.Modules.ShowItems=function(){var a=function(){function i(){var b;if(0==a.length)return void h.jCallEvent("complete");if(!g&&a.length>0){g=!0,b=a.shift();var c=d([]);c.push(b.item),b.item.clone&&b.item.clone.length>0&&d(b.item.clone).jEach(d(function(a){c.push(a)}).jBind(this)),c.jEach(function(a,c){f+=1,b.visible&&c&&(b.visible=!1),k(a,!!c,b.visible,b.callback,function(){g=!1,i()},b.showReflection)})}}function j(a,b,c,d){a.progress&&a.progress.hide(!0),e++,e==f&&(f=e=0,c(),d())}function k(a,e,f,g,h,i){var k,l,m=d(a.content);return"loaded"==a.load?void j(a,e,g,h):void(f?b.browser.ieMode&&b.browser.ieMode<10?(l=d(m).jGetSize(),k={opacity:[0,1],top:[l.height/2,0],left:[l.width/2,0],width:[0,l.width],height:[0,l.height]},this.itemFX=new b.FX(m,{duration:c,onComplete:d(function(b,c){m.jSetCss({overflow:"",position:"",top:"",left:"",width:"",height:""}),e&&(a.load="loaded"),j(a,e,b,c)}).jBind(this,g,h),onStart:d(function(){m.jSetCss({position:"relative",overflow:"hidden"})}).jBind(this)}),this.itemFX.start(k)):(m.jSetCssProp(p,"scale(0.2, 0.2)"),m.jSetCssProp("transition","none"),m.jSetOpacity(0),m.offsetHeight,m.parentNode.offsetHeight,m.jAddEvent("transitionend",d(function(a){a.target==m&&(this.jRemoveEvent(a.type),this.jSetCssProp(p,""),this.jSetCssProp("transition",""))}).jBind(m)),!e&&i&&i(a),m.jSetCssProp("transition",p+" "+c+"ms cubic-bezier(.5,.5,.69,1.9), opacity "+c+"ms linear"),m.offsetHeight,m.parentNode.offsetHeight,m.jSetCssProp(p,"scale(1.0, 1.0)"),m.jSetOpacity(1),e&&(a.load="loaded"),j(a,e,g,h)):(m.jSetOpacity(1),e?a.load="loaded":i(a),j(a,e,g,h)))}var a=[],c=300,e=0,f=0,g=!1,h=this;b.$uuid(this),this.push=function(b,c,d,e){a.push({item:b,visible:c,callback:d,showReflection:e}),i()}};return b.extend(a.prototype,b.customEvents),a}(),function(a){a.QImageLoader=function(b,c){function i(b){return function(d){(c[b]||a.$F).call(f,d,d.origItem),e--,j()}}function j(){var k;b.length&&e<(c.queue||3)&&(g=b.shift(),k=l(g.node),k?(h=new a.ImageLoader(k,{onload:i("onload"),onerror:i("onerror"),onabort:i("onabort"),oncomplete:i("oncomplete")}),h.origItem=g):((c.onload||a.$F).call(f,{size:d(g.node).jGetSize(),img:k},g),e--,j()),e++)}function k(a){var b,c;return b=a&&a instanceof HTMLImageElement,b&&(c=a.getAttribute("data-src")||null,c&&a.setAttribute("src",c)),b&&a.getAttribute("src")?a:null}function l(b){return"string"==a.jTypeOf(g)?b:"object"==a.jTypeOf(b)?k(b.img):"A"==b.tagName||"figure"==b.tagName.toLowerCase()?k(d(b).byTag("IMG")[0]||b.firstChild):"IMG"==b.tagName?k(b):null}var g,h,e=0,f=this;this.push=function(a,d){return b[d?"unshift":"push"](a),c.delay||j(),this},this.abort=function(){h.destroy(),count--},this.load=j,c.delay||b.length&&j()}}(a);var c,h,d=b.$,g=d,i=function(){return"mgctlbxN$MSC mgctlbxV$"+"v2.0.15".replace("v","")+" mgctlbxL$"+"c".toUpperCase()+(window.mgctlbx$Pltm&&"string"==b.jTypeOf(window.mgctlbx$Pltm)?" mgctlbxP$"+window.mgctlbx$Pltm.toLowerCase():"")};b.Scroll={},c={width:{oneOf:[{type:"number",minimum:1},{type:"string",enum:["auto"]}],default:"auto"},height:{oneOf:[{type:"number",minimum:1},{type:"string",enum:["auto"]}],default:"auto"},items:{oneOf:[{type:"number",minimum:1},{type:"array"},{type:"string",enum:["auto","fit"]}],default:"auto"},scrollOnWheel:{oneOf:[{type:"boolean"},{type:"string",enum:["auto"]}],default:"auto"},arrows:{oneOf:[{type:"boolean"},{type:"string",enum:["inside","outside","off"]}],default:"outside"},autoplay:{type:"number",default:0},speed:{type:"number",default:600},loop:{oneOf:[{type:"string",enum:["infinite","rewind","off"]},{type:"boolean",enum:[!1]}],default:"infinite"},lazyLoad:{type:"boolean",default:!1},orientation:{type:"string",enum:["horizontal","vertical"],default:"horizontal"},step:{oneOf:[{type:"number",minimum:0},{type:"string",enum:["auto"]}],default:"auto"},draggable:{type:"boolean",default:!0},mode:{type:"string",enum:["scroll","animation","carousel","cover-flow"],default:"scroll"},pagination:{type:"boolean",default:!1},easing:{type:"string",default:"cubic-bezier(.8, 0, .5, 1)"},keyboard:{type:"boolean",default:!1},autostart:{type:"boolean",default:!0},onItemHover:{type:"function",default:b.$F},onItemOut:{type:"function",default:b.$F},onReady:{type:"function",default:b.$F},onStop:{type:"function",default:b.$F},onMoveStart:{type:"function",default:b.$F},onMoveEnd:{type:"function",default:b.$F}},document.createElement("figure"),document.createElement("figcaption");var k=function(a){return{width:(parseInt(a.jGetCss("margin-left"))||0)+(parseInt(a.jGetCss("margin-right"))||0),height:(parseInt(a.jGetCss("margin-top"))||0)+(parseInt(a.jGetCss("margin-bottom"))||0)}},l=function(a){return{width:(parseInt(a.jGetCss("padding-left"))||0)+(parseInt(a.jGetCss("padding-right"))||0),height:(parseInt(a.jGetCss("padding-top"))||0)+(parseInt(a.jGetCss("padding-bottom"))||0)}},m=function(a){return{width:(parseInt(a.jGetCss("border-left-width"))||0)+(parseInt(a.jGetCss("border-right-width"))||0),height:(parseInt(a.jGetCss("border-top-width"))||0)+(parseInt(a.jGetCss("border-bottom-width"))||0)}},n=function(a){return{width:d(a).jGetCss("width"),height:d(a).jGetCss("height")}},o=b.browser.domPrefix,p=b.normalizeCSS("transform").dashize(),q=function(a,c){var f=0;b.$uuid(this),this._options={stopDownload:!0,timingFunction:"cubic-bezier(.8, 0, .5, 1)",effect:"scroll",continuous:!1,progress:!1,debug:!1,orientation:"horizontal",duration:500,loop:!0,lazyLoad:!0,step:"auto",draggable:!0,keyboard:!1},this.o=this._options,b.extend(this.o,c),this.container=d(a).jSetCssProp("white-space","nowrap"),this.loop={firstItem:!1,lastItem:!1},this._setProperties(),this.keyboardCallback=d(function(a){var b={},c=!0;37!==a.keyCode&&39!==a.keyCode||(b.direction=39==a.keyCode?"forward":"backward",this.o.loop||("forward"===b.direction?this.loop.lastItem&&(c=!1):this.loop.firstItem&&(c=!1)),c&&this.jCallEvent("key_down",b))}).jBind(this),this.name="scroll",this.items=d([]),this.itemsFirstClones=d([]),this.itemsLastClones=d([]),this.exitItems=d([]),this.enterItems=d([]),this.last=0,this.globalIndex=0,this.itemStep=this.o.step,this.containerPosition=0,this.l=null,this.globalLength=null,this.distance=null,this.allSize=0,this.correctPosition=0,this.containerWidth=0,this.direction="forward",this.callback=b.$F,this.fullViewedItems=0,this.stopScroll=!1,this.moveTimer=null,this.wheelDiff=0,this.tempArray=null,this.prevIndex=this.last,this.wheel_=!1,this.preloadAllFlag=!1,this.disableReflection=!1,this.loadAll=!1,this.allNodes=null,this.doneFlag={},this.wrapperPosition=0,this.moveSettings={direction:"forward",disableEffect:!1},this.queue=new b.QImageLoader([],{queue:1,onerror:d(function(a,b){var c=this.items[b.index];c.load="error",c.progress&&(c.progress.jRemove(),c.progress=null),c.node.jAddClass("mcs-noimg"),this.performedOnClones(d(function(a,b){a.index==c.index&&(a.append=!0,a.progress&&(a.progress.jRemove(),a.progress=null),a.node.load="error",a.node.jAddClass("mcs-noimg"))}).jBind(this)),f++,this.o.lazyLoad?this.checkLoadingVisibleItems()&&(!this.o.stopDownload&&this.doneFlag.two||(this.jCallEvent("hideProgress"),this.jCallEvent("groupLoad")),this.move_||this.changeClones(),!this.doneFlag.two&&this.jCallEvent("complete")):f!=this.l||this.o.lazyLoad||(this.loadAll=!0,!this.doneFlag.two&&this.jCallEvent("complete")),this.checkLoadedItems()}).jBind(this),onload:function(a,b){var e=this.items[b.index];if(e){if(e.node.append(e.content),!this.o.lazyLoad&&!this.disableReflection)try{this.setReflection(e),this.setCanvasPosition(e)}catch(a){this.disableReflection=!0}this.addCloneContent(e,d(function(){var a=!0;d(["scroll","animation"]).contains(this.name)&&(this.doneFlag.two||this.o.lazyLoad||(a=b.index<this.fullViewedItems)),this.showItem(e,a,this.showReflection),e.load="loaded",f++,this.o.lazyLoad?this.onLazyLoad(f):f==this.l&&(this.loadAll=!0,!this.doneFlag.two&&this.jCallEvent("complete")),this.checkLoadedItems()}).jBind(this))}}.jBind(this)})};q.prototype={constructor:q,showReflection:b.$F,setCanvasPosition:b.$F,setReflection:b.$F,onLazyLoad:function(a){this.checkLoadingVisibleItems()&&(!this.o.stopDownload&&this.doneFlag.two||(this.jCallEvent("hideProgress"),this.jCallEvent("groupLoad")),this.doneFlag.two||this.jCallEvent("complete"))},showItem:function(a,c,e){var f,g,h,i=500,j=a.content;c?b.browser.ieMode&&b.browser.ieMode<10?(f=d(j).jGetSize(),g={opacity:[0,1],top:[f.height/2,0],left:[f.width/2,0],width:[0,f.width],height:[0,f.height]},h=new b.FX(j,{duration:i,onComplete:d(function(b,c){j.jSetCss({overflow:"",position:"",top:"",left:"",width:"",height:""}),a.progress&&(a.progress.jRemove(),a.progress=null)}).jBind(this),onStart:d(function(){j.jSetCss({position:"relative",overflow:"hidden"})}).jBind(this)}),h.start(g)):(j.jSetCssProp("transition","none"),j.jSetOpacity(0),j.offsetHeight,j.parentNode.offsetHeight,j.jAddEvent("transitionend",d(function(b){b.target==j&&(this.jRemoveEvent(b.type),this.jSetCssProp(p,""),this.jSetCssProp("transition",""),a.progress&&(a.progress.jRemove(),a.progress=null))}).jBind(j)),j.jSetCssProp("transition",p+" "+i+"ms cubic-bezier(.5,.5,.69,1.9), opacity "+i+"ms linear"),j.offsetHeight,j.parentNode.offsetHeight,j.jSetOpacity(1),e&&e(a)):(j.jSetOpacity(1),a.progress&&(a.progress.jRemove(),a.progress=null)),a.clone.length>0&&d(a.clone).jEach(d(function(a){a&&(d(a.content).jSetOpacity(1),a.load="loaded",a.progress&&(a.progress.jRemove(),a.progress=null))}).jBind(this))},checkLoadedItems:function(){var a=0;this.items.jEach(d(function(b){"loaded"!=b.load&&"error"!=b.load||a++,this.l==a&&(this.loadAll=!0,this.jCallEvent("hideProgress"))}).jBind(this))},checkLoadingVisibleItems:function(){var a=0,b=0;if(this.loadAll)return!0;for(;a<this.fullViewedItems;a++)"loaded"!=this.items[this._getItemIndex(this.last+a)].load&&"error"!=this.items[this._getItemIndex(this.last+a)].load||(b+=1);return b==this.fullViewedItems},_sWidth:function(){return this.container.parentNode.jGetSize()[this.p_.size]},_setProperties:function(){var a={horizontal:{size:"width",pos:"left",otherSize:"height"},vertical:{size:"height",pos:"top",otherSize:"width"}};this.p_=a[this.o.orientation],0==this.o.step&&(this.o.step="auto"),this.o.loop&&"rewind"!==this.o.loop||(this.loop.firstItem=!0),b.browser.ieMode&&b.browser.ieMode<10?this.container.jSetCssProp(this.p_.pos,0):this.container.jSetCssProp(p,"translate3d(0, 0, 0)")},_render:function(){this.container.offsetHeight},preloadAll:function(){this.loadAll||this.preloadAllFlag||(this.preloadAllFlag=!0,this.jCallEvent("showProgress"),this.items.jEach(d(function(a){"notLoaded"==a.load&&(a.progress&&(a.progress.jRemove(),a.progress=null),a.clone.length>0&&d(a.clone).jEach(function(a){a.progress&&(a.progress.jRemove(),a.progress=null)}),this.queue.push({node:a.content,index:a.index}))}).jBind(this)),this.loadAll=!0)},preloadItem:function(a){var b,f,g,c=this.last;d([]);if(!this.loadAll&&this.o.lazyLoad)for(a&&(c="forward"==a?this._getItemIndex(c+this.fullViewedItems):this._getItemIndex(c-this.fullViewedItems)),g=d(function(b){"notLoaded"==b.load&&(this.o.stopDownload?!a&&this.jCallEvent("showProgress"):b.progress&&b.progress.show(),b.load="load",this.queue.push({node:b.content,index:b.index}))}).jBind(this),b=0;b<this.fullViewedItems;b++)f=this.items[this._getItemIndex(c+b)],g(f),a||(g(this.items[this._getItemIndex(f.index+this.fullViewedItems)]),g(this.items[this._getItemIndex(f.index-this.fullViewedItems)]))},freeTouchPreload:function(a){var b,c,e,f,g=0,h=this.allNodes.length;if("backward"==a&&(g=h-1,h=-1),!this.loadAll)for(;g!=h;)f=this.allNodes[g],b=f.jGetPosition(),c=f.getAttribute("data-item"),b[this.p_.pos]+this.items[0].size[this.p_.size]>this.wrapperPosition[this.p_.pos]&&b[this.p_.pos]<this.wrapperPosition[this.p_.pos]+this.containerWidth&&(e=this.items[c],"notLoaded"==e.load&&(e.load="load",e.progress&&e.progress.show(),d(e.clone).jEach(d(function(a){a.progress&&a.progress.show()}).jBind(this)),this.queue.push({node:e.content,index:e.index}))),"forward"==a?g++:g--},done:function(a){var b,c,e,f;if(!this.doneFlag.one){for(this.doneFlag.one=!0,c=this.l=this.items.length,this.containerWidth=this._sWidth(),e=d(this.container.parentNode).jGetPosition(),b=0;b<this.l;b++)f=this.items[b],f.size=f.node.jGetSize(!0),this.allSize+=f.size[this.p_.size];this.onResize()}},done2:function(a){if(this.doneFlag.two=!0,this.setItemStep(),(!b.browser.ieMode||b.browser.ieMode&&b.browser.ieMode>9)&&this.o.draggable&&this._initDragOnScroll(),this.itemEvent(),(!b.browser.ieMode||b.browser.ieMode&&b.browser.ieMode>9)&&"scroll"===this.o.effect&&this.o.scrollOnWheel&&this._initOnWheel(),d(["scroll","animation"]).contains(this.name))for(var c=0;c<this.items.length;c++)c>=this.fullViewedItems&&this.items[c].progress&&this.items[c].progress.show();this.last=0,this.globalIndex=this.itemsFirstClones.length,d(window).jAddEvent("resize",this.onResize.jBind(this)),this.o.keyboard&&d(document).jAddEvent("keydown",this.keyboardCallback),this.onResize(),a&&a()},itemEvent:function(){this.items.jEach(d(function(a){a.content.showThis=d(function(){this.jCallEvent("show-this",{index:a.index})}).jBind(this),a.content.jAddEvent("click",d(function(a){this.move_&&a.stop()}).jBind(this))}).jBind(this))},setItemStep:function(a){var b,c=0;if(!this.stopScroll){if(this.o.continuous)return void(this.itemStep=this.fullViewedItems);for(b=0;b<this.l;b++)if(c+=this.items[b].size[this.p_.size],c>=this.containerWidth){("auto"==this.itemStep||this.itemStep>=b)&&(("animation"==this.o.effect&&c-this.items[b].size[this.p_.size]+5<this.containerWidth||c==this.containerWidth)&&(b+=1),this.itemStep=b,"auto"!=this.o.step&&this.o.step<this.itemStep&&(this.itemStep=this.o.step));break}!this.itemStep&&(this.itemStep=1)}},cloneFigure:function(a){var c=a.cloneNode();return figure=document.createElement("figure"),figcaption=document.createElement("figcaption"),b.$A(a.firstChild.childNodes).jEach(d(function(a){"figcaption"==a.tagName.toLowerCase()?(b.$A(a.childNodes).jEach(d(function(a){d(figcaption).append(a.cloneNode(!0))}).jBind(this)),b.$A(a.attributes).jEach(d(function(a){figure.setAttribute(a,a.nodeValue)}).jBind(this)),figure.append(figcaption)):d(figure).append(a.cloneNode(!0))}).jBind(this)),b.$A(a.firstChild.attributes).jEach(d(function(a){figure.setAttribute(a,a.nodeValue)}).jBind(this)),c.append(figure),c},performedOnClones:function(a){this.itemsFirstClones.length>0&&d([this.itemsFirstClones,this.itemsLastClones]).jEach(d(function(b){b.jEach(d(function(b,c){a(b,c)}).jBind(this))}).jBind(this))},addCloneContent:function(a,c){if(this.itemsFirstClones.length>0){var e=d(function(){var c;return c=b.browser.ieMode&&b.browser.ieMode<9&&"figure"==a.node.firstChild.tagName.toLowerCase()?this.cloneFigure(a.content.cloneNode(!0)):a.content.cloneNode(!0),c.childNodes&&b.$A(c.childNodes).jEach(d(function(a){d(a).jHasClass&&d(a).jHasClass("MagicScroll-progress-bar")&&a.kill()}).jBind(this)),c}).jBind(this);this.performedOnClones(d(function(b,c){b.index!=a.index||b.append||(b.content=e(),this.items[a.index].clone.push(b),b.append=!0,b.node.append(b.content))}).jBind(this))}c&&c()},_prepareClones:function(){var a,h,i,c=0,e=0,f=0,g={left:0,top:0};if(!this.stopScroll){for(a=0;a<this.l&&(c+=this.items[a].size[this.p_.size],f++,!(this.containerWidth<=c));a++);if(this.l>1&&(f>this.fullViewedItems||0==this.itemsFirstClones.length)){for(e=this.itemsFirstClones.length,a=e;a<f;a++)h={node:this.items[this.l-1-a].node.cloneNode(),load:"notLoaded",append:!1},d(h.node).setAttribute("data-item",this.l-1-a),h.index=this.items[this.l-1-a].index,this.o.lazyLoad&&this.o.progress&&(h.progress=new b.Modules.Progress(h.node),h.progress.show()),this.itemsFirstClones.push(h),i={node:this.items[a].node.cloneNode(),load:"notLoaded",append:!1},d(i.node).setAttribute("data-item",a),i.index=this.items[a].index,this.o.lazyLoad&&this.o.progress&&(i.progress=new b.Modules.Progress(i.node),i.progress.show()),this.itemsLastClones.push(i),d([i.node,h.node]).jEach(d(function(a){a.jAddEvent("click",d(function(a){this.move_&&a.stop()}).jBind(this))}).jBind(this)),this.container.append(i.node),this.container.append(h.node,"top"),d([this.items[this.l-1-a],this.items[a]]).jEach(d(function(a){"loaded"==a.load&&this.addCloneContent(a,d(function(){var b=!0;d(["scroll","animation"]).contains(this.name)&&(this.doneFlag.two||this.o.lazyLoad||(b=a.index<this.fullViewedItems)),this.showItem(a,b),a.clone.length>0&&d(a.clone).jEach(function(a){a.progress&&(a.progress.jRemove(),a.progress=null)})}).jBind(this))}).jBind(this));e?this.fullViewedItems+=f-e:this.fullViewedItems=f}else this.fullViewedItems=f;for(this.correctPosition=this.containerPosition=0,c=0,a=0;a<this.itemsFirstClones.length;a++)c+=this.items[this.l-1-a].size[this.p_.size];this.correctPosition+=c,this.containerPosition-=c,g[this.p_.pos]=this.containerPosition,b.browser.ieMode&&b.browser.ieMode<10?this.container.jSetCssProp(this.p_.pos,g[this.p_.pos]):this.correctContainerPosition()}},push:function(a){this.l=this.items.length,a.index=this.l,a.load="notLoaded",a.clone=[],this.o.progress&&this.o.lazyLoad&&(a.progress=new b.Modules.Progress(a.node,!0),this.o.stopDownload||a.progress.show()),a.node.setAttribute("data-item",a.index),a.node.jAddEvent("mouseover mouseout",d(function(b){for(var c=b.getRelated();c&&c!==a.node;)c=c.parentNode;c!=a.node&&("mouseover"===b.type?this.jCallEvent("on-item-hover",{itemIndex:a.index}):this.jCallEvent("on-item-out",{itemIndex:a.index}))}).jBind(this)),this.items.push(a)},_getItemIndex:function(a){return a%=this.l,a<0&&(a+=this.l),a},jump:function(a,c){var d;if("forward"!=a&&"backward"!=a||(this.direction=a),!this.move_&&!this.wheel_){if(this.move_=!0,"object"==b.jTypeOf(a)?(this.direction=a.direction,a.disableEffect=!1,a.defaultMove=!1):/forward|backward|^\+|^\-/.test(a)?(/^\+|^\-/.test(a)?(d=/^\+/.test(a)?"forward":"backward",a={goTo:Math.abs(parseInt(a)),direction:d},a.goTo>this.l&&(a.goTo=this.l),a.target=this._getItemIndex("forward"==a.direction?this.last+a.goTo:this.last-a.goTo)):(a={direction:a},a.target=this._getItemIndex("forward"==a.direction?this.last+this.itemStep:this.last-this.itemStep)),a.disableEffect=!1,a.defaultMove=!0):"number"==b.jTypeOf(parseInt(a))&&(a={target:this._getItemIndex(a),disableEffect:!0,defaultMove:!1}),a.callback=c,!this.o.loop&&(this.loop.firstItem||this.loop.lastItem))if(this.loop.firstItem){if("backward"===a.direction)return this.move_=!1,void c(null,!0)}else if("forward"===a.direction)return this.move_=!1,void c(null,!0);this["_"+this.name](a)}},_shiftContainer:function(a,c){var d={left:0,top:0},e=!1,f=c||this.containerPosition;return"forward"==a?f+this.correctPosition-this.distance+this.allSize<0&&(this.containerPosition=f+this.allSize,d[this.p_.pos]=this.containerPosition,e=!0):f+this.distance>0&&(this.containerPosition=f-this.allSize,d[this.p_.pos]=this.containerPosition,e=!0),e&&(b.browser.ieMode&&b.browser.ieMode<10?this.container.jSetCssProp(this.p_.pos,d[this.p_.pos]+"px"):(this.container.jSetCssProp(p,"translate3d("+d.left+"px, "+d.top+"px, 0)"),this.container.jSetCssProp("transition",p+" 0ms "+this.o.timingFunction),this._render(),"animation"==this.o.effect&&(this.previous=this.globalIndex=this._getGlobalIndex(),"forward"==a?this.globalIndex+=this.itemStep:this.globalIndex-=this.itemStep))),e},_calcDistance:function(a,b){var c,d=!0;for(b?this.o.stopDownload=!1:("auto"==this.o.step&&(this.itemStep="auto",this.setItemStep("backward"==a)),d=!1,b=this.itemStep),c=b;c>0;c--)this.last=this._getItemIndex("forward"==a?this.last+1:this.last-1),this.globalIndex="forward"==a?this.globalIndex+1:this.globalIndex-1,this.distance+=this.items["forward"==a?this._getItemIndex(this.last-1):this.last].size[this.p_.size];"infinite"===this.o.loop?this.o.continuous||this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()}):("scroll"===this.o.effect&&this.loop.lastItem&&"backward"==a&&(d?this.last-=this.itemsVisible-1:this.last-=b-1,this.last<0&&(this.last=0)),this.jCallEvent("enable"),this.loop.lastItem&&"forward"==a?(this.loop.lastItem=!1,this.loop.firstItem=!0,this.containerPosition=0,this.distance=0,this.last=0,this.globalIndex=0,this.jCallEvent("first-frame"),this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})):this.loop.firstItem&&"backward"==a?(this.loop.firstItem=!1,this.loop.lastItem=!0,this.distance=0,this.last=this.l-1,"scroll"==this.o.effect?(this.globalIndex=this.l-this.itemsVisible,this.containerPosition=(this.allSize-this.containerWidth)*-1):(this.globalIndex=this.l-this.l%this.itemsVisible,this.containerPosition=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*-1),this.jCallEvent("last-frame"),this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes(!0)})):(this.loop.lastItem=!1,this.loop.firstItem=!1,"forward"==a?this.containerPosition-this.distance<=this.containerWidth-this.allSize||this.containerPosition-this.distance+1<=this.containerWidth-this.allSize?(this.jCallEvent("last-frame"),"scroll"==this.o.effect||"animation"==this.o.effect&&"infinite"===this.o.loop?this.distance=this.containerPosition-(this.containerWidth-this.allSize):this.distance=this.containerWidth,this.loop.lastItem=!0,this.last=this.l-1,this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes(!0)})):this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()}):this.containerPosition+this.distance>=0||this.containerPosition+this.distance===-1?(this.jCallEvent("first-frame"),this.distance=Math.abs(this.containerPosition),this.loop.firstItem=!0,this.globalIndex=0,this.last=0,this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})):this.jCallEvent("on-start-effect",{arr:this.getVisibleIndexes()})))},jumpToNumber:function(a){var b,c,f,e=0;if(a.direction||(e=Math.floor(this.fullViewedItems/2),this.fullViewedItems%2==0&&(e-=1),e<0&&(e=0)),"infinite"===this.o.loop&&(a.target=this._getItemIndex(a.target-e)),this.last!=a.target)if(this.o.stopDownload=!1,f=d(function(b){var e,c=this.last,d=0;do d++,b?c--:c++,e=this._getItemIndex(c);while(e!=a.target);return d}).jBind(this),a.direction||("infinite"===this.o.loop?a.direction=f()<=f(!0)?"forward":"backward":a.direction=a.target>this.last?"forward":"backward"),this.jCallEvent("enable"),"infinite"===this.o.loop)for(;this.last!=a.target;)this.last=this._getItemIndex("forward"==a.direction?++this.last:--this.last),this.globalIndex="forward"==a.direction?++this.globalIndex:--this.globalIndex,this.distance+=this.items[this.last].size[this.p_.size];else{for(this.loop.lastItem=!1,this.loop.firstItem=!1,this.last=a.target,c=0,b=0;b<a.target-e;b++)c+=this.items[b].size[this.p_.size];this.globalIndex=a.target,this.containerPosition=0-this.correctPosition-c,("scroll"==this.o.effect&&this.containerPosition<=0-(this.allSize-this.containerWidth)||this.containerPosition<=0-(this.allSize+this.l%this.itemStep*this.items[0].size[this.p_.size]-this.containerWidth))&&("scroll"==this.o.effect&&(this.containerPosition=0-(this.allSize-this.containerWidth)),this.loop.lastItem=!0,this.jCallEvent("last-frame"),this.last=this.l-1),this.containerPosition>=0&&(this.containerPosition=0,this.jCallEvent("first-frame"),this.loop.firstItem=!0,this.last=0)}else this.move_=!1,this.wheel_=!1,this.jCallEvent("disableHold")},_scroll:function(a){var e,b=this.containerPosition,c=!1;this.previous=this.globalIndex,this.distance=0,this.o.loop&&"rewind"!==this.o.loop||"animation"!=this.o.effect||(this.loop.lastItem&&"forward"==a.direction||this.loop.firstItem&&"backward"==a.direction)&&(c=!0),a.defaultMove?this._calcDistance(a.direction,a.goTo):this.jumpToNumber(a),c&&(a.direction="forward"==a.direction?"backward":"forward"),0!==this.wheelDiff&&(e=this.items[this.prevIndex].size[this.p_.size]-this.wheelDiff,"forward"==a.direction?this.distance-=e:this.distance+=e,this.wheelDiff=0),"infinite"===this.o.loop&&this._shiftContainer(a.direction),"forward"==a.direction?this.containerPosition-=this.distance:this.containerPosition+=this.distance,this.moveSettings.direction=a.direction,this.moveSettings.disableEffect=a.disableEffect,b!=this.containerPosition?(this.callback=a.callback,!this.o.stopDownload||this.loadAll||this.checkLoadingVisibleItems()?(this.loadAll||this.preloadItem(),this._move(null,a.direction,a.disableEffect)):(this.jCallEvent("showProgress"),this.preloadItem(),this.bindEvent("groupLoad",d(function(a){this.move_&&this._move(null,a.direction,a.disableEffect)}).jBind(this,this.moveSettings)))):this.jCallEvent("hold")},_move:function(a,c,e){var f={left:0,top:0};this.move_=!0,b.browser.ieMode&&b.browser.ieMode<10?(f={},f[this.p_.pos]=[parseInt(this.container.jGetCss(this.p_.pos)),this.containerPosition],this.fx=new b.FX(this.container,{transition:this.o.timingFunction,duration:a||this.o.duration,onComplete:this._onComplete.jBind(this),onStart:d(function(){this.stop_=!1}).jBind(this)}).start(f)):(f[this.p_.pos]=this.containerPosition,"animation"!=this.o.effect||e?(this.container.jRemoveEvent("transitionend"),this.container.jAddEvent("transitionend",d(function(a){a.target==this.container&&(this.container.jRemoveEvent(a.type),e&&(this.globalIndex=this._getGlobalIndex(),this._cleansingStyles()),this._onComplete())}).jBind(this)),this.container.jSetCssProp(p,"translate3d("+f.left+"px, "+f.top+"px, 0)"),this.container.jSetCssProp("transition",p+" "+(a||this.o.duration)+"ms "+this.o.timingFunction)):this._moveEffect(c,f))},_moveEffect:function(a,b){var c,e,f,g=this.container.childNodes,h=g.length,i=d(function(a){return a%=this.globalLength,a<0&&(a+=this.globalLength),a}).jBind(this);for(this.exitItems.length=0,this.enterItems.length=0,c=0;c<this.itemStep;c++)e="infinite"===this.o.loop?i(this.previous+c):this.previous+c<h?this.previous+c:null,null!=e&&this.exitItems.push(g[e]),f="infinite"===this.o.loop?i(this.globalIndex+c):this.globalIndex+c<h?this.globalIndex+c:null,null!=f&&this.enterItems.push(g[f]);"backward"==a&&(this.exitItems.reverse(),this.enterItems.reverse()),this.container.setAttribute("data-"+a,""),this.exitItems.jEach(d(function(c,e){c.jAddEvent(o+"AnimationEnd animationend",d(function(c,e,f){c==this.exitItems[e]&&(c.jRemoveEvent(o+"AnimationEnd animationend").setAttribute("data-exited",""),e==this.exitItems.length-1&&(this.exitItems.jEach(d(function(a,b){a.removeAttribute("data-animation-nth"),a.removeAttribute("data-action")}).jBind(this)),this.enterItems.jEach(d(function(b,c){c==this.enterItems.length-1&&b.jAddEvent(o+"AnimationEnd animationend",d(function(c){c.target==b&&(b.jRemoveEvent(o+"AnimationEnd animationend"),this.enterItems.jEach(d(function(a,b){a.removeAttribute("data-animation-nth"),a.removeAttribute("data-action")}).jBind(this)),this.exitItems.jEach(d(function(a,b){a.removeAttribute("data-exited")}).jBind(this)),this.container.removeAttribute("data-"+a),this._render(),this._onComplete())}).jBind(this)),b.setAttribute("data-entering",""),b.jAddEvent(o+"AnimationStart animationstart",d(function(a){a.target==this&&(this.jRemoveEvent(o+"AnimationStart animationstart"),b.removeAttribute("data-entering"))}).jBind(b)),b.setAttribute("data-action","enter"),b.setAttribute("data-animation-nth",c+1)}).jBind(this)),this.container.jSetCssProp(p,"translate3d("+b.left+"px, "+b.top+"px, 0)")))}).jBind(this,c,e))}).jBind(this)),this.exitItems.jEach(d(function(a,b){a.setAttribute("data-exiting",""),a.jAddEvent(o+"AnimationStart animationstart",d(function(b){b.target==this&&(a.jRemoveEvent(o+"AnimationStart animationstart"),this.removeAttribute("data-exiting"))}).jBind(a)),a.setAttribute("data-action","exit"),a.setAttribute("data-animation-nth",b+1)}).jBind(this))},getVisibleIndexes:function(a){var e,b=0,c=this.itemStep,d=[];for(a&&(b="scroll"==this.o.effect?this.l-this.itemStep:this.l%this.itemStep?this.l-this.l%this.itemStep:this.l-this.itemStep,c=this.l);b<c;b++)e=a?b:this.last+b,d.push(this._getItemIndex(e));return d},_onComplete:function(){this.move_=!1,this.continuousPause=!1,this.callback&&this.callback(this.getVisibleIndexes(this.loop.lastItem))},_cleansingStyles:function(){this.container.jSetCssProp("transition",p+" 0ms")},getMatrixPosition:function(a){var b={x:0,y:0},c=a.jGetCss(p)||"",d=/3d/.test(c)?/matrix3d\(([^\)]+)\)/:/matrix\(([^\)]+)\)/,e=/3d/.test(c)?12:4,f=/3d/.test(c)?13:5;return(a.jGetCss(p)||"").replace(d,function(a,c){var d=c.split(",");b.x+=parseInt(d[e],10),b.y+=parseInt(d[f])}),b},_getGlobalIndex:function(){var a,b,c,d=Number.MAX_VALUE,e=this.container.parentNode.jGetPosition()[this.p_.pos];for(a=0;a<this.globalLength&&(b=this.container.childNodes[a].jGetPosition()[this.p_.pos],d>Math.abs(e-b));a++)d=Math.abs(e-b),c=a;return c},changeClones:function(){if(0!=this.itemsFirstClones.length){var a,b,c=d(function(a,c){var d,e;if(this.items[c].node!=a&&"loaded"==this.items[c].load){for(e=0;e<this.globalLength;e++)if(this.items[c].node==this.container.childNodes[e]){d=e;break}d<b?(this.container.insertBefore(a,this.container.childNodes[d]),b+1<=this.globalLength-1?this.container.insertBefore(this.items[c].node,this.container.childNodes[b+1]):this.container.appendChild(this.items[c].node)):(this.container.insertBefore(this.items[c].node,a),d+1<=this.globalLength-1?this.container.insertBefore(a,this.container.childNodes[d+1]):this.container.appendChild(a))}}).jBind(this);for(b=this._getGlobalIndex(),a=0;a<this.fullViewedItems;a++)c(this.container.childNodes[b],this._getItemIndex(this.last+a)),b++}},correctItemPosition:function(a){var b,c,e,h,l,f=0,g=0,i=this.container.parentNode.jGetPosition()[this.p_.pos]+1,j=this.container.jGetPosition()[this.p_.pos]-i,k=Math.abs(Math.abs(j)-Math.abs(this.containerPosition)),m=d(function(a){return parseInt(this.container.childNodes[a].getAttribute("data-item"))}).jBind(this);for(k>0&&k<1&&(k=0),"forward"==a?i+=k:i-=k,b=0;b<this.globalLength;b++){if(e=this.container.childNodes[b].jGetPosition()[this.p_.pos],e==i)return this.last=m(b),0;if(h=parseInt(this.container.childNodes[b].jGetSize()[this.p_.size]),e<i&&e+h>i){for(l=b,"forward"==a&&(l=b+1>this.globalLength-1?this.globalLength-1:b+1,b++),c=0;c<b;c++)g+=this.items[m(c)].size[this.p_.size];f=Math.abs(Math.abs(this.containerPosition)-g),this.last=m(l);break}}return f},_initDragOnScroll:function(){var a,c,e,g,h,l,i="left"==this.p_.pos?"x":"y",j={x:0,y:0},k="scroll"==this.o.effect,m=!0,n={
x:0,y:0},o=!1,q=!1,s=0,t=null,u=!1,v=d(function(a){var b,c=0;for(a>this.containerWidth&&(a=this.containerWidth),b=1.5;b<=90;b+=1.5)c+=a*Math.cos(b/Math.PI/2);return this.containerWidth>c?c:this.containerWidth}).jBind(this),w=d(function(a){for(var b,d,e,c=0;c>this.containerPosition;)c-=this.containerWidth;for(Math.abs(c-this.containerPosition)>this.containerWidth/2&&(c+=this.containerWidth),e=c,b=0;b<this.globalLength;b++){if(d=parseInt(this.container.childNodes[b].getAttribute("data-item")),0==e){this.last=d;break}e+=this.items[d].size[this.p_.size]}return c}).jBind(this),x=d(function(a){q=!0,d(document.body).jAddClass("mcs-dragging"),this.o.stopDownload=!1,m=!0,clearTimeout(this.moveTimer),"animation"==this.o.effect&&this.stopEffect(),this.stopWhell&&this.stopWhell(),j={x:0,y:0},i="left"==this.p_.pos?"x":"y",this.jCallEvent("drag-start"),this.container.jRemoveEvent("transitionend"),this.containerPosition=this.getMatrixPosition(this.container)[i],j[i]=this.containerPosition,this.container.jSetCssProp(p,"translate3d("+j.x+"px, "+j.y+"px, 0)"),this.container.jSetCssProp("transition","none"),this._render(),"scroll"==this.o.effect&&(k=!0),this.move_=!0}).jBind(this),y=d(function(b){if(d(document.body).jRemoveClass("mcs-dragging"),q){q=!1;var f=this.containerPosition;m?this.move_=!1:(b.returnValue=!1,A(),c=b.timeStamp-a,"scroll"==this.o.effect?(c>200?(h=g,k=!1):h=v(Math.abs(n[i]-b[i])),g=h,"infinite"===this.o.loop&&(this.distance=Math.abs(g),this._shiftContainer(e)),("infinite"===this.o.loop||this.containerPosition<=0)&&(Math.abs(this.containerPosition)<g&&(g=Math.abs(this.containerPosition)),this.containerPosition-=g),"forward"==e?this.containerPosition-=this.correctItemPosition(e):this.containerPosition+=this.correctItemPosition(e),this.o.loop&&"rewind"!==this.o.loop||(this.jCallEvent("enable"),this.loop.firstItem=!1,this.loop.lastItem=!1,this.containerPosition>0&&(this.containerPosition=0,this.last=0,k=!0,this.jCallEvent("first-frame"),this.loop.firstItem=!0),this.containerPosition<this.containerWidth-this.allSize&&(this.containerPosition=this.containerWidth-this.allSize,this.last=this.l-1,k=!0,this.jCallEvent("last-frame"),this.loop.lastItem=!0)),l=k?600:300):(k=!0,this.distance=0,this.containerPosition=w(),"infinite"===this.o.loop&&this._shiftContainer(e),c<200&&(this.distance=this.containerWidth,"infinite"===this.o.loop&&this._shiftContainer(e),"forward"==e?this.containerPosition-=this.containerWidth:this.containerPosition+=this.containerWidth),this.o.loop&&"rewind"!==this.o.loop||(this.jCallEvent("enable"),this.loop.firstItem=!1,this.loop.lastItem=!1,this.containerPosition>=0&&(this.containerPosition=0,this.last=0,this.loop.firstItem=!0,this.jCallEvent("first-frame")),this.containerPosition<=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*-1&&(this.containerPosition=(Math.ceil(this.l/this.itemStep)-1)*this.containerWidth*-1,this.last=this.l-1,this.loop.lastItem=!0,this.jCallEvent("last-frame"))),l=500),j[i]=this.containerPosition,this.container.jAddEvent("transitionend",d(function(a){a.target==this.container&&("animation"==this.o.effect&&(this.container.jSetCssProp("transition","none"),this.globalIndex=this._getGlobalIndex()),"animation"==this.o.effect&&(this.last=parseInt(this.container.childNodes[this._getGlobalIndex()].getAttribute("data-item"))),"infinite"===this.o.loop&&this.changeClones(),this.move_=!1,this.wheel_=!1,k=!1,m=!0,this.preloadItem(),this.jCallEvent("drag-end",{arr:this.getVisibleIndexes(this.loop.lastItem)}))}).jBind(this)),f==this.containerPosition&&(this.move_=!1,k=!1,m=!0),this.container.jSetCssProp("transition",p+" "+l+"ms cubic-bezier(.22,.63,.49,.8)"),this.container.jSetCssProp(p,"translate3d("+j.x+"px, "+j.y+"px, 0)"))}}).jBind(this),z=0,A=d(function(){clearTimeout(t),t=null,u=!1,z=0}).jBind(this),B=d(function(){var a=.2*z;return Math.abs(a)<1e-4?void A():(z-=a,this.containerPosition-=a,j[i]=this.containerPosition,this.container.jSetCssProp(p,"translate3d("+j.x+"px, "+j.y+"px, 0)"),void(t=setTimeout(B,16)))}).jBind(this),C=d(function(a){if(q){var c=a[i]-s>0?"backward":"forward";m=!1,"infinite"===this.o.loop&&(this.distance=Math.abs(g),this._shiftContainer(c)),b.browser.ieMode?(z+=g,u||(u=!0,B())):(this.container.jSetCssProp("transition",p+" 0ms"),"animation"==this.o.effect,this.containerPosition-=g,j[i]=this.containerPosition,this.container.jSetCssProp(p,"translate3d("+j.x+"px, "+j.y+"px, 0)")),this.freeTouchPreload(c)}}).jBind(this),D=d(function(b){if(!(this.stopScroll||"animation"==this.o.effect&&k)){if("dragstart"==b.state)a=b.timeStamp,n.x=b.x,n.y=b.y,s=b[i];else if(e=g>0?"forward":"backward",g=s-b[i],this.moveSettings.direction=e,"dragend"==b.state)o&&(o=!1,y(b));else if("vertical"==this.o.orientation||Math.abs(b.x-n.x)>Math.abs(b.y-n.y))if(b.stopDefaults(),o)C(b);else{if("animation"==this.o.effect&&this.move_)return;o=!0,x(b)}s=b[i]}}).jBind(this);(!b.browser.ieMode||b.browser.ieMode&&b.browser.ieMode>9)&&this.container.parentNode.jAddEvent("mousedrag touchdrag",D)},_initOnWheel:function(){var a,e=0,f={x:0,y:0},g="left"==this.p_.pos?"x":"y",h=d(function(b){var c=e*(b||.2);return a=c>0?"forward":"backward",e-=c,Math.abs(c)<1e-5?(clearTimeout(this.moveTimer),this.last=parseInt(this.container.childNodes[this._getGlobalIndex()].getAttribute("data-item")),this.changeClones(),this.wheelDiff=this._getWheelDiff(),this.prevIndex=this.last,e=0,this.distance=0,this.moveTimer=null,this.wheel_=!1,this.move_=!1,void this.jCallEvent("drag-end",{arr:this.getVisibleIndexes(this.loop.lastItem)})):(this.distance=Math.abs(c),"infinite"===this.o.loop&&this._shiftContainer(a),this.containerPosition-=c,this.distance=0,this.freeTouchPreload(a),this.o.loop&&"rewind"!==this.o.loop||(this.containerPosition>0?(this.containerPosition=0,e=1e-5,this.jCallEvent("first-frame")):this.containerPosition<this.containerWidth-this.allSize?(this.containerPosition=this.containerWidth-this.allSize,e=1e-5,this.jCallEvent("last-frame")):this.jCallEvent("enable")),f[g]=this.containerPosition,this.container.jSetCssProp(p,"translate3d("+f.x+"px, "+f.y+"px, 0)"),void(this.moveTimer=setTimeout(h.jBind(this,b),30)))}).jBind(this);b.browser.ieMode&&b.browser.ieMode<10||this.stopScroll||(this.stopWhell=d(function(){this.wheel_&&(clearTimeout(this.moveTimer),e=0,this.distance=0,this.moveTimer=null,this.wheel_=!1,this.move_=!1)}).jBind(this),this.container.jAddEvent("mousescroll",d(function(a){var b=Math.abs(a.deltaY)<Math.abs(a.deltaX)?a.deltaX:a.deltaY*(a.isMouse?-30:-1);this.move_||(!0===this.o.scrollOnWheel&&a.isMouse||"vertical"===this.o.orientation&&Math.abs(a.deltaY)>Math.abs(a.deltaX)||"horizontal"===this.o.orientation&&Math.abs(a.deltaY)<Math.abs(a.deltaX))&&(a.stop(),this.wheel_=!0,0===e&&(this.container.jSetCssProp("transition",p+" 0ms"),f={x:0,y:0},g="left"==this.p_.pos?"x":"y"),this.jCallEvent("drag-start"),e+=b,this.moveTimer||h(.4))}).jBind(this)))},_getWheelDiff:function(){var a,b,c=this.containerPosition,e=d(["tempArray","items","itemsLastClones"]);for(this.tempArray=[],this.itemsFirstClones.jEach(d(function(a){this.tempArray.push(a)}).jBind(this)),this.tempArray.reverse(),a=0;a<e.length;a++)for(b=0;b<this[e[a]].length;b++)if(c+=this.items[this[e[a]][b].index].size[this.p_.size],c>0)return this.last=this[e[a]][b].index,this.tempArray=null,c},pause:function(){var a,c;this.o.continuous&&!this.continuousPause&&this.move_&&"animation"!=this.o.effect&&(this.continuousPause=!0,b.browser.ieMode&&b.browser.ieMode<10?(this.fx&&(this.fx.options.onComplete=b.$F),this.fx&&this.fx.stop(),this.fx=null,this.containerPosition=Math.round(parseInt(this.container.jGetCss(this.p_.pos)))):this.containerPosition=this.getMatrixPosition(this.container)["left"==this.p_.pos?"x":"y"],a=this.correctItemPosition(this.direction),c=this.o.duration/this.distance*a,"forward"==this.direction?this.containerPosition-=a:this.containerPosition+=a,this._move(c))},stop:function(){this.stop_=!0,this.move_=!1,this.stopWhell&&this.stopWhell(),"animation"==this.o.effect&&this.stopEffect(),b.browser.ieMode&&b.browser.ieMode<10?(this.fx&&this.fx.stop(!0),this.fx=null):this._cleansingStyles()},stopEffect:function(){var a={x:0,y:0};(!b.browser.ieMode||b.browser.ieMode&&b.browser.ieMode>10)&&(a[this.p_.pos]=this.containerPosition,this.container.removeAttribute("data-forward"),this.container.removeAttribute("data-backward"),d([this.exitItems,this.enterItems]).jEach(d(function(a,b){a.length>0&&a.jEach(d(function(a,c){a.jRemoveEvent(o+"AnimationStart animationstart "+o+"AnimationEnd animationend"),a.removeAttribute("data-animation-nth"),a.removeAttribute("data-action"),b?a.removeAttribute("data-entering"):(a.removeAttribute("data-exiting"),a.removeAttribute("data-exited"))}).jBind(this))}).jBind(this)),this.container.jSetCssProp(p,"translate3d("+a.left+"px, "+a.top+"px, 0)"),this.move_=!1,this._render())},onResize:function(){var a,c;for(this.stop(),this.continuousPause=!1,this.wrapperPosition=d(this.container.parentNode).jGetPosition(),this.containerWidth=this._sWidth(),this.itemsVisible=0,this.allSize=0,a=0;a<this.l;a++)this.items[a].size=this.items[a].node.jGetSize(!0),this.allSize+=this.items[a].size[this.p_.size],this.allSize<=this.containerWidth&&(this.itemsVisible+=1);if(b.browser.ieMode&&b.browser.ieMode<10?this.last=0:this.correctContainerPosition(),this.distance=0,this.itemStep=this.o.step,this.allSize<=this.containerWidth?(this.stopScroll=!0,this.jCallEvent("hideArrows"),this.jCallEvent("disable"),this.correctPosition=0,this.containerPosition=0,b.browser.ieMode&&b.browser.ieMode<10?this.container.jSetCssProp(this.p_.pos,0):this.container.jSetCssProp(p,"translate3d(0px, 0px, 0)"),this._removeClones()):(this.stopScroll=!1,this.jCallEvent("showArrows"),this.jCallEvent("enable"),this.o.loop&&"rewind"!==this.o.loop||(this.loop.firstItem&&this.jCallEvent("first-frame"),this.loop.lastItem&&this.jCallEvent("last-frame"))),this.allSize>this.containerWidth&&("infinite"===this.o.loop||this.o.continuous))this._prepareClones();else for(this.fullViewedItems=c=0,a=0;a<this.l&&(c+=this.items[a].size[this.p_.size],this.fullViewedItems++,!(this.containerWidth<=c));a++);this._shiftContainer("forward"),this.container.jRemoveEvent("transitionend"),this.globalIndex=this._getGlobalIndex(),this.globalLength=this.container.childNodes.length,this.setItemStep(),this.changeClones(),this.allNodes=b.$A(this.container.childNodes),this.o.lazyLoad?this.preloadItem():this.preloadAll()},correctContainerPosition:function(){var a,c,d={left:0,top:0},e=this.items[this.last].node.jGetPosition()[this.p_.pos],f=this.container.parentNode.jGetPosition()[this.p_.pos];b.browser.ieMode&&b.browser.ieMode<10||(!this.o.loop&&this.loop.lastItem?"scroll"===this.o.effect?d[this.p_.pos]=this.containerWidth-this.allSize:(c=this.itemsVisible-this.l%this.itemsVisible,d[this.p_.pos]=this.containerWidth-(this.allSize+this.items[0].size[this.p_.size]*c)):(a=this.getMatrixPosition(this.container)["left"===this.p_.pos?"x":"y"],d[this.p_.pos]=a-(e-f)),this.containerPosition=d[this.p_.pos],this.container.jSetCssProp(p,"translate3d("+d.left+"px, "+d.top+"px, 0)"))},rightQueue:function(){var a=0,b=!0,c=this.l-1,e=d(["itemsLastClones","items","itemsFirstClones"]),f=d(function(a,b){var c,d=null;for(c=0;c<a.length;c++)if(a[c].index==b){d=a[c].node;break}return d}).jBind(this),g=d(function(b){return 0==a?b-1:a-1}).jBind(this),h=d(function(d,h){var i,j=d.length;if(j>0)for(i=0;i<j;i++)b?(b=!1,a=j-1,this.container.appendChild(d[a].node)):(this.container.insertBefore(f(d,a?g(j):c),f(a?d:this[e[h-1]],a)),a=a?a-1:c)}).jBind(this);e.jEach(d(function(b,c){h(this[b],c),a=0}).jBind(this)),this.last=0},_removeClones:function(){this.itemsFirstClones.jEach(function(a){a.node.kill()}),this.itemsFirstClones=d([]),this.itemsLastClones.jEach(function(a){a.node.kill()}),this.itemsLastClones=d([])},update:function(a){var c={left:0,top:0};this.stop(),this.containerPosition=this.last=0,b.browser.ieMode&&b.browser.ieMode<10?this.container.jSetCss(c):this.container.jSetCssProp(p,"translate3d("+c.left+"px, "+c.top+"px, 0)"),this.itemStep=this.o.step,this.o.continuous||this.o.loop&&"rewind"!==this.o.loop||!(this.itemsFirstClones.length>0)||(this.correctPosition=0,this._removeClones()),this.onResize(),this.rightQueue(),this.o.draggable?this.container.parentNode.jAddEvent("mousedrag touchdrag",onDrag):this.container.parentNode.jRemoveEvent("mousedrag touchdrag",onDrag),this.move_=!1},setNewOptions:function(a){for(var b in a)this.o[b]=a[b];this._setProperties()},dispose:function(){this.stop(),this._removeClones(),d(window).jRemoveEvent("resize"),d(document).jRemoveEvent("keydown"),this.container.jRemoveEvent("touchdrag mousedrag"),this.items.jEach(d(function(a){a.node.jRemoveEvent("mouseover mouseout"),delete a.content.showThis}).jBind(this))}},b.extend(q.prototype,b.customEvents),b.Scroll.Effect=q;var r=function(a,c){b.Scroll.Effect.apply(this,arguments),this._options={radius:"auto",gradientBezier:d([.44,.59,.35,.89]),startAlpha:255,timingFunction:"cubic-bezier(.8, 0, .5, 1)"},this.name="carousel",this.o=this._options,b.extend(this.o,c),this.distance=70,this.lastAngle=0,this.nextAngle=0,this.moveTimer=null,this.fxk=Math.pow(10,8),this.circle=2*Math.PI,this.last=0,this.getVisibleItems=d([]),this.originSize=null,this.angle=null,this.endItem=null,this.radius=0,this.l=0,this.originFontSize=null};b.inherit(r,b.Scroll.Effect),b.extend(r.prototype,{constructor:r,_prepareClones:b.$F,changeClones:b.$F,getVisibleIndexes:b.$F,_scroll:b.$F,pause:b.$F,resetZIndex:b.$F,performedOnClones:b.$F,cloneFigure:b.$F,preloadItem:b.$F,_getWheelDiff:b.$F,gradientBezier:b.extend({},b.FX.prototype),_shiftContainer:function(){this.lastAngle%=this.circle,this.nextAngle=this.lastAngle},done:function(a){var c,e;if(!this.doneFlag.one){for(this.doneFlag.one=!0,e=this.l=this.items.length,this.containerWidth=this._sWidth(),b.browser.ieMode&&b.browser.ieMode<10&&this.items[0].content.length&&"figcaption"==this.items[0].content.lastChild.tagName.toLowerCase()&&(this.originFontSize=parseInt(this.items[0].content.lastChild.jGetCss("font-size"))),this.gradientBezier.cubicBezier=this.o.gradientBezier,c=0;c<this.l;c++)this.items[c].size=this.items[c].node.jGetSize(!0,!0),this.allSize+=this.items[c].size[this.p_.size],this.items[c].node.jSetCssProp("position","absolute"),this.items[c].img=this.getImg(this.items[c]);"infinite"===this.o.loop&&this.jCallEvent("enable"),this.items.jEach(d(function(a){a.figcaption&&!a.captionA&&"figure"!=a.content.tagName.toLowerCase()&&(a.captionA=!0)}).jBind(this)),this.onResize(),this.preloadAll()}},done2:function(a){this.doneFlag.two=!0,this.itemEvent(),this.angle=this.circle/this.l,this.endItem=(this.circle-this.angle)*-1,this.itemStep=1,this._initDragOnScroll(),this.o.scrollOnWheel&&this._initOnWheel(),d(window).jAddEvent("resize",this.onResize.jBind(this)),this.o.keyboard&&d(document).jAddEvent("keydown",this.keyboardCallback),a&&a(),this.onResize()},itemEvent:function(){r.$parent.itemEvent.apply(this),this.items.jEach(d(function(a){a.node.jAddEvent("click",d(function(b){this.jCallEvent("item-click",{index:a.index})}).jBind(this))}).jBind(this))},showReflection:function(a){var c=1e3;b.browser.ieMode&&b.browser.ieMode<10||!a.canvas||(a.canvas.jSetOpacity(1),a.canvas.jSetCssProp("transition","opacity "+c+"ms"))},setCanvasPosition:function(a){var b,c,e=d(function(a){(a.canvas||a.captionA)&&(b=a.img.jGetSize(!1,!0),c=a.img.offsetTop+b.height,a.canvas&&a.canvas.jSetCss({top:c,left:a.img.offsetLeft,width:b.width}),a.captionA&&a.figcaption&&a.figcaption.jSetCss({top:c}))}).jBind(this);a?e(a):this.items.jEach(d(function(a){e(a)}).jBind(this))},getImg:function(a){var b,c=a.content;return b="IMG"==c.tagName?c:"IMG"==c.firstChild.tagName?c.firstChild:"FIGURE"==c.firstChild.tagName&&"IMG"==c.firstChild.firstChild.tagName?c.firstChild.firstChild:null,b&&d(b).jSetCssProp("z-index",100),b},setReflection:function(a){if("vertical"!=this.o.orientation){var f,g,h,j,k,m,n,o,p,q,r,c=b.$new("canvas",{},{opacity:0}),e=b.$new("canvas"),l=1;if(!(b.browser.ieMode&&b.browser.ieMode<10)&&c.getContext){if(f=c.getContext("2d"),g=e.getContext("2d"),!a.img)return;for(j=d(a.img).jGetSize(!1,!0),k=j.height/100*30,e.width=j.width,e.height=j.height,g.save(),g.scale(1,-1),g.drawImage(a.img,0,j.height*-1,j.width,j.height),h=g.getImageData(0,0,j.width,k),g.restore(),c.width=j.width,c.height=k,f.save(),n=h.data,r=n.length,p=r/4/j.width,o=this.o.startAlpha,m=r/p,q=3;q<r;q+=4)q>m&&(m+=r/p,l++,o=Math.round(this.o.startAlpha-this.o.startAlpha*this.gradientBezier.cubicBezierAtTime(1/(p/l)))),n[q]=o;f.putImageData(h,0,0),f.restore(),a.canvas=c,(!a.content.childNodes||a.content.childNodes.length<2)&&"a"!==a.content.tagName.toLowerCase()?a.node.appendChild(c):a.content.insertBefore(c,a.content.childNodes[1]),c.jAddClass("mcs-reflection")}}},showCaption:function(a){var b=0,c=this.distance/(this.l/2),d=100-c;return a>d&&(b=(a-d)/c),b},renderCarousel:function(a){var f,g,k,l,m,n,o,q,c={left:0,top:0},d={left:0,top:0},e={left:0,top:0},h=this.l,i=this.distance,j=this.circle/h;for(c[this.p_.pos]=this.radius,b.defined(a)||(a=0),this.lastAngle=a,o=0;o<h;o++)l=m=o*j+a,m%=this.circle,l%=this.circle,0!=m&&m!=Math.PI&&(Math.ceil(Math.abs(m)/Math.PI)%2==0?Math.abs(m)%Math.PI!=0&&(l=Math.PI-Math.abs(m)%Math.PI):l=Math.abs(m)),l=Math.abs(100*l/Math.PI),this.items[o].figcaption&&this.items[o].figcaption.jSetOpacity(this.showCaption(100-l*i/100)),l=100-Math.round(l*i/100),!this.originSize&&(this.originSize=this.items[o].size),f=Math.abs(m),f>Math.PI/2&&f<Math.PI+Math.PI/2?(f>Math.PI?f=Math.PI/2-Math.abs(f-Math.PI):f-=Math.PI/2,f=.7*(1-Math.sin(f))):f=1,b.browser.ieMode&&b.browser.ieMode<10?(n={width:this.setItemSide("width",l),height:this.setItemSide("height",l)},this.items[o].node.jSetCss(n),this.items[o].node.jSetCss({top:Math.sin(m)*c.top+parseInt(this.containerSize.height)/2-parseInt(n.height)/2,left:Math.sin(m)*c.left+parseInt(this.containerSize.width)/2-parseInt(n.width)/2}),this.items[o].content.length&&"figcaption"==this.items[o].content.lastChild.tagName.toLowerCase()&&(this.items[o].content.lastChild.style.fontSize=this.setFontSize(l/100*l)),this.items[o].captionA&&(k=this.items[o].img.jGetSize(!1,!0),this.items[o].figcaption.jSetCss({top:this.items[o].img.offsetTop+k.height}))):(e[this.p_.pos]=360/this.circle*m,"vertical"==this.o.orientation&&(e[this.p_.pos]*=-1),q=Math.abs(m),g=Math.sqrt(1-Math.sin(q)*Math.sin(q)),q=q>Math.PI/2&&q<Math.PI+Math.PI/2?this.radius*g+this.radius:this.radius*(1-g),q>0&&(q*=-1),d[this.p_.pos]=Math.sin(m)*c[this.p_.pos]+parseInt(this.containerSize[this.p_.size])/2-this.items[o].size[this.p_.size]/2,this.items[o].node.jSetCssProp(p,"translateX("+d.left+"px)translateY("+d.top+"px)translateZ("+q+"px)rotateX("+e.top+"deg)rotateY("+e.left+"deg)")),this.items[o].node.jSetCssProp("z-index",0+l),this.items[o].node.jSetOpacity(f)},round:function(a,b){var c=Math.pow(10,b||15);return Math.round(a*c)/c},_calcDistance:function(a){var c,d,e=360/this.l;return a.defaultMove?a.goTo?("forward"==a.direction&&this.last>a.target?(c=this.l-this.last,c+=a.target):"backward"==a.direction&&this.last<a.target&&(c=this.l-a.target,c+=this.last),!c&&(c=Math.abs(this.last-a.target)),this.last=a.target):(c=this.itemStep,this.last=this._getItemIndex("forward"==a.direction?this.last+c:this.last-c)):(d=(360-this.last*e+a.target*e)%360,d>=0&&d<=180?!a.direction&&(a.direction="forward"):d>=180&&d<=360&&!a.direction&&(a.direction="backward"),c="forward"==a.direction?Math.round(d/e):Math.round((360-d)/e),this.last=a.target),b.extend(a,{angle:c*this.angle})},_carousel:function(a){var b;a=this._calcDistance(a),b=a.angle,this.o.loop||this.jCallEvent("enable"),"forward"==a.direction?(this.nextAngle-=b,this.o.loop||(this.nextAngle==this.endItem?this.jCallEvent("last-frame"):this.nextAngle<this.endItem&&(this.last=0,this.nextAngle=0,this.jCallEvent("first-frame")))):(this.nextAngle+=b,this.o.loop||(0==this.nextAngle?this.jCallEvent("first-frame"):this.nextAngle>0&&(this.last=this.l-1,this.nextAngle=this.endItem,this.jCallEvent("last-frame")))),this.jCallEvent("on-start-effect",{arr:[this.last]}),this.callback=a.callback,this._move(this.nextAngle)},setItemSide:function(a,b){return this.originSize[a]/100*b},setFontSize:function(a){return Math.round(this.originFontSize/100*a)+"px"},_move:function(a){this.fx=new b.FX(this.container,{duration:this.o.duration,transition:this.o.timingFunction,onBeforeRender:function(a){this.renderCarousel(a.angle/this.fxk)}.jBind(this),onComplete:d(function(){this._onComplete()}).jBind(this)}).start({angle:[this.fxk*this.lastAngle,this.fxk*a]})},_onComplete:function(){this._shiftContainer(),r.$parent._onComplete.apply(this)},_move2:function(a){var b=Math.abs(this.nextAngle-this.lastAngle)*(a||.2);return Math.abs(b)<1e-5?(clearTimeout(this.moveTimer),this.moveTimer=null,this.move_=!1,void this.jCallEvent("drag-end",{arr:[this.last]})):(this.nextAngle<this.lastAngle&&(b*=-1),this.renderCarousel(this.lastAngle+b),void(this.moveTimer=setTimeout(this._move2.jBind(this,a),30)))},searchIndex:function(){var a,e,f,b=this.nextAngle%this.circle,c=parseInt(Math.abs(this.nextAngle/this.circle)),g=d(function(a){for(;0!=c;)c--,b<=0?a-=this.circle:a+=this.circle;return a}).jBind(this);for(a=0;a<this.l;a++)e=a*this.circle/this.l,f=(a+1)*this.circle/this.l,b<=0?(e*=-1,f*=-1):(e=this.circle-e,f=this.circle-f),e!=b?e>b&&b>f&&(Math.abs(b-e)<=Math.abs(f-b)?(this.nextAngle=g(e),this.last=a):(this.nextAngle=g(f),this.last=this._getItemIndex(a+1))):this.last=a},_initOnWheel:function(){var a,c,e=this.circle/360*15;this.container.jAddEvent("mousescroll",d(function(f){(!0===this.o.scrollOnWheel||f.isMouse||"vertical"===this.o.orientation&&Math.abs(f.deltaY)>Math.abs(f.deltaX)||"horizontal"===this.o.orientation&&Math.abs(f.deltaY)<Math.abs(f.deltaX))&&(this.jCallEvent("drag-start"),this.fx&&this.fx.stop(!0),this.fx=null,f.stop(),b.browser.ieMode&&b.browser.ieMode<10&&(f.isMouse=!0),c=Math.abs(f.deltaY)<Math.abs(f.deltaX)?f.deltaX:-1*f.deltaY,c=f.isMouse?c*e:c*(8/864),!f.isMouse&&(c=c>0?Math.min(this.angle/4,c):Math.max(this.angle/4*-1,c)),this.nextAngle-=c,clearTimeout(a),a=setTimeout(d(function(){this.searchIndex()}).jBind(this),100),this.o.loop||(this.nextAngle>=0?(this.jCallEvent("first-frame"),this.nextAngle=0,this.last=0):this.nextAngle<=this.endItem&&(this.jCallEvent("last-frame"),this.nextAngle=this.endItem,this.last=this.l-1)),this.moveTimer||this._move2(.08))}).jBind(this))},_initDragOnScroll:function(){var e,a="left"==this.p_.pos?"x":"y",b={x:0,y:0},c={x:0,y:0},f=!1,g="forward",h=!1,i=d(function(i){"dragstart"==i.state?(d(document.body).jAddClass("mcs-dragging"),h=!0,b.x=c.x=i.x,b.y=c.y=i.y):h&&(b.x=i.x,b.y=i.y,"dragend"==i.state?(d(document.body).jRemoveClass("mcs-dragging"),h=!1,f&&(f=!1,this.searchIndex())):(("vertical"==this.o.orientation||Math.abs(i.x-c.x)>Math.abs(i.y-c.y))&&(i.stopDefaults(),f||(f=!0,this.move_=!0,this.fx&&this.fx.stop(),this.jCallEvent("drag-start"),clearTimeout(this.moveTimer),this.moveTimer=null),g=c[a]<b[a]?"backward":"forward",e=Math.abs(c[a]-b[a])/this.radius,"forward"==g?(this.nextAngle-=e,this.o.loop||this.nextAngle<=this.endItem&&(this.jCallEvent("last-frame"),this.nextAngle=this.endItem,this.last=this.l-1)):(this.nextAngle+=e,this.o.loop||this.nextAngle>=0&&(this.jCallEvent("first-frame"),this.nextAngle=0,this.last=0)),!this.moveTimer&&this._move2()),c.x=b.x,c.y=b.y))}).jBind(this);this.container.jAddEvent("touchdrag mousedrag",i)},stop:function(){this.fx&&this.fx.stop(!0),this.fx=null,clearTimeout(this.moveTimer),this.moveTimer=null,this.nextAngle&&this.renderCarousel(this.nextAngle)},onResize:function(){var a,c,d,e;for(this.stop(),this.containerWidth=this._sWidth(),this.containerSize=this.container.parentNode.jGetSize(!1,!0),this.allSize=0,a=0;a<this.l;a++)this.items[a].size=this.items[a].node.jGetSize(!0,!0),this.allSize+=this.items[a].size[this.p_.size];this.angle=1*this.circle/this.l,this.endItem=(this.circle-this.angle)*-1,c=this.allSize/this.circle,this.radius=this.containerSize[this.p_.size]/2,this.radius<c&&(this.radius=c),b.browser.ieMode&&b.browser.ieMode<10&&(this.radius-=this.items[0].size[this.p_.size]/2),this.lastAngle=this.nextAngle=0,this.renderCarousel(),this.setCanvasPosition(),d=this.last,this.last=0,e=this._calcDistance({target:d}),"forward"===e.direction?this.nextAngle-=e.angle:this.nextAngle+=e.angle,this.renderCarousel(this.nextAngle)},update:function(a){this.stop(),this.last=0,"vertical"==this.o.orientation?this.removeCanvas():this.items.jEach(d(function(a){a.canvas||this.setReflection(a)}).jBind(this)),this.container.jRemoveEvent("touchdrag mousedrag mousescroll"),this._initDragOnScroll(),this.o.scrollOnWheel&&this._initOnWheel(),this.resetZIndex(),this._setProperties(),this.onResize(),"horizontal"==this.o.orientation&&this.items.jEach(d(function(a){this.showReflection(a)}).jBind(this)),this.move_=!1},removeCanvas:function(){this.items.jEach(d(function(a){a.canvas&&(a.canvas.jRemove(),delete a.canvas)}).jBind(this))},dispose:function(){r.$parent.dispose.apply(this),this.container.jRemoveEvent("mousescroll"),this.removeCanvas(),this.items.jEach(d(function(a){a.node.jRemoveEvent("click")}).jBind(this))}}),b.extend(r.prototype,b.customEvents),b.Scroll.Carousel=r;var s=function(a,c){b.Scroll.Carousel.apply(this,arguments),this.name="coverFlow",this.center=null,this.distance=null,this.moiety=null,this.lastPosition=null,this.nextPosition=null,this.depth=350,this.itemStep=1,this.moveTimer=null,this.firstSide=null,this.lastSide=null,this.stepDistance=null,this.lastItemLoad=0};b.inherit(s,b.Scroll.Carousel),b.extend(s.prototype,{constructor:s,_shiftContainer:b.$F,_carousel:b.$F,showCaption:b.$F,setItemsPosition:function(){var a,b,c;for(this.stepDistance=this.moiety,"vertical"==this.o.orientation?(c=this.moiety+.8*this.moiety,this.stepDistance/=2):c=2*this.moiety,a=0;a<this.l;a++)b=1==a?c:this.stepDistance,this.items[a].position=a?this.items[a-1].position+b:this.center-this.moiety},zIndex:function(a){if("horizontal"==this.o.orientation)return Math.round(this.allSize-Math.abs(this.center-(a.position+this.moiety)))},done:function(a){var b,c;if(!this.one){for(this.one=!0,c=this.l=this.items.length,this.containerWidth=this._sWidth(),this.gradientBezier.cubicBezier=this.o.gradientBezier,b=0;b<this.l;b++)this.items[b].size=this.items[b].node.jGetSize(!0,!0),this.allSize+=this.items[b].size[this.p_.size],this.items[b].node.jSetCssProp("position","absolute"),this.items[b].img=this.getImg(this.items[b]),this.items[b].figcaption&&d(this.items[b].figcaption).jSetOpacity(0);this.o.loop=!1,this.items.jEach(d(function(a){a.figcaption&&!a.captionA&&"figure"!=a.content.tagName.toLowerCase()&&(a.captionA=!0)}).jBind(this)),this.onResize(),!this.o.lazyLoad&&this.preloadAll()}},done2:function(a){this.doneFlag.two=!0,this.itemEvent(),this.itemStep=1,this._initDragOnScroll(),this.o.scrollOnWheel&&this._initOnWheel(),d(window).jAddEvent("resize",this.onResize.jBind(this)),this.o.keyboard&&d(document).jAddEvent("keydown",this.keyboardCallback),a&&a(),this.onResize()},zoom:function(a){var b,c,d,e,g,f=1,h=a.position+this.moiety,i=a.position+this.moiety<=this.center;return e=i?this.center-h:h-this.center,e/=(i?this.center-this.firstSide:this.lastSide-this.center)/100,c=.9*e*(Math.PI/180),b=60*Math.sin(c),g=1-1*Math.sin(c),"horizontal"==this.o.orientation?!i&&(b*=-1):(b*=-1,i&&(f=1-.7*Math.sin(c))),d=this.depth*Math.sin(c)*-1,{rotate:b,translateZ:d,opacity:f,captionOpasity:g}},calcItemPosition:function(a,b){var c,g,d=!1,e=!1,f=a.position+this.moiety,h={rotate:60,translateZ:this.depth*-1,opacity:1};return g=f-b,f>=this.lastSide?(f-b<this.lastSide&&(c=f-this.lastSide,e=!0,b-=c,b<=this.moiety?b=(this.lastSide-this.center)/this.stepDistance*b:b<=2*this.moiety?b=(this.lastSide-this.firstSide)/(2*this.stepDistance)*b:(b+=2*this.moiety,e=!1),a.position-=c),d=!0,a.position-=b):f<=this.firstSide?("vertical"==this.o.orientation?b=(this.lastSide-this.center)/this.stepDistance*b:f-b>this.firstSide&&(e=!0,c=this.firstSide-f,b+=c,b>=this.moiety*-1?b=(this.lastSide-this.center)/this.stepDistance*b:b>=2*this.moiety*-1?b=(this.lastSide-this.firstSide)/(2*this.stepDistance)*b:b-=2*this.moiety,a.position+=c),d=!0,a.position-=b):f>this.firstSide&&f<this.lastSide&&(b=(this.lastSide-this.center)/this.stepDistance*b,f-b>=this.lastSide?(c=this.lastSide-f,b+=c,b=this.stepDistance/((this.lastSide-this.center)/b),a.position+=c):f-b<=this.firstSide?"horizontal"==this.o.orientation&&(c=f-this.firstSide,b-=c,b=this.stepDistance/((this.lastSide-this.center)/b),a.position-=c):e=!0,a.position-=b),"horizontal"==this.o.orientation?a.position>this.center&&(h.rotate*=-1):(h.rotate=-60,a.position<this.center&&(h.opacity=.3)),e&&(h=this.zoom(a)),d&&(h.captionOpasity=0),this.o.lazyLoad&&this.containerWidth>g-this.moiety&&"notLoaded"===a.load&&(this.lastItemLoad=a.index,a.load="load",this.o.stopDownload?this.jCallEvent("showProgress"):a.progress&&a.progress.show(),this.queue.push({node:a.content,index:a.index})),h},onLazyLoad:function(a){this.lastItemLoad===a-1&&(!this.o.stopDownload&&this.doneFlag.two||this.jCallEvent("hideProgress"),this.doneFlag.two||this.jCallEvent("complete"))},renderCarousel:function(a){var b,c,d,e,f=this.lastPosition-a;for(a||(a=0),this.lastPosition=a,b=0;b<this.l;b++)d={left:0,top:0},e={left:0,top:0},c=this.calcItemPosition(this.items[b],f),d[this.p_.pos]=this.items[b].position,e[this.p_.pos]=c.rotate,this.items[b].node.jSetCssProp(p,"translate3d("+d.left+"px, "+d.top+"px, "+c.translateZ+"px)rotateX("+e.top+"deg)rotateY("+e.left+"deg)"),this.items[b].figcaption&&this.items[b].figcaption.jSetOpacity(c.captionOpasity),"horizontal"==this.o.orientation?this.items[b].node.jSetCssProp("z-index",this.zIndex(this.items[b])):this.items[b].node.jSetOpacity(c.opacity)},_calcDistance:function(a){var b=this.itemStep;return a.defaultMove?(a.goTo&&(b=a.goTo),"forward"==a.direction?(this.loop.firstItem=!1,this.last+b>this.l-1?this.last!=this.l-1?(b=this.l-1-this.last,this.last+=b,this.loop.lastItem=!0):(this.last=0,b=this.l-1,this.loop.firstItem=!0,this.loop.lastItem=!1,a.direction="backward"):(this.last+=b,this.last===this.l-1&&(this.loop.lastItem=!0))):(this.loop.lastItem=!1,this.last-b<0?0!=this.last?(b=this.last,this.last-=b,this.loop.firstItem=!0):(this.last=this.l-1,b=this.l-1,this.loop.firstItem=!1,this.loop.lastItem=!0,a.direction="forward"):(this.last-=b,0===this.last&&(this.loop.firstItem=!0)))):(!a.direction&&(a.direction=a.target>=this.last?"forward":"backward"),b=Math.abs(this.last-a.target),this.last=a.target),this.distance=this.stepDistance*b,a.direction},_coverFlow:function(a){a.direction=this._calcDistance(a),this.callback=a.callback,this.jCallEvent("on-start-effect",{arr:[this.last]}),this._move("forward"==a.direction?this.lastPosition-this.distance:this.lastPosition+this.distance)},_move:function(a){this.nextPosition=a,this.fx=new b.FX(this.container,{duration:500,transition:this.o.timingFunction,onBeforeRender:function(a){this.renderCarousel(a.pos)}.jBind(this),onComplete:d(function(){this._onComplete()}).jBind(this)}).start({pos:[this.lastPosition,a]})},_move2:function(a){var b=Math.abs(this.nextPosition-this.lastPosition)*(a||.2);return Math.abs(b)<.01?(clearTimeout(this.moveTimer),this.moveTimer=null,this.move_=!1,void this.jCallEvent("drag-end",{arr:[this.last]})):(this.nextPosition<this.lastPosition&&(b*=-1),this.renderCarousel(this.lastPosition+b),void(this.moveTimer=setTimeout(this._move2.jBind(this,a),30)))},checkPosition:function(a,b){var c,e=a.position+this.moiety,f=a.position,g=d(function(a){(e>this.firstSide&&e<this.lastSide||a)&&(b=(this.lastSide-this.center)/this.stepDistance*b,e-b>=this.lastSide?(c=this.lastSide-e,b+=c,b=this.stepDistance/((this.lastSide-this.center)/b),f+=c):e-b<=this.firstSide&&"horizontal"==this.o.orientation&&(c=e-this.firstSide,b-=c,b=this.stepDistance/((this.lastSide-this.center)/b),f-=c),f-=b)}).jBind(this);return e>=this.lastSide?e-b<this.lastSide?(c=e-this.lastSide,b-=c,f-=c,g(!0)):f-=b:e<=this.firstSide?("vertical"==this.o.orientation&&(b=(this.lastSide-this.center)/this.stepDistance*b),
e-b>this.firstSide?(c=this.firstSide-e,b+=c,f+=c,g(!0)):f-=b):g(),f},searchIndex:function(){var a,b,c,d=this.lastPosition-this.nextPosition;for("vertical"==this.o.orientation&&(d*=2),a=0;a<this.l;a++)if(b=b?c:this.checkPosition(this.items[a],d),c=a+1<this.l?this.checkPosition(this.items[a+1],d):null,b+this.moiety>this.firstSide||a==this.l-1){(c&&c+this.moiety>=this.lastSide||!c)&&(c=1e8),this.center-(b+this.moiety)<c+this.moiety-this.center?this.last=a:this.last=a+1,0===this.last?this.loop.firstItem=!0:this.last===this.l-1&&(this.loop.lastItem=!0),this.nextPosition=this.center-this.last*this.stepDistance;break}},_initOnWheel:function(){var a,b;this.container.jAddEvent("mousescroll",d(function(c){(!0===this.o.scrollOnWheel||c.isMouse||"vertical"===this.o.orientation&&Math.abs(c.deltaY)>Math.abs(c.deltaX)||"horizontal"===this.o.orientation&&Math.abs(c.deltaY)<Math.abs(c.deltaX))&&(this.jCallEvent("drag-start"),this.fx&&this.fx.stop(),this.fx=null,c.stop(),b=Math.abs(c.deltaY)<Math.abs(c.deltaX)?c.deltaX:-1*c.deltaY,b=c.isMouse?b*this.stepDistance:b*(8/13),!c.isMouse&&(b=b>0?Math.min(this.stepDistance/4,b):Math.max(this.stepDistance/4*-1,b)),this.nextPosition-=b,clearTimeout(a),a=setTimeout(d(function(){this.searchIndex()}).jBind(this),100),this.nextPosition>=this.center?(this.nextPosition=this.center,this.last=0):this.nextPosition<=this.center-(this.l-1)*this.stepDistance&&(this.nextPosition=this.center-(this.l-1)*this.stepDistance,this.last=this.l-1),this.moveTimer||this._move2(.08))}).jBind(this))},_initDragOnScroll:function(){var a="left"==this.p_.pos?"x":"y",b={x:0,y:0},c={x:0,y:0},e=!1,f=!1,g=d(function(g){"dragstart"==g.state?(d(document.body).jAddClass("mcs-dragging"),f=!0,b.x=c.x=g.x,b.y=c.y=g.y,this.loop.firstItem=!1,this.loop.lastItem=!1):f&&(b.x=g.x,b.y=g.y,"dragend"==g.state?(d(document.body).jRemoveClass("mcs-dragging"),f=!1,e&&(this.searchIndex(),e=!1)):("vertical"==this.o.orientation||Math.abs(g.x-c.x)>Math.abs(g.y-c.y)?(g.stopDefaults(),e||(this.fx&&this.fx.stop(),this.jCallEvent("drag-start"),clearTimeout(this.moveTimer),this.move_=!0,this.moveTimer=null,e=!0),this.nextPosition-=c[a]-b[a],!this.moveTimer&&this._move2()):this.move_=!1,c.x=b.x,c.y=b.y))}).jBind(this);this.container.jAddEvent("touchdrag mousedrag",g)},stop:function(){this.fx&&this.fx.stop(!0),this.fx=null,clearTimeout(this.moveTimer),this.moveTimer=null,this.nextPosition&&this.renderCarousel(this.nextPosition)},onResize:function(){var a,b,c,d;for(this.stop(),this.distance=0,this.containerWidth=this._sWidth(),this.allSize=0,a=0;a<this.l;a++)this.items[a].size=this.items[a].node.jGetSize(!0,!0),this.allSize+=this.items[a].size[this.p_.size];this.moiety=this.items[0].size[this.p_.size]/2,"horizontal"==this.o.orientation?this.center=this.containerWidth/2:this.center=this.moiety+this.moiety/50*15,this.lastPosition=this.nextPosition=this.center,"horizontal"==this.o.orientation?(this.firstSide=this.center-2*this.moiety,this.lastSide=this.center+2*this.moiety):(this.firstSide=0,this.lastSide=this.center+this.moiety+.8*this.moiety),this.setItemsPosition(),this.renderCarousel(this.lastPosition),this.setCanvasPosition(),b=this.last,this.last=0,c=this._calcDistance({target:b}),d="forward"==c?this.lastPosition-this.distance:this.lastPosition+this.distance,this.nextPosition=d,this.renderCarousel(d)},resetZIndex:function(){this.items.jEach(d(function(a){"horizontal"==this.o.orientation?a.node.style.opacity="":a.node.jSetCssProp("z-index","")}).jBind(this))}}),b.extend(s.prototype,b.customEvents),b.Scroll.CoverFlow=s;var u=function(a,e){var f,g,j,o,q,r,s,u,v,t=0,w="Cannot calculate scroll size.";if(this.options=new b.Options(c),this.o=this.options.get.jBind(this.options),this.set=this.options.set.jBind(this.options),this.options.fromJSON(window.MagicScrollOptions||{}),this.options.fromJSON((window.MagicScrollExtraOptions||{})[a.getAttribute("id")||""]||{}),this.options.fromString(a.getAttribute("data-options")||""),b.browser.mobile&&(this.options.fromJSON(window.MagicScrollMobileOptions||{}),this.options.fromJSON((window.MagicScrollMobileExtraOptions||{})[a.getAttribute("id")||""]||{}),this.options.fromString(a.getAttribute("data-mobile-options")||"")),"string"==b.jTypeOf(e)?this.options.fromString(e||""):this.options.fromJSON(e||{}),!this.o("autostart"))return!1;for(this.original=d(a).jStore("scroll",this),b.$uuid(this),this.scrollReady=!1,b.browser.ieMode&&(b.$A(a.getElementsByTagName("a")).jEach(function(a){a.href=a.href}),b.$A(a.getElementsByTagName("img")).jEach(function(a){a.src=a.src})),this.originalClasses=d(a).getAttribute("class")||d(a).getAttribute("className"),this.originalNodes=[],this._insideOptions={autoplay:this.o("autoplay"),pause:!0,debug:!1,progress:!0,continuous:!1,maxSize:"scroll",stopDownload:!0,timingFunctionDefault:"cubic-bezier(.8, 0, .5, 1)",itemSettings:"auto"},this.id=a.getAttribute("id")||"MagicScroll-"+Math.floor(Math.random()*b.now()),this.container=a.jStore("scroll",this),this.wrapper=b.$new("div",{class:"mcs-wrapper"},{display:"inline-block"}),this.itemsContainer=b.$new("div",{class:"mcs-items-container"}),this.scrollReady=!1,f=this.container.childNodes.length-1;f>=0;f--)j=this.container.childNodes[f],3===j.nodeType||8===j.nodeType?this.container.removeChild(j):this.originalNodes.push(j);0!==this.originalNodes.length&&(q=function(a){var b=function(c){var d=a.childNodes[c],e=d.tagName.toLowerCase();return"br"===e||"hr"===e?b(++c):d};return b(0)},s=q(this.container),"FIGURE"==s.tagName&&(s=d(s).byTag("IMG")[0]||s.firstChild),"A"==s.tagName&&(s=d(s).byTag("IMG")[0]||s.firstChild),this.tagImg=!1,"IMG"==s.tagName&&(this.tagImg=s,r=s.getAttribute("data-src"),r&&(r=(r+"").jTrim(),""!=r&&s.setAttribute("src",r))),this.coreTimeout=null,(u=d(function(a){this.coreTimeout=setTimeout(d(function(){this.firstItemSize=d(q(this.container)).jGetSize(),0==this.firstItemSize.height?t<100&&(t++,u(a)):(clearTimeout(this.coreTimeout),a())}).jBind(this),100)}).jBind(this))(d(function(){this.cachedCSS=d([]),o=b.$A(this.container.childNodes),this.firstItem=o[0],d(o[0]).jSetCssProp("display","none"),this.itemCss={size:n(o[0]),border:m(o[0]),padding:l(o[0]),margin:k(o[0])},o[0].jSetCssProp("display","inline-block"),this.container.jSetCssProp("display","none"),this.containerCssSize=n(this.container),this.container.jSetCssProp("display","inline-block"),this.sizeFirstImg=null,this.setupOptions(),this._insideOptions.progress&&(this.progress=new b.Modules.Progress(this.container)),this.initBullets(),this.initEffect_(),v=d(function(){var a,c=!0,e={};for(this.hashBox=b.$new("div",null,{position:"absolute",left:"-10000px",top:"-10000px"}).jAppendTo(document.body),this.show(),f=0,g=o.length;f<g;f++){if(a=o[f].tagName.toLowerCase(),c){if("br"===a||"hr"===a)continue}else if("br"===a||"hr"===a)continue;try{i&&(h.append(b.$new("div",{},{display:"none",visibility:"hidden"}).append(document.createTextNode(i))),i=void 0)}catch(a){}c=!1,d(o[f]).jSetOpacity(0).jSetCssProp("display","inline-block"),this.push(o[f],e),e={},f==g-1&&this.done()}}).jBind(this),new b.QImageLoader([{node:o[0]}],{queue:1,onerror:function(a){throw"Error: MagicScroll: Error loading image - "+a.img.src+". "+w},onload:function(a,c){this.sizeFirstImg=a.img?a.img.jGetSize():a.size,"figure"==c.node.tagName.toLowerCase()&&b.$A(c.node.childNodes).jEach(d(function(a){if(a.tagName&&"figcaption"==a.tagName.toLowerCase()){var b=k(d(a));this.sizefigcaption=a.jGetSize(),this.sizefigcaption.width+=b.width,this.sizefigcaption.height+=b.height,this.sizeFirstImg.height+=this.sizefigcaption.height}}).jBind(this)),v()}.jBind(this)})}).jBind(this)))};b.extend(u.prototype,{hovered:!1,setupOptions:function(){"animation"!=this.o("mode")||!b.browser.ieMode&&b.browser.features.animation||(this.set("mode","scroll"),this.set("items","fit"),this.set("step","auto")),b.browser.ieMode&&b.browser.ieMode<=9&&"cover-flow"==this.o("mode")&&this.set("mode","scroll"),this._insideOptions.debug=document.location.hash.indexOf("#magic-debug-mode")!=-1,"array"===b.jTypeOf(this.o("items"))&&(this._insideOptions.itemSettings=this.o("items"),d(function(){var a,b,c,d=this._insideOptions.itemSettings,e=d.length;for(a=0;a<e;a++)for(b=a+1;b<e;b++)d[a][0]<d[b][0]&&(c=d[a],d[a]=d[b],d[b]=c);this._insideOptions.itemSettings=d}).jBind(this)(),this.set("items","auto")),0===this.o("speed")&&this.set("speed",10),(this.o("autoplay")<0||0==this.o("step"))&&(this._insideOptions.continuous=!0),d(["cover-flow","animation"]).contains(this.o("mode"))&&(this._insideOptions.continuous=!1),"off"!==this.o("loop")&&"false"!==this.o("loop")||this.set("loop",!1),("carousel"==this.o("mode")||this._insideOptions.continuous)&&this.set("loop","infinite"),"cover-flow"==this.o("mode")&&this.set("loop",!1),"rewind"===this.o("loop")&&"animation"===this.o("mode")&&this.set("loop",!1),(d(["cover-flow","carousel"]).contains(this.o("mode"))||this._insideOptions.continuous)&&this.set("pagination",!1),d(["cover-flow","carousel"]).contains(this.o("mode"))&&!this._insideOptions.continuous&&this.set("step",1),d(["cover-flow","carousel"]).contains(this.o("mode"))&&!d(["auto","fit"]).contains(this.o("items"))&&this.set("items","auto"),"animation"==this.o("mode")&&"auto"==this.o("items")&&this.set("items","fit"),"animation"==this.o("mode")&&this.set("step","auto"),this._insideOptions.continuous?this.set("easing","cubic-bezier(0, 0, 1, 1)"):"cubic-bezier(0, 0, 1, 1)"==this.o("easing")&&this.set("easing",this._insideOptions.timingFunctionDefault),"carousel"===this.o("mode")&&this.set("lazyLoad",!1),d(["cover-flow","carousel"]).contains(this.o("mode"))&&(this._insideOptions.itemSettings="auto"),this.originwidth=this.o("width"),this.originheight=this.o("height"),this._insideOptions.continuous&&this.set("autoplay",0),(d(["cover-flow","carousel"]).contains(this.o("mode"))||this._insideOptions.continuous)&&this.set("arrows",!1),"false"!==this.o("arrows")&&"off"!==this.o("arrows")||this.set("arrows",!1),this.o("arrows")&&this.container.jAddClass("MagicScroll-arrows-"+this.o("arrows")),this.container.jAddClass("MagicScroll-"+this.o("orientation")),this.container.setAttribute("data-mode",this.o("mode"))},initBullets:function(){return this.o("pagination")?void(this.bullets||(this.bullets=new b.Modules.Bullets({},this.container,d(function(){return this.hold_}).jBind(this)),this.container.jAddClass("MagicScroll-bullets"),this.bullets.bindEvent("bullets-click",d(function(a){this.jump({direction:a.direction,target:a.jumpIndex})}).jBind(this)))):void(this.bullets&&(this.bullets.jRemove(),this.bullets=null))},setBullets:function(){var a,b=d([]);if(this.effect){for(a=0;a<this.effect.l;a++)d(["scroll","animation"]).contains(this.o("mode"))?a%this.effect.itemStep==0&&b.push(this.effect.items[a].index):b.push(this.effect.items[a].index);this.bullets.push(b)}},setupArrows:function(){var a=l(this.container);if(this.arrows&&(this.arrows.jRemove(),this.arrows=null),this.wrapper.jSetCss({top:"",left:"",right:"",bottom:""}),this.o("arrows")&&(this.arrows?this.arrows.setOrientation(this.o("orientation")):(this.arrows=new b.Modules.ArrowsPair({orientation:"mcs-"+this.o("orientation"),class:"mcs-button",classHidden:"mcs-hidden",classDisabled:"mcs-disabled"},this.container),this.effect.bindEvent("disable",this.arrows.disable.jBind(this.arrows,void 0)),this.effect.bindEvent("enable",this.arrows.enable.jBind(this.arrows,void 0)),this.effect.bindEvent("hideArrows",this.arrows.hide.jBind(this.arrows,void 0)),this.effect.bindEvent("showArrows",this.arrows.show.jBind(this.arrows,void 0)),this.o("loop")||(this.effect.bindEvent("scroll",this.arrows.enable.jBind(this.arrows,void 0)),this.effect.bindEvent("last-frame",this.arrows.disable.jBind(this.arrows,"next")),this.effect.bindEvent("first-frame",this.arrows.disable.jBind(this.arrows,"prev"))),this.arrows.bindEvent("forward",function(a){this.jump("forward")}.jBind(this)),this.arrows.bindEvent("backward",function(a){this.jump("backward")}.jBind(this))),"outside"==this.o("arrows"))){var c=d("horizontal"==this.o("orientation")?["left","right"]:["top","bottom"]),e="horizontal"==this.o("orientation")?"width":"height",f=parseInt(this.arrows.next.jGetSize()[e]);c.jEach(d(function(b){this.wrapper.jSetCssProp(b,f+a[e]/2)}).jBind(this))}},setContainerSize:function(){"auto"!=this.o("width")&&this.container.jSetCssProp("width",this.o("width")),"auto"!=this.o("height")&&this.container.jSetCssProp("height",this.o("height"))},initEffect_:function(){var a=d(["scroll","animation"]).contains(this.o("mode"))?"effect":this.o("mode");this.effect=new(b.Scroll[("-"+a).jCamelize()])(this.itemsContainer,{orientation:this.o("orientation"),duration:this.o("speed"),continuous:this._insideOptions.continuous,timingFunction:this.o("easing"),loop:this.o("loop"),step:this.o("step"),effect:this.o("mode"),lazyLoad:this.o("lazyLoad"),progress:this._insideOptions.progress,stopDownload:this._insideOptions.stopDownload,debug:this._insideOptions.debug,scrollOnWheel:this.o("scrollOnWheel"),draggable:this.o("draggable"),keyboard:this.o("keyboard")}),"auto"!=this.o("items")&&"auto"==this.o("step")&&this.set("step",this.o("items")),this.effect.bindEvent("hold",d(function(){this.hold_=!1,this.auto()}).jBind(this))},jump:function(a,b){"animation"==this.o("mode")&&/^\+|^\-/.test(a)&&(a=/^\+/.test(a)?"forward":"backward"),this.hold_||this.effect.stopScroll||(this.hold_=!0,clearTimeout(this.auto_),this.effect.jump(a,d(function(a,c){this.hold_=!1,c||(this.jCallEvent("after-scroll"),!this._insideOptions.continuous||this.hovered||this.pause_?(0==this.hashBox.childNodes.length&&this.hashBox.jRemove(),this.o("loop")&&this.effect.changeClones(),this.o("onMoveEnd")({id:this.id,items:a}),this.effect.continuousMove=!1,b&&b()):this.jump("forward",b))}).jBind(this)))},parseTag:function(a){var c,e,f,g,h;if("A"==a.tagName.toUpperCase()){if(g=d(a).byTag("IMG")[0]){for((h=d(a).byTag("span")[0])&&""!==h.innerHTML.jTrim()?(e=d(h.cloneNode(!0)).jAddClass("mcs-caption"),e.setAttribute("magic-user","yes")):((c=g.nextSibling)&&3==c.nodeType&&""!==c.nodeValue.jTrim()||h&&(c=h.nextSibling)&&3==c.nodeType&&""!==c.nodeValue.jTrim())&&(e=b.$new("span",{class:"mcs-caption"}).append(c.cloneNode(!0))),f=a.childNodes.length-1;f>=0;f--)g!==a.childNodes[f]&&a.removeChild(a.childNodes[f]);e&&a.append(e)}}else"figure"==a.tagName.toLowerCase()&&b.$A(a.childNodes).jEach(d(function(a){a.tagName&&"figcaption"==a.tagName.toLowerCase()&&(c=a.getAttribute("id")||"figcaption-"+Math.floor(Math.random()*b.now()),a.setAttribute("id",c),d(a).jAddClass("mcs-caption"),e=a,this.cssId=b.addCSS("#"+c+":before",{"padding-top":(this.sizefigcaption.height+m(d(a))/2)/parseInt(this.firstItemSize.width)*100+"%"}))}).jBind(this));return{node:a,figcaption:e}},setPercent:function(a){"auto"!=this.o("items")&&a.node.jSetCssProp("horizontal"==this.o("orientation")?"width":"height",100/this.o("items")+"%")},checkWholeItems:function(a){var b,c;"fit"==this.o("items")?this.set("items",Math.floor(this.wrapper.jGetSize()[this.effect.p_.size]/this.sizeFirstImg[this.effect.p_.size])):"auto"==this.o("items")&&(this.itemCss.size[this.effect.p_.size]||(b=this.sizeFirstImg[this.effect.p_.size]||this.firstItemSize[this.effect.p_.size],c=this.itemsContainer.jGetSize(),"vertical"===this.o("orientation")&&(b=Math.min(b,c[this.effect.p_.size])),c=(b+k(a.content)[this.effect.p_.size]+m(a.content)[this.effect.p_.size]+l(a.content)[this.effect.p_.size]+l(a.node)[this.effect.p_.size])/this.itemsContainer.jGetSize()[this.effect.p_.size]*100,c>100&&(c=100),a.node.jSetCssProp(this.effect.p_.size,c+"%")))},push:function(a,c){a.show(),a={content:a},c.top&&c.top.jEach(function(a){a.jRemove()}),c.bottom&&c.bottom.jEach(function(a){a.jRemove()}),a.additionalTags=c;var d=this.parseTag(a.content);a.content=d.node,a.figcaption=d.figcaption,a.node=b.$new("div",{class:"mcs-item"}),a.node.jAppendTo(this.itemsContainer),this.checkWholeItems(a),this.setPercent(a),a.content.jAppendTo(this.hashBox),this.effect.push(a)},show:function(){this.indoc||(this.indoc=!0,this.container.append(this.wrapper.append(this.itemsContainer)).show().setAttribute("id",this.id),this.container.jSetCssProp("display","inline-block"),this.o("arrows")&&(this.setupArrows(),this.o("loop")&&this.arrows.disable("prev"),this.arrows.hide()),this.checkSizes_(),this.setContainerSize(),this.tagImg&&"horizontal"===this.o("orientation")&&this.container.jGetSize().width<this.sizeFirstImg.width&&(this.checkSizes_(!0),this.setContainerSize()),this.countTheNumberOfItems(),d(window).jAddEvent("resize",this.onResize.jBind(this)))},done:function(a){this.effect.bindEvent("key_down",d(function(a){this.jump(a.direction)}).jBind(this)),this.effect.bindEvent("show-this",d(function(a){this.jump(a.index)}).jBind(this)),this.effect.bindEvent("showProgress",d(function(){this.progress&&this.progress.show()}).jBind(this)),this.effect.bindEvent("hideProgress",d(function(){this.progress&&this.progress.hide()}).jBind(this)),this.effect.bindEvent("complete",d(function(){this.effect.done2(d(function(){this.effect.bindEvent("disableHold",d(function(){this.hold_=!1}).jBind(this)),this.effect.bindEvent("item-click",d(function(a){var c,d,b=!0;"carousel"==this.o("mode")&&(c=360/this.effect.l,d=(360-this.effect.last*c+a.index*c)%360,d>90&&d<270&&(b=!1)),b&&this.jump(a.index)}).jBind(this)),this.bullets&&(this.bullets.o.items=this.effect.items.length,this.setBullets(),this.bullets.show()),this.effect.bindEvent("on-item-hover",d(function(a){this.o("onItemHover")({id:this.id,item:a.itemIndex})}).jBind(this)),this.effect.bindEvent("on-item-out",d(function(a){this.o("onItemOut")({id:this.id,item:a.itemIndex})}).jBind(this)),this.effect.bindEvent("on-start-effect",d(function(a){this.bullets&&this.bullets.setActiveBullet(a.arr,!this.o("loop")),this.o("onMoveStart")({id:this.id,items:a.arr})}).jBind(this)),this.effect.bindEvent("drag-start",d(function(){this.hold_=!0,this.auto()}).jBind(this)),this.effect.bindEvent("drag-end",d(function(a){this.bullets&&this.bullets.setActiveBullet(a.arr,!this.o("loop")),this.hold_=!1,this.o("onMoveEnd")({id:this.id,items:a.arr}),0==this.hashBox.childNodes.length&&this.hashBox.jRemove(),this.auto()}).jBind(this)),this.container.jSetCssProp("overflow","visible"),this.scrollReady=!0,this.o("onReady").call(this,this.id),d(window).jAddEvent("resize",d(function(){this.hold_=!1,this._insideOptions.continuous?this.jump.jBind(this,"forward").jDelay(200):this.auto()}).jBind(this)),this.setEvent(),"vertical"===this.o("orientation")&&/%$/.test(this.o("height"))&&(this.set("height",this.container.jGetSize().height),this.setContainerSize()),0!=this.o("autoplay")?this.auto():this.pause_=!0,this._insideOptions.continuous&&(this.pause_=!1,this.jump.jBind(this,"forward").jDelay(200)),this.scrollReady=!0}).jBind(this))}).jBind(this)),this.effect.done()},setEvent:function(){this.bindEvent("after-scroll",d(function(){0!=this._insideOptions.autoplay&&!this._insideOptions.continuous&&this.auto()}).jBind(this)),b.browser.touchScreen||!this._insideOptions.pause&&!this._insideOptions.continuous||this.wrapper.jAddEvent("mouseover mouseout",d(function(a){a.stop();for(var b=a.getRelated();b&&b!==this.wrapper;)b=b.parentNode;b!=this.wrapper&&this._insideOptions.pause&&!this.pause_&&(this.pauseHover_="mouseover"==a.type,this.hovered="mouseover"==a.type,this._insideOptions.continuous?"mouseover"==a.type?this.pauseContinuous():this.jump("forward"):this.auto())}).jBind(this)),!this._insideOptions.continuous&&"animation"===this.o("mode")&&this.o("scrollOnWheel")&&this.wrapper.jAddEvent("mousescroll",d(function(a){var b=-1*(Math.abs(a.deltaY)<Math.abs(a.deltaX)?a.deltaX:-1*a.deltaY);if(b=a.isMouse?b:b*(8/54),!0===this.o("scrollOnWheel")&&a.isMouse||"vertical"===this.o("orientation")&&Math.abs(a.deltaY)>Math.abs(a.deltaX)||"horizontal"===this.o("orientation")&&Math.abs(a.deltaY)<Math.abs(a.deltaX)){if(a.stop(),Math.abs(b)<.6)return;this.jump(b>0?"backward":"forward")}}).jBind(this))},checkSizes_:function(a){var r,s,t,u,c="width",e="height",f="vertical"==this.o("orientation"),g=this.container.jGetSize(),h={width:0,height:0},i=l(this.container),j=m(this.wrapper),p=(k(this.wrapper),l(this.wrapper),k(this.firstItem)),q=b.$new("div",{class:"mcs-item"}).jAppendTo(this.wrapper.firstChild),v=l(q);q.jRemove(),"border-box"==this.container.jGetCss("box-sizing")&&(h=m(this.container)),f&&(c=e,e="width"),"auto"!=this.o(c)||parseInt(this.containerCssSize[c])||(f?isNaN(this.o("items"))?this.set(c,g[c]):this.set(c,g[c]*this.o("items")):this.set(c,"100%")),("auto"==this.o(e)&&!parseInt(this.containerCssSize[e])||a)&&(t=h[e]+i[e]+j[e]+p[e]+v[e],f?r=Math.min(this.sizeFirstImg[e],g[e]):(r=this.sizeFirstImg[e],this.tagImg&&(s=this.sizeFirstImg[e]/this.sizeFirstImg[c],this.sizeFirstImg[c]>g[c]&&(r=g[c]*s))),u=r+k(d(this.originalNodes[0]))[e]+l(this.originalNodes[0])[e]+m(this.originalNodes[0])[e]||this.firstItemSize[e]||g[e],u+=t,u+="",this.set(e,u))},countTheNumberOfItems:function(){var a,c,e,f,g=!0;if("auto"!=this._insideOptions.itemSettings&&d(["scroll","animation"]).contains(this.o("mode"))){for(f=this._insideOptions.itemSettings,e=f.length,c="scroll"==this._insideOptions.maxSize?this.container.jGetSize()["vertical"==this.o("orientation")?"height":"width"]:d(window).jGetSize()["vertical"==this.o("orientation")?"height":"width"],a=e-1;a>=0;a--){if(c<=f[a][0]&&!isNaN(f[a][1])){this.set("items",f[a][1]),g=!1;break}0===a&&(d(["carousel","cover-flow"]).contains(this.o("mode"))?this.set("items",1):"animation"===this.o("mode")?this.set("items","fit"):this.set("items","fit"))}b.$A(this.itemsContainer.childNodes).jEach(d(function(a,b){this.checkWholeItems({node:a,content:a.firstChild}),this.setPercent({node:a})}).jBind(this)),this.effect.items.length>0&&this.effect.update()}},onResize:function(){this.countTheNumberOfItems(),this.bullets&&this.bullets.update()},resize:function(){this.scrollReady&&(this.onResize(),this.effect.onResize())},pauseContinuous:function(){this.effect.pause()},stop:function(){this.container.jStore("swap-items-opacity",!1),this.effect&&this.effect.stop(),this.hold_=!1,clearTimeout(this.auto_),this.auto_=!1},checkEffect:function(a){return a==this.o("mode")},registerCallback:function(a,b){d(["onItemHover","onItemOut","onReady","onMoveStart","onMoveEnd"]).contains(a)&&this.set(a,b)},dispose:function(){var a,c,e;if(this.stop(),clearTimeout(this.coreTimeout),this.wrapper.jRemoveEvent("mouseover mouseout"),this.wrapper.jRemoveEvent("mousewheel"),this.effect&&this.effect.dispose(),this.cachedCSS)for(a=0;a<this.cachedCSS.length;a++)b.removeCSS("magicscroll-css",this.cachedCSS[a]);for(this.container.jRemoveClass("MagicScroll-bullets"),d(this.originalNodes).jEach(d(function(a){a.parentNode&&d(a).jRemove(),e=a,"FIGURE"==e.tagName&&(e=e.firstChild),"A"==e.tagName&&(e=e.firstChild),"IMG"==e.tagName&&(c=e.getAttribute("data-src"),c&&(c=(c+"").jTrim(),""!=c&&e.removeAttribute("src"))),a.childNodes.length>0&&"a"==a.tagName.toLowerCase()&&b.$A(a.childNodes).jEach(d(function(b){b.tagName&&"span"==b.tagName.toLowerCase()&&("yes"===b.getAttribute("magic-user")?(b.removeAttribute("magic-user"),a.append(b)):(a.append(b.childNodes[0]),b.jRemove()))}).jBind(this)),a.jSetCss({visibility:"",opacity:"1"})}).jBind(this)),this.hashBox&&this.hashBox.jRemove(),b.$A(this.container.childNodes).jEach(function(a){d(a).kill()}),d(this.container).removeAttribute("data-mode"),d(this.container).jClearEvents().jRemoveClass().jAddClass(this.originalClasses),this.container.jSetCss({width:"",height:"",visibility:"",display:"",overflow:""}),this.container.jDel("scroll"),a=this.originalNodes.length-1;a>=0;a--)d(this.originalNodes[a]).jSetCss({opacity:""}).jAppendTo(this.container);return this.o("onStop").call(this,this.id),null},play:function(a){null===a||void 0===a?a=this.o("autoplay"):(a||(a=1e3),a=parseInt(a),isNaN(a)&&(a=this.o("autoplay"))),this.pause_&&(this.auto_||(this.pause_=!1,this.effect.continuousPause=!1,this._insideOptions.autoplay=a,this.jump("forward")))},pause:function(){this.pause_||(this.pause_=!0,this._insideOptions.continuous?this.pauseContinuous():this.stop(),this.auto())},updateOptions:function(a){var c,e={height:"",width:""},f=this.o("mode");if(this.stop(),this.container.jRemoveClass("MagicScroll-arrows-"+this.o("arrows")),this.container.jRemoveClass("MagicScroll-"+this.o("orientation")),this.wrapper.jRemoveEvent("mouseover mouseout mousewheel"),this.destroyEvent("after-scroll"),this.progress=null,this.container.jRemoveClass("MagicScroll-bullets"),"string"==b.jTypeOf(a)?this.options.fromString(a||""):this.options.fromJSON(a||{}),f!=this.o("mode"))return!1;for(this._insideOptions.autoplay=this.o("autoplay"),this.setupOptions(),this.effect.items.jEach(d(function(a){a.node.jSetCss(e)}).jBind(this)),this.effect.itemsFirstClones.jEach(d(function(a){d(a).node.jSetCss(e)}).jBind(this)),this.effect.itemsLastClones.jEach(d(function(a){d(a).node.jSetCss(e)}).jBind(this)),this.setupArrows(),c=0;c<this.cachedCSS.length;c++)this.cachedCSS[c]&&b.removeCSS("magicscroll-css",this.cachedCSS[c]);return this.effect.setNewOptions({orientation:this.o("orientation"),duration:this.o("speed"),continuous:this._insideOptions.continuous,timingFunction:this.o("easing"),loop:this.o("loop"),step:this.o("step"),effect:this.o("mode"),lazyLoad:this.o("lazyLoad"),progress:this._insideOptions.progress,stopDownload:this._insideOptions.stopDownload,debug:this._insideOptions.debug,scrollOnWheel:this.o("scrollOnWheel"),draggable:this.o("draggable"),keyboard:this.o("keyboard")}),this.checkSizes_(),this.setContainerSize(),this.countTheNumberOfItems(),b.$A(this.itemsContainer.childNodes).jEach(d(function(a,b){this.checkWholeItems({node:a,content:a.firstChild}),this.setPercent({node:a})}).jBind(this)),this.effect.update(),this.initBullets(),this.bullets&&(this.setBullets(),this.bullets.show()),0==this.o("autoplay")?this.pause():this.pause_=!1,this.o("arrows")&&this.arrows.show(),this.setEvent(),this._insideOptions.continuous?(this.jump.jBind(this,"forward").jDelay(200),this.pause_=!1):this.auto(),!0},auto:function(){var a="forward";clearTimeout(this.auto_),this.auto_=!1,this.hold_||this.pause_||this.pauseHover_||0!=this._insideOptions.autoplay&&(this.auto_=setTimeout(d(function(){this.jump(a)}).jBind(this),Math.abs(this._insideOptions.autoplay)))}}),b.extend(u.prototype,b.customEvents),b.Scroll.Full=u;var v=function(a){var c=w(a);if(c)return{registerCallback:c.registerCallback.jBind(c),pause:c.pause.jBind(c),play:d(function(a){this.play(a)}).jBind(c),forward:d(function(a){a=a?y(a,"+"):"forward",this.jump(a)}).jBind(c),backward:d(function(a){a=a?y(a,"-"):"backward",this.jump(a)}).jBind(c),jump:d(function(a){a&&!isNaN(Math.abs(parseInt(a)))||(a="forward"),this.jump(a)}).jBind(c),updateOptions:d(function(a){a&&"object"==b.jTypeOf(a)||(a={}),this.updateOptions(a)}).jBind(c)}},w=function(a){var c=null;return"string"==b.jTypeOf(a)&&d(a)||"element"==b.jTypeOf(a)?c=d(a).jFetch("scroll"):("function"==b.jTypeOf(a)&&a instanceof b.Scroll.Full||a&&a.indoc)&&(c=a),c},x=function(a,b,c){var e=w(a);return e?e[c](b):(b=a,a=C,void d(a).jEach(function(a){a[c](b)}))},y=function(a,c){return"string"===b.jTypeOf(a)&&(a=parseInt(a),isNaN(a)&&(a=a)),"number"===b.jTypeOf(a)&&(a=c+a),a},z=function(a){var c=b.$A((a||document).byClass("MagicScroll")).map(function(a){return D.start(a)});return A=!0,c},A=!1,B=function(a){return C=d(C).filter(function(a){return a.dispose()})},C=[],D={version:"v2.0.15",start:function(a){var c=null;return arguments.length?(a=d(a),!(!a||!d(a).jHasClass("MagicScroll"))&&((c=d(a).jFetch("scroll"))?c:(c=new b.Scroll.Full(a,A?{autostart:!0}:{}),c.o("autostart")?(C.push(c),c):(c=null,!1)))):z()},stop:function(a){return arguments.length?void((a=a instanceof b.Scroll.Full?a:d(a)&&d(a).jFetch("scroll")||null)&&(C.splice(d(C).indexOf(a),1),a.dispose())):void B()},refresh:function(a){return a?(D.stop(a),D.start(a.id||a)):(B(),z())},running:function(a){var b,c=!1;return a&&(b=w(a),b&&(c=b.scrollReady)),c},getInstance:function(a){return v(a)},updateOptions:function(a,b){return x(a,b,"updateOptions")},resize:function(a){a?x(a,null,"resize"):d(C).jEach(function(a){D.resize(a)})},jump:function(a,b){void 0!=a&&null!=a&&x(a,b,"jump")},pause:function(a){x(a,null,"pause")},play:function(a,b){x(a,b,"play")},forward:function(a,b){b=b?y(b,"+"):"forward",a?w(a)||(a=y(a,"+")):a=b,x(a,b,"jump")},backward:function(a,b){b=b?y(b,"-"):"backward",a?w(a)||(a=y(a,"-")):a=b,x(a,b,"jump")}};return d(document).jAddEvent("domready",function(){i=i(),h=b.$new("div",{class:"msc-tmp-hdn-holder"}).jAppendTo(document.body),b.defined(window.MagicScrollOptions)||(window.MagicScrollOptions={}),b.defined(window.MagicScrollMobileOptions)||(window.MagicScrollMobileOptions={}),b.defined(window.MagicScrollExtraOptions)||(window.MagicScrollExtraOptions={}),b.defined(window.MagicScrollMobileExtraOptions)||(window.MagicScrollMobileExtraOptions={}),D.start.jDelay(10)}),D}();